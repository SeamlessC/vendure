{"version":3,"file":"vendure-admin-ui-catalog.umd.js","sources":["../../node_modules/tslib/tslib.es6.js","../../src/lib/catalog/src/components/asset-detail/asset-detail.component.ts","../../src/lib/catalog/src/components/asset-list/asset-list.component.ts","../../src/lib/catalog/src/components/collection-detail/collection-detail.component.ts","../../src/lib/catalog/src/components/collection-list/collection-list.component.ts","../../src/lib/catalog/src/components/facet-detail/facet-detail.component.ts","../../src/lib/catalog/src/components/facet-list/facet-list.component.ts","../../src/lib/catalog/src/providers/product-detail/replace-last.ts","../../src/lib/catalog/src/providers/product-detail/product-detail.service.ts","../../src/lib/catalog/src/components/apply-facet-dialog/apply-facet-dialog.component.ts","../../src/lib/catalog/src/components/assign-products-to-channel-dialog/assign-products-to-channel-dialog.component.ts","../../src/lib/catalog/src/components/product-detail/product-detail.component.ts","../../src/lib/catalog/src/components/product-list/product-list.component.ts","../../src/lib/catalog/src/components/product-options-editor/product-options-editor.component.ts","../../src/lib/catalog/src/components/confirm-variant-deletion-dialog/confirm-variant-deletion-dialog.component.ts","../../src/lib/catalog/src/components/product-variants-editor/product-variants-editor.component.ts","../../src/lib/catalog/src/providers/routing/asset-resolver.ts","../../src/lib/catalog/src/providers/routing/collection-resolver.ts","../../src/lib/catalog/src/providers/routing/facet-resolver.ts","../../src/lib/catalog/src/providers/routing/product-resolver.ts","../../src/lib/catalog/src/providers/routing/product-variants-resolver.ts","../../src/lib/catalog/src/catalog.routes.ts","../../src/lib/catalog/src/components/assets/assets.component.ts","../../src/lib/catalog/src/components/assign-to-channel-dialog/assign-to-channel-dialog.component.ts","../../src/lib/catalog/src/components/bulk-add-facet-values-dialog/bulk-add-facet-values-dialog.graphql.ts","../../src/lib/catalog/src/components/bulk-add-facet-values-dialog/bulk-add-facet-values-dialog.component.ts","../../src/lib/catalog/src/components/collection-contents/collection-contents.component.ts","../../src/lib/catalog/src/components/collection-list/collection-list-bulk-actions.ts","../../src/lib/catalog/src/components/collection-tree/array-to-tree.ts","../../src/lib/catalog/src/components/collection-tree/collection-tree.component.ts","../../src/lib/catalog/src/components/collection-tree/collection-tree-node.component.ts","../../src/lib/catalog/src/components/facet-list/facet-list-bulk-actions.ts","../../src/lib/catalog/src/components/generate-product-variants/generate-product-variants.component.ts","../../src/lib/catalog/src/components/option-value-input/option-value-input.component.ts","../../src/lib/catalog/src/components/product-list/product-list-bulk-actions.ts","../../src/lib/catalog/src/components/update-product-option-dialog/update-product-option-dialog.component.ts","../../src/lib/catalog/src/components/product-variants-list/product-variants-list.component.ts","../../src/lib/catalog/src/components/product-variants-table/product-variants-table.component.ts","../../src/lib/catalog/src/components/variant-price-detail/variant-price-detail.component.ts","../../src/lib/catalog/src/catalog.module.ts","../../src/lib/catalog/src/public_api.ts","../../src/lib/catalog/src/vendure-admin-ui-catalog.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n","import { ChangeDetectionStrategy, Component, OnDestroy, OnInit } from '@angular/core';\nimport { FormBuilder, FormControl, FormGroup } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport {\n    Asset,\n    BaseDetailComponent,\n    CustomFieldConfig,\n    GetAsset,\n    LanguageCode,\n} from '@vendure/admin-ui/core';\nimport { DataService, NotificationService, ServerConfigService } from '@vendure/admin-ui/core';\n\n@Component({\n    selector: 'vdr-asset-detail',\n    templateUrl: './asset-detail.component.html',\n    styleUrls: ['./asset-detail.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class AssetDetailComponent extends BaseDetailComponent<GetAsset.Asset> implements OnInit, OnDestroy {\n    detailForm = new FormGroup({});\n    customFields: CustomFieldConfig[];\n\n    constructor(\n        router: Router,\n        route: ActivatedRoute,\n        serverConfigService: ServerConfigService,\n        private notificationService: NotificationService,\n        protected dataService: DataService,\n        private formBuilder: FormBuilder,\n    ) {\n        super(route, router, serverConfigService, dataService);\n        this.customFields = this.getCustomFieldConfig('Asset');\n    }\n\n    ngOnInit() {\n        this.detailForm = new FormGroup({\n            name: new FormControl(''),\n            tags: new FormControl([]),\n            customFields: this.formBuilder.group(\n                this.customFields.reduce((hash, field) => ({ ...hash, [field.name]: '' }), {}),\n            ),\n        });\n        this.init();\n    }\n\n    ngOnDestroy() {\n        this.destroy();\n    }\n\n    onAssetChange(event: { id: string; name: string; tags: string[] }) {\n        this.detailForm.get('name')?.setValue(event.name);\n        this.detailForm.get('tags')?.setValue(event.tags);\n        this.detailForm.markAsDirty();\n    }\n\n    save() {\n        this.dataService.product\n            .updateAsset({\n                id: this.id,\n                name: this.detailForm.value.name,\n                tags: this.detailForm.value.tags,\n                customFields: this.detailForm.value.customFields,\n            })\n            .subscribe(\n                () => {\n                    this.notificationService.success(_('common.notify-update-success'), { entity: 'Asset' });\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-update-error'), {\n                        entity: 'Asset',\n                    });\n                },\n            );\n    }\n\n    protected setFormValues(entity: GetAsset.Asset, languageCode: LanguageCode): void {\n        this.detailForm.get('name')?.setValue(entity.name);\n        this.detailForm.get('tags')?.setValue(entity.tags);\n        if (this.customFields.length) {\n            this.setCustomFieldFormValues(this.customFields, this.detailForm.get(['customFields']), entity);\n        }\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { FormControl } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport {\n    Asset,\n    BaseListComponent,\n    DataService,\n    DeletionResult,\n    GetAssetList,\n    LogicalOperator,\n    ModalService,\n    NotificationService,\n    SortOrder,\n    TagFragment,\n} from '@vendure/admin-ui/core';\nimport { PaginationInstance } from 'ngx-pagination';\nimport { BehaviorSubject, combineLatest, EMPTY, Observable } from 'rxjs';\nimport { debounceTime, finalize, map, switchMap, takeUntil } from 'rxjs/operators';\n\n@Component({\n    selector: 'vdr-asset-list',\n    templateUrl: './asset-list.component.html',\n    styleUrls: ['./asset-list.component.scss'],\n})\nexport class AssetListComponent\n    extends BaseListComponent<GetAssetList.Query, GetAssetList.Items, GetAssetList.Variables>\n    implements OnInit {\n    searchTerm$ = new BehaviorSubject<string | undefined>(undefined);\n    filterByTags$ = new BehaviorSubject<TagFragment[] | undefined>(undefined);\n    uploading = false;\n    allTags$: Observable<TagFragment[]>;\n    paginationConfig$: Observable<PaginationInstance>;\n\n    constructor(\n        private notificationService: NotificationService,\n        private modalService: ModalService,\n        private dataService: DataService,\n        router: Router,\n        route: ActivatedRoute,\n    ) {\n        super(router, route);\n        super.setQueryFn(\n            (...args: any[]) => this.dataService.product.getAssetList(...args),\n            data => data.assets,\n            (skip, take) => {\n                const searchTerm = this.searchTerm$.value;\n                const tags = this.filterByTags$.value?.map(t => t.value);\n                return {\n                    options: {\n                        skip,\n                        take,\n                        ...(searchTerm\n                            ? {\n                                  filter: {\n                                      name: { contains: searchTerm },\n                                  },\n                              }\n                            : {}),\n                        sort: {\n                            createdAt: SortOrder.DESC,\n                        },\n                        tags,\n                        tagsOperator: LogicalOperator.AND,\n                    },\n                };\n            },\n            { take: 25, skip: 0 },\n        );\n    }\n\n    ngOnInit() {\n        super.ngOnInit();\n        this.paginationConfig$ = combineLatest(this.itemsPerPage$, this.currentPage$, this.totalItems$).pipe(\n            map(([itemsPerPage, currentPage, totalItems]) => ({ itemsPerPage, currentPage, totalItems })),\n        );\n        this.searchTerm$.pipe(debounceTime(250), takeUntil(this.destroy$)).subscribe(() => this.refresh());\n\n        this.filterByTags$.pipe(takeUntil(this.destroy$)).subscribe(() => this.refresh());\n        this.allTags$ = this.dataService.product.getTagList().mapStream(data => data.tags.items);\n    }\n\n    filesSelected(files: File[]) {\n        if (files.length) {\n            this.uploading = true;\n            this.dataService.product\n                .createAssets(files)\n                .pipe(finalize(() => (this.uploading = false)))\n                .subscribe(({ createAssets }) => {\n                    let successCount = 0;\n                    for (const result of createAssets) {\n                        switch (result.__typename) {\n                            case 'Asset':\n                                successCount++;\n                                break;\n                            case 'MimeTypeError':\n                                this.notificationService.error(result.message);\n                                break;\n                        }\n                    }\n                    if (0 < successCount) {\n                        super.refresh();\n                        this.notificationService.success(_('asset.notify-create-assets-success'), {\n                            count: successCount,\n                        });\n                    }\n                });\n        }\n    }\n\n    deleteAssets(assets: Asset[]) {\n        this.showModalAndDelete(assets.map(a => a.id))\n            .pipe(\n                switchMap(response => {\n                    if (response.result === DeletionResult.DELETED) {\n                        return [true];\n                    } else {\n                        return this.showModalAndDelete(\n                            assets.map(a => a.id),\n                            response.message || '',\n                        ).pipe(map(r => r.result === DeletionResult.DELETED));\n                    }\n                }),\n            )\n            .subscribe(\n                () => {\n                    this.notificationService.success(_('common.notify-delete-success'), {\n                        entity: 'Assets',\n                    });\n                    this.refresh();\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-delete-error'), {\n                        entity: 'Assets',\n                    });\n                },\n            );\n    }\n\n    private showModalAndDelete(assetIds: string[], message?: string) {\n        return this.modalService\n            .dialog({\n                title: _('catalog.confirm-delete-assets'),\n                translationVars: {\n                    count: assetIds.length,\n                },\n                body: message,\n                buttons: [\n                    { type: 'secondary', label: _('common.cancel') },\n                    { type: 'danger', label: _('common.delete'), returnValue: true },\n                ],\n            })\n            .pipe(\n                switchMap(res => (res ? this.dataService.product.deleteAssets(assetIds, !!message) : EMPTY)),\n                map(res => res.deleteAssets),\n            );\n    }\n}\n","import {\n    ChangeDetectionStrategy,\n    ChangeDetectorRef,\n    Component,\n    OnDestroy,\n    OnInit,\n    ViewChild,\n} from '@angular/core';\nimport { FormArray, FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport {\n    Asset,\n    BaseDetailComponent,\n    Collection,\n    ConfigurableOperation,\n    ConfigurableOperationDefinition,\n    ConfigurableOperationInput,\n    CreateCollectionInput,\n    createUpdatedTranslatable,\n    CustomFieldConfig,\n    DataService,\n    encodeConfigArgValue,\n    findTranslation,\n    getConfigArgValue,\n    LanguageCode,\n    LocalStorageService,\n    ModalService,\n    NotificationService,\n    Permission,\n    ServerConfigService,\n    unicodePatternValidator,\n    UpdateCollectionInput,\n} from '@vendure/admin-ui/core';\nimport { normalizeString } from '@vendure/common/lib/normalize-string';\nimport { combineLatest, merge, Observable, of, Subject } from 'rxjs';\nimport { debounceTime, filter, map, mergeMap, switchMap, take } from 'rxjs/operators';\n\nimport { CollectionContentsComponent } from '../collection-contents/collection-contents.component';\n\n@Component({\n    selector: 'vdr-collection-detail',\n    templateUrl: './collection-detail.component.html',\n    styleUrls: ['./collection-detail.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class CollectionDetailComponent\n    extends BaseDetailComponent<Collection.Fragment>\n    implements OnInit, OnDestroy\n{\n    customFields: CustomFieldConfig[];\n    detailForm: FormGroup;\n    assetChanges: { assets?: Asset[]; featuredAsset?: Asset } = {};\n    filters: ConfigurableOperation[] = [];\n    allFilters: ConfigurableOperationDefinition[] = [];\n    updatedFilters$: Observable<ConfigurableOperationInput[]>;\n    livePreview = false;\n    parentId$: Observable<string | undefined>;\n    readonly updatePermission = [Permission.UpdateCatalog, Permission.UpdateCollection];\n    private filterRemoved$ = new Subject<void>();\n    @ViewChild('collectionContents') contentsComponent: CollectionContentsComponent;\n\n    constructor(\n        router: Router,\n        route: ActivatedRoute,\n        serverConfigService: ServerConfigService,\n        private changeDetector: ChangeDetectorRef,\n        protected dataService: DataService,\n        private formBuilder: FormBuilder,\n        private notificationService: NotificationService,\n        private modalService: ModalService,\n        private localStorageService: LocalStorageService,\n    ) {\n        super(route, router, serverConfigService, dataService);\n        this.customFields = this.getCustomFieldConfig('Collection');\n        this.detailForm = this.formBuilder.group({\n            name: ['', Validators.required],\n            slug: ['', unicodePatternValidator(/^[\\p{Letter}0-9_-]+$/)],\n            description: '',\n            visible: false,\n            filters: this.formBuilder.array([]),\n            customFields: this.formBuilder.group(\n                this.customFields.reduce((hash, field) => ({ ...hash, [field.name]: '' }), {}),\n            ),\n        });\n        this.livePreview = this.localStorageService.get('livePreviewCollectionContents') ?? false;\n    }\n\n    ngOnInit() {\n        this.init();\n        this.dataService.collection.getCollectionFilters().single$.subscribe(res => {\n            this.allFilters = res.collectionFilters;\n        });\n        const filtersFormArray = this.detailForm.get('filters') as FormArray;\n        this.updatedFilters$ = merge(filtersFormArray.statusChanges, this.filterRemoved$).pipe(\n            debounceTime(200),\n            filter(() => filtersFormArray.touched),\n            map(() =>\n                this.mapOperationsToInputs(this.filters, filtersFormArray.value).filter(_filter => {\n                    // ensure all the arguments have valid values. E.g. a newly-added\n                    // filter will not yet have valid values\n                    for (const arg of _filter.arguments) {\n                        if (arg.value === '') {\n                            return false;\n                        }\n                    }\n                    return true;\n                }),\n            ),\n        );\n        this.parentId$ = this.route.paramMap.pipe(\n            map(pm => pm.get('parentId') || undefined),\n            switchMap(parentId => {\n                if (parentId) {\n                    return of(parentId);\n                } else {\n                    return this.entity$.pipe(map(collection => collection.parent?.id));\n                }\n            }),\n        );\n    }\n\n    ngOnDestroy() {\n        this.destroy();\n    }\n\n    getFilterDefinition(_filter: ConfigurableOperation): ConfigurableOperationDefinition | undefined {\n        return this.allFilters.find(f => f.code === _filter.code);\n    }\n\n    assetsChanged(): boolean {\n        return !!Object.values(this.assetChanges).length;\n    }\n\n    /**\n     * If creating a new Collection, automatically generate the slug based on the collection name.\n     */\n    updateSlug(nameValue: string) {\n        combineLatest(this.entity$, this.languageCode$)\n            .pipe(take(1))\n            .subscribe(([entity, languageCode]) => {\n                const slugControl = this.detailForm.get(['slug']);\n                const currentTranslation = findTranslation(entity, languageCode);\n                const currentSlugIsEmpty = !currentTranslation || !currentTranslation.slug;\n                if (slugControl && slugControl.pristine && currentSlugIsEmpty) {\n                    slugControl.setValue(normalizeString(`${nameValue}`, '-'));\n                }\n            });\n    }\n\n    addFilter(collectionFilter: ConfigurableOperation) {\n        const filtersArray = this.detailForm.get('filters') as FormArray;\n        const argsHash = collectionFilter.args.reduce(\n            (output, arg) => ({\n                ...output,\n                [arg.name]: getConfigArgValue(arg.value),\n            }),\n            {},\n        );\n        filtersArray.push(\n            this.formBuilder.control({\n                code: collectionFilter.code,\n                args: argsHash,\n            }),\n        );\n        this.filters.push({\n            code: collectionFilter.code,\n            args: collectionFilter.args.map(a => ({ name: a.name, value: getConfigArgValue(a.value) })),\n        });\n    }\n\n    removeFilter(index: number) {\n        const filtersArray = this.detailForm.get('filters') as FormArray;\n        if (index !== -1) {\n            filtersArray.removeAt(index);\n            filtersArray.markAsDirty();\n            filtersArray.markAsTouched();\n            this.filters.splice(index, 1);\n            this.filterRemoved$.next();\n        }\n    }\n\n    create() {\n        if (!this.detailForm.dirty) {\n            return;\n        }\n        combineLatest(this.entity$, this.languageCode$)\n            .pipe(\n                take(1),\n                mergeMap(([category, languageCode]) => {\n                    const input = this.getUpdatedCollection(\n                        category,\n                        this.detailForm,\n                        languageCode,\n                    ) as CreateCollectionInput;\n                    const parentId = this.route.snapshot.paramMap.get('parentId');\n                    if (parentId) {\n                        input.parentId = parentId;\n                    }\n                    return this.dataService.collection.createCollection(input);\n                }),\n            )\n            .subscribe(\n                data => {\n                    this.notificationService.success(_('common.notify-create-success'), {\n                        entity: 'Collection',\n                    });\n                    this.assetChanges = {};\n                    this.detailForm.markAsPristine();\n                    this.changeDetector.markForCheck();\n                    this.router.navigate(['../', data.createCollection.id], { relativeTo: this.route });\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-create-error'), {\n                        entity: 'Collection',\n                    });\n                },\n            );\n    }\n\n    save() {\n        combineLatest(this.entity$, this.languageCode$)\n            .pipe(\n                take(1),\n                mergeMap(([category, languageCode]) => {\n                    const input = this.getUpdatedCollection(\n                        category,\n                        this.detailForm,\n                        languageCode,\n                    ) as UpdateCollectionInput;\n                    return this.dataService.collection.updateCollection(input);\n                }),\n            )\n            .subscribe(\n                () => {\n                    this.assetChanges = {};\n                    this.detailForm.markAsPristine();\n                    this.changeDetector.markForCheck();\n                    this.notificationService.success(_('common.notify-update-success'), {\n                        entity: 'Collection',\n                    });\n                    this.contentsComponent.refresh();\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-update-error'), {\n                        entity: 'Collection',\n                    });\n                },\n            );\n    }\n\n    canDeactivate(): boolean {\n        return super.canDeactivate() && !this.assetChanges.assets && !this.assetChanges.featuredAsset;\n    }\n\n    toggleLivePreview() {\n        this.livePreview = !this.livePreview;\n        this.localStorageService.set('livePreviewCollectionContents', this.livePreview);\n    }\n\n    trackByFn(index: number, item: ConfigurableOperation) {\n        return JSON.stringify(item);\n    }\n\n    /**\n     * Sets the values of the form on changes to the category or current language.\n     */\n    protected setFormValues(entity: Collection.Fragment, languageCode: LanguageCode) {\n        const currentTranslation = findTranslation(entity, languageCode);\n\n        this.detailForm.patchValue({\n            name: currentTranslation ? currentTranslation.name : '',\n            slug: currentTranslation ? currentTranslation.slug : '',\n            description: currentTranslation ? currentTranslation.description : '',\n            visible: !entity.isPrivate,\n        });\n\n        const formArray = this.detailForm.get('filters') as FormArray;\n        if (formArray.length !== entity.filters.length) {\n            formArray.clear();\n            this.filters = [];\n            entity.filters.forEach(f => this.addFilter(f));\n        }\n\n        if (this.customFields.length) {\n            this.setCustomFieldFormValues(\n                this.customFields,\n                this.detailForm.get(['customFields']),\n                entity,\n                currentTranslation,\n            );\n        }\n    }\n\n    /**\n     * Given a category and the value of the form, this method creates an updated copy of the category which\n     * can then be persisted to the API.\n     */\n    private getUpdatedCollection(\n        category: Collection.Fragment,\n        form: FormGroup,\n        languageCode: LanguageCode,\n    ): CreateCollectionInput | UpdateCollectionInput {\n        const updatedCategory = createUpdatedTranslatable({\n            translatable: category,\n            updatedFields: form.value,\n            customFieldConfig: this.customFields,\n            languageCode,\n            defaultTranslation: {\n                languageCode,\n                name: category.name || '',\n                slug: category.slug || '',\n                description: category.description || '',\n            },\n        });\n        return {\n            ...updatedCategory,\n            assetIds: this.assetChanges.assets?.map(a => a.id),\n            featuredAssetId: this.assetChanges.featuredAsset?.id,\n            isPrivate: !form.value.visible,\n            filters: this.mapOperationsToInputs(this.filters, this.detailForm.value.filters),\n        };\n    }\n\n    /**\n     * Maps an array of conditions or actions to the input format expected by the GraphQL API.\n     */\n    private mapOperationsToInputs(\n        operations: ConfigurableOperation[],\n        formValueOperations: any,\n    ): ConfigurableOperationInput[] {\n        return operations.map((o, i) => {\n            return {\n                code: o.code,\n                arguments: Object.entries(formValueOperations[i].args).map(([name, value], j) => {\n                    return {\n                        name,\n                        value: encodeConfigArgValue(value),\n                    };\n                }),\n            };\n        });\n    }\n}\n","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, OnDestroy, OnInit } from '@angular/core';\nimport { FormControl } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport {\n    DataService,\n    GetCollectionList,\n    LanguageCode,\n    ModalService,\n    NotificationService,\n    QueryResult,\n    SelectionManager,\n    ServerConfigService,\n} from '@vendure/admin-ui/core';\nimport { combineLatest, EMPTY, Observable, Subject } from 'rxjs';\nimport {\n    debounceTime,\n    distinctUntilChanged,\n    map,\n    shareReplay,\n    switchMap,\n    take,\n    takeUntil,\n    tap,\n} from 'rxjs/operators';\n\nimport { CollectionPartial, RearrangeEvent } from '../collection-tree/collection-tree.component';\n\n@Component({\n    selector: 'vdr-collection-list',\n    templateUrl: './collection-list.component.html',\n    styleUrls: ['./collection-list.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class CollectionListComponent implements OnInit, OnDestroy {\n    filterTermControl = new FormControl('');\n    activeCollectionId$: Observable<string | null>;\n    activeCollectionTitle$: Observable<string>;\n    items$: Observable<GetCollectionList.Items[]>;\n    availableLanguages$: Observable<LanguageCode[]>;\n    contentLanguage$: Observable<LanguageCode>;\n    expandAll = false;\n    expandedIds: string[] = [];\n    selectionManager: SelectionManager<CollectionPartial>;\n    private queryResult: QueryResult<any>;\n    private destroy$ = new Subject<void>();\n\n    constructor(\n        private dataService: DataService,\n        private notificationService: NotificationService,\n        private modalService: ModalService,\n        private router: Router,\n        private route: ActivatedRoute,\n        private serverConfigService: ServerConfigService,\n        private changeDetectorRef: ChangeDetectorRef,\n    ) {\n        this.selectionManager = new SelectionManager({\n            additiveMode: true,\n            multiSelect: true,\n            itemsAreEqual: (a, b) => a.id === b.id,\n        });\n    }\n\n    ngOnInit() {\n        this.queryResult = this.dataService.collection.getCollections(1000, 0).refetchOnChannelChange();\n        this.items$ = this.queryResult\n            .mapStream(data => data.collections.items)\n            .pipe(\n                tap(items => this.selectionManager.setCurrentItems(items)),\n                shareReplay(1),\n            );\n        this.activeCollectionId$ = this.route.paramMap.pipe(\n            map(pm => pm.get('contents')),\n            distinctUntilChanged(),\n        );\n        this.expandedIds = this.route.snapshot.queryParamMap.get('expanded')?.split(',') ?? [];\n        this.expandAll = this.route.snapshot.queryParamMap.get('expanded') === 'all';\n\n        this.activeCollectionTitle$ = combineLatest(this.activeCollectionId$, this.items$).pipe(\n            map(([id, collections]) => {\n                if (id) {\n                    const match = collections.find(c => c.id === id);\n                    return match ? match.name : '';\n                }\n                return '';\n            }),\n        );\n        this.availableLanguages$ = this.serverConfigService.getAvailableLanguages();\n        this.contentLanguage$ = this.dataService.client\n            .uiState()\n            .mapStream(({ uiState }) => uiState.contentLanguage)\n            .pipe(tap(() => this.refresh()));\n\n        this.filterTermControl.valueChanges\n            .pipe(debounceTime(250), takeUntil(this.destroy$))\n            .subscribe(term => {\n                this.router.navigate(['./'], {\n                    queryParams: {\n                        q: term || undefined,\n                    },\n                    queryParamsHandling: 'merge',\n                    relativeTo: this.route,\n                });\n            });\n\n        this.route.queryParamMap\n            .pipe(\n                map(qpm => qpm.get('q')),\n                distinctUntilChanged(),\n                takeUntil(this.destroy$),\n            )\n            .subscribe(() => this.refresh());\n        this.filterTermControl.patchValue(this.route.snapshot.queryParamMap.get('q'));\n    }\n\n    ngOnDestroy() {\n        this.queryResult.completed$.next();\n        this.destroy$.next(undefined);\n        this.destroy$.complete();\n    }\n\n    toggleExpandAll() {\n        this.router.navigate(['./'], {\n            queryParams: {\n                expanded: this.expandAll ? 'all' : undefined,\n            },\n            queryParamsHandling: 'merge',\n            relativeTo: this.route,\n        });\n    }\n\n    onRearrange(event: RearrangeEvent) {\n        this.dataService.collection.moveCollection([event]).subscribe({\n            next: () => {\n                this.notificationService.success(_('common.notify-saved-changes'));\n                this.refresh();\n            },\n            error: err => {\n                this.notificationService.error(_('common.notify-save-changes-error'));\n            },\n        });\n    }\n\n    deleteCollection(id: string) {\n        this.items$\n            .pipe(\n                take(1),\n                map(items => -1 < items.findIndex(i => i.parent && i.parent.id === id)),\n                switchMap(hasChildren => {\n                    return this.modalService.dialog({\n                        title: _('catalog.confirm-delete-collection'),\n                        body: hasChildren\n                            ? _('catalog.confirm-delete-collection-and-children-body')\n                            : undefined,\n                        buttons: [\n                            { type: 'secondary', label: _('common.cancel') },\n                            { type: 'danger', label: _('common.delete'), returnValue: true },\n                        ],\n                    });\n                }),\n                switchMap(response => (response ? this.dataService.collection.deleteCollection(id) : EMPTY)),\n            )\n            .subscribe(\n                () => {\n                    this.notificationService.success(_('common.notify-delete-success'), {\n                        entity: 'Collection',\n                    });\n                    this.refresh();\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-delete-error'), {\n                        entity: 'Collection',\n                    });\n                },\n            );\n    }\n\n    closeContents() {\n        const params = { ...this.route.snapshot.params };\n        delete params.contents;\n        this.router.navigate(['./', params], { relativeTo: this.route, queryParamsHandling: 'preserve' });\n    }\n\n    setLanguage(code: LanguageCode) {\n        this.dataService.client.setContentLanguage(code).subscribe();\n    }\n\n    refresh() {\n        const filterTerm = this.route.snapshot.queryParamMap.get('q');\n        this.queryResult.ref.refetch({\n            options: {\n                skip: 0,\n                take: 1000,\n                ...(filterTerm\n                    ? {\n                          filter: {\n                              name: {\n                                  contains: filterTerm,\n                              },\n                          },\n                      }\n                    : {}),\n            },\n        });\n    }\n}\n","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, OnDestroy, OnInit } from '@angular/core';\nimport { FormArray, FormBuilder, FormControl, FormGroup, Validators } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport {\n    BaseDetailComponent,\n    CreateFacetInput,\n    CreateFacetValueInput,\n    createUpdatedTranslatable,\n    CustomFieldConfig,\n    DataService,\n    DeletionResult,\n    FacetWithValues,\n    findTranslation,\n    LanguageCode,\n    ModalService,\n    NotificationService,\n    Permission,\n    ServerConfigService,\n    UpdateFacetInput,\n    UpdateFacetValueInput,\n} from '@vendure/admin-ui/core';\nimport { normalizeString } from '@vendure/common/lib/normalize-string';\nimport { notNullOrUndefined } from '@vendure/common/lib/shared-utils';\nimport { combineLatest, EMPTY, forkJoin, Observable } from 'rxjs';\nimport { map, mapTo, mergeMap, switchMap, take } from 'rxjs/operators';\n\n@Component({\n    selector: 'vdr-facet-detail',\n    templateUrl: './facet-detail.component.html',\n    styleUrls: ['./facet-detail.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class FacetDetailComponent\n    extends BaseDetailComponent<FacetWithValues.Fragment>\n    implements OnInit, OnDestroy\n{\n    customFields: CustomFieldConfig[];\n    customValueFields: CustomFieldConfig[];\n    detailForm: FormGroup;\n    values: Array<FacetWithValues.Values | { name: string; code: string }>;\n    readonly updatePermission = [Permission.UpdateCatalog, Permission.UpdateFacet];\n\n    constructor(\n        router: Router,\n        route: ActivatedRoute,\n        serverConfigService: ServerConfigService,\n        private changeDetector: ChangeDetectorRef,\n        protected dataService: DataService,\n        private formBuilder: FormBuilder,\n        private notificationService: NotificationService,\n        private modalService: ModalService,\n    ) {\n        super(route, router, serverConfigService, dataService);\n        this.customFields = this.getCustomFieldConfig('Facet');\n        this.customValueFields = this.getCustomFieldConfig('FacetValue');\n        this.detailForm = this.formBuilder.group({\n            facet: this.formBuilder.group({\n                code: ['', Validators.required],\n                name: '',\n                visible: true,\n                customFields: this.formBuilder.group(\n                    this.customFields.reduce((hash, field) => ({ ...hash, [field.name]: '' }), {}),\n                ),\n            }),\n            values: this.formBuilder.array([]),\n        });\n    }\n\n    ngOnInit() {\n        this.init();\n    }\n\n    ngOnDestroy() {\n        this.destroy();\n    }\n\n    updateCode(currentCode: string, nameValue: string) {\n        if (!currentCode) {\n            const codeControl = this.detailForm.get(['facet', 'code']);\n            if (codeControl && codeControl.pristine) {\n                codeControl.setValue(normalizeString(nameValue, '-'));\n            }\n        }\n    }\n\n    updateValueCode(currentCode: string, nameValue: string, index: number) {\n        if (!currentCode) {\n            const codeControl = this.detailForm.get(['values', index, 'code']);\n            if (codeControl && codeControl.pristine) {\n                codeControl.setValue(normalizeString(nameValue, '-'));\n            }\n        }\n    }\n\n    customValueFieldIsSet(index: number, name: string): boolean {\n        return !!this.detailForm.get(['values', index, 'customFields', name]);\n    }\n\n    getValuesFormArray(): FormArray {\n        return this.detailForm.get('values') as FormArray;\n    }\n\n    addFacetValue() {\n        const valuesFormArray = this.detailForm.get('values') as FormArray | null;\n        if (valuesFormArray) {\n            const valueGroup = this.formBuilder.group({\n                id: '',\n                name: ['', Validators.required],\n                code: '',\n            });\n            const newValue: any = { name: '', code: '' };\n            if (this.customValueFields.length) {\n                const customValueFieldsGroup = new FormGroup({});\n                newValue.customFields = {};\n\n                for (const fieldDef of this.customValueFields) {\n                    const key = fieldDef.name;\n                    customValueFieldsGroup.addControl(key, new FormControl());\n                }\n\n                valueGroup.addControl('customFields', customValueFieldsGroup);\n            }\n            valuesFormArray.insert(valuesFormArray.length, valueGroup);\n            this.values.push(newValue);\n        }\n    }\n\n    create() {\n        const facetForm = this.detailForm.get('facet');\n        if (!facetForm || !facetForm.dirty) {\n            return;\n        }\n        combineLatest(this.entity$, this.languageCode$)\n            .pipe(\n                take(1),\n                mergeMap(([facet, languageCode]) => {\n                    const newFacet = this.getUpdatedFacet(\n                        facet,\n                        facetForm as FormGroup,\n                        languageCode,\n                    ) as CreateFacetInput;\n                    return this.dataService.facet.createFacet(newFacet);\n                }),\n                switchMap(data => this.dataService.facet.getAllFacets().single$.pipe(mapTo(data))),\n            )\n            .subscribe(\n                data => {\n                    this.notificationService.success(_('common.notify-create-success'), { entity: 'Facet' });\n                    this.detailForm.markAsPristine();\n                    this.changeDetector.markForCheck();\n                    this.router.navigate(['../', data.createFacet.id], { relativeTo: this.route });\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-create-error'), {\n                        entity: 'Facet',\n                    });\n                },\n            );\n    }\n\n    save() {\n        combineLatest(this.entity$, this.languageCode$)\n            .pipe(\n                take(1),\n                mergeMap(([facet, languageCode]) => {\n                    const facetGroup = this.detailForm.get('facet');\n                    const updateOperations: Array<Observable<any>> = [];\n\n                    if (facetGroup && facetGroup.dirty) {\n                        const newFacet = this.getUpdatedFacet(\n                            facet,\n                            facetGroup as FormGroup,\n                            languageCode,\n                        ) as UpdateFacetInput;\n                        if (newFacet) {\n                            updateOperations.push(this.dataService.facet.updateFacet(newFacet));\n                        }\n                    }\n                    const valuesArray = this.detailForm.get('values');\n                    if (valuesArray && valuesArray.dirty) {\n                        const createdValues = this.getCreatedFacetValues(\n                            facet,\n                            valuesArray as FormArray,\n                            languageCode,\n                        );\n                        if (createdValues.length) {\n                            updateOperations.push(\n                                this.dataService.facet\n                                    .createFacetValues(createdValues)\n                                    .pipe(switchMap(() => this.dataService.facet.getFacet(this.id).single$)),\n                            );\n                        }\n                        const updatedValues = this.getUpdatedFacetValues(\n                            facet,\n                            valuesArray as FormArray,\n                            languageCode,\n                        );\n                        if (updatedValues.length) {\n                            updateOperations.push(this.dataService.facet.updateFacetValues(updatedValues));\n                        }\n                    }\n\n                    return forkJoin(updateOperations);\n                }),\n                switchMap(() => this.dataService.facet.getAllFacets().single$),\n            )\n            .subscribe(\n                () => {\n                    this.detailForm.markAsPristine();\n                    this.changeDetector.markForCheck();\n                    this.notificationService.success(_('common.notify-update-success'), { entity: 'Facet' });\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-update-error'), {\n                        entity: 'Facet',\n                    });\n                },\n            );\n    }\n\n    deleteFacetValue(facetValueId: string | undefined, index: number) {\n        if (!facetValueId) {\n            // deleting a newly-added (not persisted) FacetValue\n            const valuesFormArray = this.detailForm.get('values') as FormArray | null;\n            if (valuesFormArray) {\n                valuesFormArray.removeAt(index);\n            }\n            this.values.splice(index, 1);\n            return;\n        }\n        this.showModalAndDelete(facetValueId)\n            .pipe(\n                switchMap(response => {\n                    if (response.result === DeletionResult.DELETED) {\n                        return [true];\n                    } else {\n                        return this.showModalAndDelete(facetValueId, response.message || '').pipe(\n                            map(r => r.result === DeletionResult.DELETED),\n                        );\n                    }\n                }),\n                switchMap(deleted => (deleted ? this.dataService.facet.getFacet(this.id).single$ : [])),\n            )\n            .subscribe(\n                () => {\n                    this.notificationService.success(_('common.notify-delete-success'), {\n                        entity: 'FacetValue',\n                    });\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-delete-error'), {\n                        entity: 'FacetValue',\n                    });\n                },\n            );\n    }\n\n    private showModalAndDelete(facetValueId: string, message?: string) {\n        return this.modalService\n            .dialog({\n                title: _('catalog.confirm-delete-facet-value'),\n                body: message,\n                buttons: [\n                    { type: 'secondary', label: _('common.cancel') },\n                    { type: 'danger', label: _('common.delete'), returnValue: true },\n                ],\n            })\n            .pipe(\n                switchMap(result =>\n                    result ? this.dataService.facet.deleteFacetValues([facetValueId], !!message) : EMPTY,\n                ),\n                map(result => result.deleteFacetValues[0]),\n            );\n    }\n\n    /**\n     * Sets the values of the form on changes to the facet or current language.\n     */\n    protected setFormValues(facet: FacetWithValues.Fragment, languageCode: LanguageCode) {\n        const currentTranslation = findTranslation(facet, languageCode);\n\n        this.detailForm.patchValue({\n            facet: {\n                code: facet.code,\n                visible: !facet.isPrivate,\n                name: currentTranslation?.name ?? '',\n            },\n        });\n\n        if (this.customFields.length) {\n            const customFieldsGroup = this.detailForm.get(['facet', 'customFields']) as FormGroup;\n            this.setCustomFieldFormValues(\n                this.customFields,\n                this.detailForm.get(['facet', 'customFields']),\n                facet,\n                currentTranslation,\n            );\n        }\n\n        const currentValuesFormArray = this.detailForm.get('values') as FormArray;\n        this.values = [...facet.values];\n        facet.values.forEach((value, i) => {\n            const valueTranslation = findTranslation(value, languageCode);\n            const group = {\n                id: value.id,\n                code: value.code,\n                name: valueTranslation ? valueTranslation.name : '',\n            };\n            const valueControl = currentValuesFormArray.at(i);\n            if (valueControl) {\n                valueControl.get('id')?.setValue(group.id);\n                valueControl.get('code')?.setValue(group.code);\n                valueControl.get('name')?.setValue(group.name);\n            } else {\n                currentValuesFormArray.insert(i, this.formBuilder.group(group));\n            }\n            if (this.customValueFields.length) {\n                let customValueFieldsGroup = this.detailForm.get(['values', i, 'customFields']) as FormGroup;\n                if (!customValueFieldsGroup) {\n                    customValueFieldsGroup = new FormGroup({});\n                    (this.detailForm.get(['values', i]) as FormGroup).addControl(\n                        'customFields',\n                        customValueFieldsGroup,\n                    );\n                }\n\n                if (customValueFieldsGroup) {\n                    for (const fieldDef of this.customValueFields) {\n                        const key = fieldDef.name;\n                        const fieldValue =\n                            fieldDef.type === 'localeString'\n                                ? (valueTranslation as any | undefined)?.customFields?.[key]\n                                : (value as any).customFields[key];\n                        const control = customValueFieldsGroup.get(key);\n                        if (control) {\n                            control.setValue(fieldValue);\n                        } else {\n                            customValueFieldsGroup.addControl(key, new FormControl(fieldValue));\n                        }\n                    }\n                }\n            }\n        });\n    }\n\n    /**\n     * Given a facet and the value of the detailForm, this method creates an updated copy of the facet which\n     * can then be persisted to the API.\n     */\n    private getUpdatedFacet(\n        facet: FacetWithValues.Fragment,\n        facetFormGroup: FormGroup,\n        languageCode: LanguageCode,\n    ): CreateFacetInput | UpdateFacetInput {\n        const input = createUpdatedTranslatable({\n            translatable: facet,\n            updatedFields: facetFormGroup.value,\n            customFieldConfig: this.customFields,\n            languageCode,\n            defaultTranslation: {\n                languageCode,\n                name: facet.name || '',\n            },\n        });\n        input.isPrivate = !facetFormGroup.value.visible;\n        return input;\n    }\n\n    /**\n     * Given an array of facet values and the values from the detailForm, this method creates a new array\n     * which can be persisted to the API via a createFacetValues mutation.\n     */\n    private getCreatedFacetValues(\n        facet: FacetWithValues.Fragment,\n        valuesFormArray: FormArray,\n        languageCode: LanguageCode,\n    ): CreateFacetValueInput[] {\n        return valuesFormArray.controls\n            .filter(c => !c.value.id)\n            .map(c => c.value)\n            .map(value =>\n                createUpdatedTranslatable({\n                    translatable: { ...value, translations: [] as any },\n                    updatedFields: value,\n                    customFieldConfig: this.customValueFields,\n                    languageCode,\n                    defaultTranslation: {\n                        languageCode,\n                        name: '',\n                    },\n                }),\n            )\n            .map(input => ({\n                facetId: facet.id,\n                ...input,\n            }));\n    }\n\n    /**\n     * Given an array of facet values and the values from the detailForm, this method creates a new array\n     * which can be persisted to the API via an updateFacetValues mutation.\n     */\n    private getUpdatedFacetValues(\n        facet: FacetWithValues.Fragment,\n        valuesFormArray: FormArray,\n        languageCode: LanguageCode,\n    ): UpdateFacetValueInput[] {\n        const dirtyValues = facet.values.filter((v, i) => {\n            const formRow = valuesFormArray.get(i.toString());\n            return formRow && formRow.dirty && formRow.value.id;\n        });\n        const dirtyValueValues = valuesFormArray.controls\n            .filter(c => c.dirty && c.value.id)\n            .map(c => c.value);\n\n        if (dirtyValues.length !== dirtyValueValues.length) {\n            throw new Error(_(`error.facet-value-form-values-do-not-match`));\n        }\n        return dirtyValues\n            .map((value, i) => {\n                return createUpdatedTranslatable({\n                    translatable: value,\n                    updatedFields: dirtyValueValues[i],\n                    customFieldConfig: this.customValueFields,\n                    languageCode,\n                    defaultTranslation: {\n                        languageCode,\n                        name: '',\n                    },\n                });\n            })\n            .filter(notNullOrUndefined);\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { FormControl } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport {\n    BaseListComponent,\n    DataService,\n    DeletionResult,\n    GetFacetList,\n    LanguageCode,\n    ModalService,\n    NotificationService,\n    SelectionManager,\n    ServerConfigService,\n} from '@vendure/admin-ui/core';\nimport { SortOrder } from '@vendure/common/lib/generated-shop-types';\nimport { EMPTY, Observable } from 'rxjs';\nimport { debounceTime, filter, map, switchMap, takeUntil, tap } from 'rxjs/operators';\n\n@Component({\n    selector: 'vdr-facet-list',\n    templateUrl: './facet-list.component.html',\n    styleUrls: ['./facet-list.component.scss'],\n})\nexport class FacetListComponent\n    extends BaseListComponent<GetFacetList.Query, GetFacetList.Items>\n    implements OnInit\n{\n    filterTermControl = new FormControl('');\n    availableLanguages$: Observable<LanguageCode[]>;\n    contentLanguage$: Observable<LanguageCode>;\n    readonly initialLimit = 3;\n    displayLimit: { [id: string]: number } = {};\n    selectionManager: SelectionManager<GetFacetList.Items>;\n\n    constructor(\n        private dataService: DataService,\n        private modalService: ModalService,\n        private notificationService: NotificationService,\n        private serverConfigService: ServerConfigService,\n        router: Router,\n        route: ActivatedRoute,\n    ) {\n        super(router, route);\n        super.setQueryFn(\n            (...args: any[]) => this.dataService.facet.getFacets(...args).refetchOnChannelChange(),\n            data => data.facets,\n            (skip, take) => ({\n                options: {\n                    skip,\n                    take,\n                    filter: {\n                        name: {\n                            contains: this.filterTermControl.value,\n                        },\n                    },\n                    sort: {\n                        createdAt: SortOrder.DESC,\n                    },\n                },\n            }),\n        );\n        this.selectionManager = new SelectionManager<GetFacetList.Items>({\n            multiSelect: true,\n            itemsAreEqual: (a, b) => a.id === b.id,\n            additiveMode: true,\n        });\n    }\n\n    ngOnInit() {\n        super.ngOnInit();\n        this.availableLanguages$ = this.serverConfigService.getAvailableLanguages();\n        this.contentLanguage$ = this.dataService.client\n            .uiState()\n            .mapStream(({ uiState }) => uiState.contentLanguage)\n            .pipe(tap(() => this.refresh()));\n        this.filterTermControl.valueChanges\n            .pipe(\n                filter(value => 2 <= value.length || value.length === 0),\n                debounceTime(250),\n                takeUntil(this.destroy$),\n            )\n            .subscribe(() => this.refresh());\n    }\n\n    toggleDisplayLimit(facet: GetFacetList.Items) {\n        if (this.displayLimit[facet.id] === facet.values.length) {\n            this.displayLimit[facet.id] = this.initialLimit;\n        } else {\n            this.displayLimit[facet.id] = facet.values.length;\n        }\n    }\n\n    deleteFacet(facetValueId: string) {\n        this.showModalAndDelete(facetValueId)\n            .pipe(\n                switchMap(response => {\n                    if (response.result === DeletionResult.DELETED) {\n                        return [true];\n                    } else {\n                        return this.showModalAndDelete(facetValueId, response.message || '').pipe(\n                            map(r => r.result === DeletionResult.DELETED),\n                        );\n                    }\n                }),\n                // Refresh the cached facets to reflect the changes\n                switchMap(() => this.dataService.facet.getAllFacets().single$),\n            )\n            .subscribe(\n                () => {\n                    this.notificationService.success(_('common.notify-delete-success'), {\n                        entity: 'FacetValue',\n                    });\n                    this.refresh();\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-delete-error'), {\n                        entity: 'FacetValue',\n                    });\n                },\n            );\n    }\n\n    setLanguage(code: LanguageCode) {\n        this.dataService.client.setContentLanguage(code).subscribe();\n    }\n\n    private showModalAndDelete(facetId: string, message?: string) {\n        return this.modalService\n            .dialog({\n                title: _('catalog.confirm-delete-facet'),\n                body: message,\n                buttons: [\n                    { type: 'secondary', label: _('common.cancel') },\n                    {\n                        type: 'danger',\n                        label: message ? _('common.force-delete') : _('common.delete'),\n                        returnValue: true,\n                    },\n                ],\n            })\n            .pipe(\n                switchMap(res => (res ? this.dataService.facet.deleteFacet(facetId, !!message) : EMPTY)),\n                map(res => res.deleteFacet),\n            );\n    }\n}\n","/**\n * @description\n * Like String.prototype.replace(), but replaces the last instance\n * rather than the first.\n */\nexport function replaceLast(target: string | undefined | null, search: string, replace: string): string {\n    if (!target) {\n        return '';\n    }\n    const lastIndex = target.lastIndexOf(search);\n    if (lastIndex === -1) {\n        return target;\n    }\n    const head = target.substr(0, lastIndex);\n    const tail = target.substr(lastIndex).replace(search, replace);\n    return head + tail;\n}\n","import { Injectable } from '@angular/core';\nimport {\n    CreateProductInput,\n    CreateProductVariantInput,\n    DataService,\n    DeletionResult,\n    FacetWithValues,\n    findTranslation,\n    GetProductWithVariants,\n    LanguageCode,\n    UpdateProductInput,\n    UpdateProductMutation,\n    UpdateProductOptionInput,\n    UpdateProductVariantInput,\n    UpdateProductVariantsMutation,\n} from '@vendure/admin-ui/core';\nimport { normalizeString } from '@vendure/common/lib/normalize-string';\nimport { notNullOrUndefined } from '@vendure/common/lib/shared-utils';\nimport { forkJoin, Observable, of, throwError } from 'rxjs';\nimport { map, mergeMap, shareReplay, switchMap } from 'rxjs/operators';\n\nimport { CreateProductVariantsConfig } from '../../components/generate-product-variants/generate-product-variants.component';\n\nimport { replaceLast } from './replace-last';\n\n/**\n * Handles the logic for making the API calls to perform CRUD operations on a Product and its related\n * entities. This logic was extracted out of the component because it became too large and hard to follow.\n */\n@Injectable({\n    providedIn: 'root',\n})\nexport class ProductDetailService {\n    constructor(private dataService: DataService) {}\n\n    getFacets(): Observable<FacetWithValues.Fragment[]> {\n        return this.dataService.facet.getAllFacets().mapSingle(data => data.facets.items);\n    }\n\n    getTaxCategories() {\n        return this.dataService.settings\n            .getTaxCategories()\n            .mapSingle(data => data.taxCategories)\n            .pipe(shareReplay(1));\n    }\n\n    createProductWithVariants(\n        input: CreateProductInput,\n        createVariantsConfig: CreateProductVariantsConfig,\n        languageCode: LanguageCode,\n    ) {\n        const createProduct$ = this.dataService.product.createProduct(input);\n        const nonEmptyOptionGroups = createVariantsConfig.groups.filter(g => 0 < g.values.length);\n        const createOptionGroups$ = this.createProductOptionGroups(nonEmptyOptionGroups, languageCode);\n\n        return forkJoin(createProduct$, createOptionGroups$).pipe(\n            mergeMap(([{ createProduct }, optionGroups]) => {\n                const addOptionsToProduct$ = optionGroups.length\n                    ? forkJoin(\n                          optionGroups.map(optionGroup => {\n                              return this.dataService.product.addOptionGroupToProduct({\n                                  productId: createProduct.id,\n                                  optionGroupId: optionGroup.id,\n                              });\n                          }),\n                      )\n                    : of([]);\n                return addOptionsToProduct$.pipe(\n                    map(() => {\n                        return { createProduct, optionGroups };\n                    }),\n                );\n            }),\n            mergeMap(({ createProduct, optionGroups }) => {\n                const variants = createVariantsConfig.variants.map(v => {\n                    const optionIds = optionGroups.length\n                        ? v.optionValues.map((optionName, index) => {\n                              const option = optionGroups[index].options.find(o => o.name === optionName);\n                              if (!option) {\n                                  throw new Error(\n                                      `Could not find a matching ProductOption \"${optionName}\" when creating variant`,\n                                  );\n                              }\n                              return option.id;\n                          })\n                        : [];\n                    return {\n                        ...v,\n                        optionIds,\n                    };\n                });\n                const options = optionGroups.map(og => og.options).reduce((flat, o) => [...flat, ...o], []);\n                return this.createProductVariants(createProduct, variants, options, languageCode);\n            }),\n        );\n    }\n\n    createProductOptionGroups(groups: Array<{ name: string; values: string[] }>, languageCode: LanguageCode) {\n        return groups.length\n            ? forkJoin(\n                  groups.map(c => {\n                      return this.dataService.product\n                          .createProductOptionGroups({\n                              code: normalizeString(c.name, '-'),\n                              translations: [{ languageCode, name: c.name }],\n                              options: c.values.map(v => ({\n                                  code: normalizeString(v, '-'),\n                                  translations: [{ languageCode, name: v }],\n                              })),\n                          })\n                          .pipe(map(data => data.createProductOptionGroup));\n                  }),\n              )\n            : of([]);\n    }\n\n    createProductVariants(\n        product: { name: string; id: string },\n        variantData: Array<{ price: number; sku: string; stock: number; optionIds: string[] }>,\n        options: Array<{ id: string; name: string }>,\n        languageCode: LanguageCode,\n    ) {\n        const variants: CreateProductVariantInput[] = variantData.map(v => {\n            const name = options.length\n                ? `${product.name} ${v.optionIds\n                      .map(id => options.find(o => o.id === id))\n                      .filter(notNullOrUndefined)\n                      .map(o => o.name)\n                      .join(' ')}`\n                : product.name;\n            return {\n                productId: product.id,\n                price: v.price,\n                sku: v.sku,\n                stockOnHand: v.stock,\n                translations: [\n                    {\n                        languageCode,\n                        name,\n                    },\n                ],\n                optionIds: v.optionIds,\n            };\n        });\n        return this.dataService.product.createProductVariants(variants).pipe(\n            map(({ createProductVariants }) => ({\n                createProductVariants,\n                productId: product.id,\n            })),\n        );\n    }\n\n    updateProduct(updateOptions: {\n        product: GetProductWithVariants.Product;\n        languageCode: LanguageCode;\n        autoUpdate: boolean;\n        productInput?: UpdateProductInput;\n        variantsInput?: UpdateProductVariantInput[];\n    }) {\n        const { product, languageCode, autoUpdate, productInput, variantsInput } = updateOptions;\n        const updateOperations: Array<Observable<UpdateProductMutation | UpdateProductVariantsMutation>> = [];\n        const updateVariantsInput = variantsInput || [];\n\n        const variants$ = autoUpdate\n            ? this.dataService.product\n                  .getProductVariants({}, product.id)\n                  .mapSingle(({ productVariants }) => productVariants.items)\n            : of([]);\n\n        return variants$.pipe(\n            mergeMap(variants => {\n                if (productInput) {\n                    updateOperations.push(this.dataService.product.updateProduct(productInput));\n                    const productOldName = findTranslation(product, languageCode)?.name ?? '';\n                    const productNewName = findTranslation(productInput, languageCode)?.name;\n                    if (productNewName && productOldName !== productNewName && autoUpdate) {\n                        for (const variant of variants) {\n                            const currentVariantName = findTranslation(variant, languageCode)?.name || '';\n                            let variantInput: UpdateProductVariantInput;\n                            const existingVariantInput = updateVariantsInput.find(i => i.id === variant.id);\n                            if (existingVariantInput) {\n                                variantInput = existingVariantInput;\n                            } else {\n                                variantInput = {\n                                    id: variant.id,\n                                    translations: [{ languageCode, name: currentVariantName }],\n                                };\n                                updateVariantsInput.push(variantInput);\n                            }\n                            const variantTranslation = findTranslation(variantInput, languageCode);\n                            if (variantTranslation) {\n                                if (variantTranslation.name) {\n                                    variantTranslation.name = replaceLast(\n                                        variantTranslation.name,\n                                        productOldName,\n                                        productNewName,\n                                    );\n                                } else {\n                                    // The variant translation was falsy, which occurs\n                                    // when defining the product name for a new translation\n                                    // language that had not yet been defined.\n                                    variantTranslation.name = [\n                                        productNewName,\n                                        ...variant.options.map(o => o.name),\n                                    ].join(' ');\n                                }\n                            }\n                        }\n                    }\n                }\n                if (updateVariantsInput.length) {\n                    updateOperations.push(\n                        this.dataService.product.updateProductVariants(updateVariantsInput),\n                    );\n                }\n                return forkJoin(updateOperations);\n            }),\n        );\n    }\n\n    updateProductOption(\n        input: UpdateProductOptionInput & { autoUpdate: boolean },\n        product: GetProductWithVariants.Product,\n        languageCode: LanguageCode,\n    ) {\n        const variants$ = input.autoUpdate\n            ? this.dataService.product\n                  .getProductVariants({}, product.id)\n                  .mapSingle(({ productVariants }) => productVariants.items)\n            : of([]);\n\n        return variants$.pipe(\n            mergeMap(variants => {\n                let updateProductVariantNames$: Observable<any> = of([]);\n                if (input.autoUpdate) {\n                    // Update any ProductVariants' names which include the option name\n                    let oldOptionName: string | undefined;\n                    const newOptionName = findTranslation(input, languageCode)?.name;\n                    if (!newOptionName) {\n                        updateProductVariantNames$ = of([]);\n                    }\n                    const variantsToUpdate: UpdateProductVariantInput[] = [];\n                    for (const variant of variants) {\n                        if (variant.options.map(o => o.id).includes(input.id)) {\n                            if (!oldOptionName) {\n                                oldOptionName = findTranslation(\n                                    variant.options.find(o => o.id === input.id),\n                                    languageCode,\n                                )?.name;\n                            }\n                            const variantName = findTranslation(variant, languageCode)?.name || '';\n                            if (oldOptionName && newOptionName && variantName.includes(oldOptionName)) {\n                                variantsToUpdate.push({\n                                    id: variant.id,\n                                    translations: [\n                                        {\n                                            languageCode,\n                                            name: replaceLast(variantName, oldOptionName, newOptionName),\n                                        },\n                                    ],\n                                });\n                            }\n                        }\n                    }\n                    if (variantsToUpdate.length) {\n                        updateProductVariantNames$ =\n                            this.dataService.product.updateProductVariants(variantsToUpdate);\n                    }\n                }\n                return this.dataService.product\n                    .updateProductOption(input)\n                    .pipe(mergeMap(() => updateProductVariantNames$));\n            }),\n        );\n    }\n\n    deleteProductVariant(id: string, productId: string) {\n        return this.dataService.product.deleteProductVariant(id).pipe(\n            switchMap(result => {\n                if (result.deleteProductVariant.result === DeletionResult.DELETED) {\n                    return this.dataService.product.getProduct(productId).single$;\n                } else {\n                    return throwError(result.deleteProductVariant.message);\n                }\n            }),\n        );\n    }\n}\n","import {\n    AfterViewInit,\n    ChangeDetectionStrategy,\n    ChangeDetectorRef,\n    Component,\n    ViewChild,\n} from '@angular/core';\nimport { Dialog, FacetValue, FacetValueSelectorComponent, FacetWithValues } from '@vendure/admin-ui/core';\n\n@Component({\n    selector: 'vdr-apply-facet-dialog',\n    templateUrl: './apply-facet-dialog.component.html',\n    styleUrls: ['./apply-facet-dialog.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ApplyFacetDialogComponent implements Dialog<FacetValue[]>, AfterViewInit {\n    @ViewChild(FacetValueSelectorComponent) private selector: FacetValueSelectorComponent;\n    resolveWith: (result?: FacetValue[]) => void;\n    selectedValues: FacetValue[] = [];\n    // Provided by caller\n    facets: FacetWithValues.Fragment[];\n\n    constructor(private changeDetector: ChangeDetectorRef) {}\n\n    ngAfterViewInit() {\n        setTimeout(() => this.selector.focus(), 0);\n    }\n\n    selectValues() {\n        this.resolveWith(this.selectedValues);\n    }\n\n    cancel() {\n        this.resolveWith();\n    }\n}\n","import { ChangeDetectionStrategy, Component, OnInit } from '@angular/core';\nimport { FormControl } from '@angular/forms';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport { GetChannels, ProductVariantFragment } from '@vendure/admin-ui/core';\nimport { NotificationService } from '@vendure/admin-ui/core';\nimport { DataService } from '@vendure/admin-ui/core';\nimport { Dialog } from '@vendure/admin-ui/core';\nimport { combineLatest, from, Observable } from 'rxjs';\nimport { map, startWith, switchMap } from 'rxjs/operators';\n\n@Component({\n    selector: 'vdr-assign-products-to-channel-dialog',\n    templateUrl: './assign-products-to-channel-dialog.component.html',\n    styleUrls: ['./assign-products-to-channel-dialog.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class AssignProductsToChannelDialogComponent implements OnInit, Dialog<any> {\n    selectedChannel: GetChannels.Channels | null | undefined;\n    currentChannel: GetChannels.Channels;\n    availableChannels: GetChannels.Channels[];\n    resolveWith: (result?: any) => void;\n    variantsPreview$: Observable<Array<{ id: string; name: string; price: number; pricePreview: number }>>;\n    priceFactorControl = new FormControl(1);\n    selectedChannelIdControl = new FormControl();\n\n    // assigned by ModalService.fromComponent() call\n    productIds: string[];\n    productVariantIds: string[] | undefined;\n    currentChannelIds: string[];\n\n    get isProductVariantMode(): boolean {\n        return this.productVariantIds != null;\n    }\n\n    constructor(private dataService: DataService, private notificationService: NotificationService) {}\n\n    ngOnInit() {\n        const activeChannelId$ = this.dataService.client\n            .userStatus()\n            .mapSingle(({ userStatus }) => userStatus.activeChannelId);\n        const allChannels$ = this.dataService.settings.getChannels().mapSingle(data => data.channels);\n\n        combineLatest(activeChannelId$, allChannels$).subscribe(([activeChannelId, channels]) => {\n            // tslint:disable-next-line:no-non-null-assertion\n            this.currentChannel = channels.find(c => c.id === activeChannelId)!;\n            this.availableChannels = channels;\n        });\n\n        this.selectedChannelIdControl.valueChanges.subscribe(ids => {\n            this.selectChannel(ids);\n        });\n\n        this.variantsPreview$ = combineLatest(\n            from(this.getTopVariants(10)),\n            this.priceFactorControl.valueChanges.pipe(startWith(1)),\n        ).pipe(\n            map(([variants, factor]) => {\n                return variants.map(v => ({\n                    id: v.id,\n                    name: v.name,\n                    price: v.price,\n                    pricePreview: v.price * +factor,\n                }));\n            }),\n        );\n    }\n\n    selectChannel(channelIds: string[]) {\n        this.selectedChannel = this.availableChannels.find(c => c.id === channelIds[0]);\n    }\n\n    assign() {\n        const selectedChannel = this.selectedChannel;\n        if (selectedChannel) {\n            if (!this.isProductVariantMode) {\n                this.dataService.product\n                    .assignProductsToChannel({\n                        channelId: selectedChannel.id,\n                        productIds: this.productIds,\n                        priceFactor: +this.priceFactorControl.value,\n                    })\n                    .subscribe(() => {\n                        this.notificationService.success(_('catalog.assign-product-to-channel-success'), {\n                            channel: selectedChannel.code,\n                            count: this.productIds.length,\n                        });\n                        this.resolveWith(true);\n                    });\n            } else if (this.productVariantIds) {\n                this.dataService.product\n                    .assignVariantsToChannel({\n                        channelId: selectedChannel.id,\n                        productVariantIds: this.productVariantIds,\n                        priceFactor: +this.priceFactorControl.value,\n                    })\n                    .subscribe(() => {\n                        this.notificationService.success(_('catalog.assign-variant-to-channel-success'), {\n                            channel: selectedChannel.code,\n                            // tslint:disable-next-line:no-non-null-assertion\n                            count: this.productVariantIds!.length,\n                        });\n                        this.resolveWith(true);\n                    });\n            }\n        }\n    }\n\n    cancel() {\n        this.resolveWith();\n    }\n\n    private async getTopVariants(take: number): Promise<ProductVariantFragment[]> {\n        const variants: ProductVariantFragment[] = [];\n\n        for (let i = 0; i < this.productIds.length && variants.length < take; i++) {\n            const productVariants = await this.dataService.product\n                .getProduct(this.productIds[i], { take: this.isProductVariantMode ? undefined : take })\n                .mapSingle(({ product }) => {\n                    const _variants = product ? product.variantList.items : [];\n                    return _variants.filter(v =>\n                        this.isProductVariantMode ? this.productVariantIds?.includes(v.id) : true,\n                    );\n                })\n                .toPromise();\n            variants.push(...(productVariants || []));\n        }\n        return variants.slice(0, take);\n    }\n}\n","import { Location } from '@angular/common';\nimport { ChangeDetectionStrategy, ChangeDetectorRef, Component, OnDestroy, OnInit } from '@angular/core';\nimport { FormArray, FormBuilder, FormControl, FormGroup, Validators } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport {\n    Asset,\n    BaseDetailComponent,\n    CreateProductInput,\n    createUpdatedTranslatable,\n    CustomFieldConfig,\n    DataService,\n    FacetWithValues,\n    findTranslation,\n    flattenFacetValues,\n    getChannelCodeFromUserStatus,\n    GetProductWithVariants,\n    GlobalFlag,\n    LanguageCode,\n    LogicalOperator,\n    ModalService,\n    NotificationService,\n    Permission,\n    ProductDetail,\n    ProductVariant,\n    ServerConfigService,\n    TaxCategory,\n    unicodePatternValidator,\n    UpdateProductInput,\n    UpdateProductMutation,\n    UpdateProductOptionInput,\n    UpdateProductVariantInput,\n    UpdateProductVariantsMutation,\n} from '@vendure/admin-ui/core';\nimport { normalizeString } from '@vendure/common/lib/normalize-string';\nimport { DEFAULT_CHANNEL_CODE } from '@vendure/common/lib/shared-constants';\nimport { notNullOrUndefined } from '@vendure/common/lib/shared-utils';\nimport { unique } from '@vendure/common/lib/unique';\nimport { BehaviorSubject, combineLatest, EMPTY, from, merge, Observable } from 'rxjs';\nimport {\n    debounceTime,\n    distinctUntilChanged,\n    map,\n    mergeMap,\n    shareReplay,\n    skip,\n    skipUntil,\n    startWith,\n    switchMap,\n    take,\n    takeUntil,\n    tap,\n    withLatestFrom,\n} from 'rxjs/operators';\n\nimport { ProductDetailService } from '../../providers/product-detail/product-detail.service';\nimport { ApplyFacetDialogComponent } from '../apply-facet-dialog/apply-facet-dialog.component';\nimport { AssignProductsToChannelDialogComponent } from '../assign-products-to-channel-dialog/assign-products-to-channel-dialog.component';\nimport { CreateProductVariantsConfig } from '../generate-product-variants/generate-product-variants.component';\nimport { VariantAssetChange } from '../product-variants-list/product-variants-list.component';\n\nexport type TabName = 'details' | 'variants';\n\nexport interface VariantFormValue {\n    id: string;\n    enabled: boolean;\n    sku: string;\n    name: string;\n    price: number;\n    priceWithTax: number;\n    taxCategoryId: string;\n    stockOnHand: number;\n    useGlobalOutOfStockThreshold: boolean;\n    outOfStockThreshold: number;\n    trackInventory: GlobalFlag;\n    facetValueIds: string[];\n    customFields?: any;\n}\n\nexport interface SelectedAssets {\n    assets?: Asset[];\n    featuredAsset?: Asset;\n}\n\nexport interface PaginationConfig {\n    totalItems: number;\n    currentPage: number;\n    itemsPerPage: number;\n}\n\n@Component({\n    selector: 'vdr-product-detail',\n    templateUrl: './product-detail.component.html',\n    styleUrls: ['./product-detail.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ProductDetailComponent\n    extends BaseDetailComponent<GetProductWithVariants.Product>\n    implements OnInit, OnDestroy\n{\n    activeTab$: Observable<TabName>;\n    product$: Observable<GetProductWithVariants.Product>;\n    variants$: Observable<ProductVariant.Fragment[]>;\n    taxCategories$: Observable<TaxCategory.Fragment[]>;\n    customFields: CustomFieldConfig[];\n    customVariantFields: CustomFieldConfig[];\n    customOptionGroupFields: CustomFieldConfig[];\n    customOptionFields: CustomFieldConfig[];\n    detailForm: FormGroup;\n    filterInput = new FormControl('');\n    assetChanges: SelectedAssets = {};\n    variantAssetChanges: { [variantId: string]: SelectedAssets } = {};\n    variantFacetValueChanges: { [variantId: string]: string[] } = {};\n    productChannels$: Observable<ProductDetail.Channels[]>;\n    facetValues$: Observable<ProductDetail.FacetValues[]>;\n    facets$: Observable<FacetWithValues.Fragment[]>;\n    totalItems$: Observable<number>;\n    currentPage$ = new BehaviorSubject(1);\n    itemsPerPage$ = new BehaviorSubject(10);\n    paginationConfig$: Observable<PaginationConfig>;\n    selectedVariantIds: string[] = [];\n    variantDisplayMode: 'card' | 'table' = 'card';\n    createVariantsConfig: CreateProductVariantsConfig = { groups: [], variants: [] };\n    channelPriceIncludesTax$: Observable<boolean>;\n    // Used to store all ProductVariants which have been loaded.\n    // It is needed when saving changes to variants.\n    private productVariantMap = new Map<string, ProductVariant.Fragment>();\n    public readonly updatePermissions = [Permission.UpdateCatalog, Permission.UpdateProduct];\n\n    constructor(\n        route: ActivatedRoute,\n        router: Router,\n        serverConfigService: ServerConfigService,\n        private productDetailService: ProductDetailService,\n        private formBuilder: FormBuilder,\n        private modalService: ModalService,\n        private notificationService: NotificationService,\n        protected dataService: DataService,\n        private location: Location,\n        private changeDetector: ChangeDetectorRef,\n    ) {\n        super(route, router, serverConfigService, dataService);\n        this.customFields = this.getCustomFieldConfig('Product');\n        this.customVariantFields = this.getCustomFieldConfig('ProductVariant');\n        this.customOptionGroupFields = this.getCustomFieldConfig('ProductOptionGroup');\n        this.customOptionFields = this.getCustomFieldConfig('ProductOption');\n        this.detailForm = this.formBuilder.group({\n            product: this.formBuilder.group({\n                enabled: true,\n                name: ['', Validators.required],\n                autoUpdateVariantNames: true,\n                slug: ['', unicodePatternValidator(/^[\\p{Letter}0-9_-]+$/)],\n                description: '',\n                facetValueIds: [[]],\n                customFields: this.formBuilder.group(\n                    this.customFields.reduce((hash, field) => ({ ...hash, [field.name]: '' }), {}),\n                ),\n            }),\n            variants: this.formBuilder.array([]),\n        });\n    }\n\n    ngOnInit() {\n        this.init();\n        this.product$ = this.entity$;\n        this.totalItems$ = this.product$.pipe(map(product => product.variantList.totalItems));\n        this.paginationConfig$ = combineLatest(this.totalItems$, this.itemsPerPage$, this.currentPage$).pipe(\n            map(([totalItems, itemsPerPage, currentPage]) => ({\n                totalItems,\n                itemsPerPage,\n                currentPage,\n            })),\n        );\n        const variants$ = this.product$.pipe(map(product => product.variantList.items));\n        const filterTerm$ = this.filterInput.valueChanges.pipe(\n            startWith(''),\n            debounceTime(200),\n            shareReplay(),\n        );\n        const initialVariants$ = this.product$.pipe(map(p => p.variantList.items));\n        const updatedVariants$ = combineLatest(filterTerm$, this.currentPage$, this.itemsPerPage$).pipe(\n            skipUntil(initialVariants$),\n            skip(1),\n            switchMap(([term, currentPage, itemsPerPage]) => {\n                return this.dataService.product\n                    .getProductVariants(\n                        {\n                            skip: (currentPage - 1) * itemsPerPage,\n                            take: itemsPerPage,\n                            ...(term\n                                ? { filter: { name: { contains: term }, sku: { contains: term } } }\n                                : {}),\n                            filterOperator: LogicalOperator.OR,\n                        },\n                        this.id,\n                    )\n                    .mapStream(({ productVariants }) => productVariants.items);\n            }),\n            shareReplay({ bufferSize: 1, refCount: true }),\n        );\n        this.variants$ = merge(initialVariants$, updatedVariants$).pipe(\n            tap(variants => {\n                for (const variant of variants) {\n                    this.productVariantMap.set(variant.id, variant);\n                }\n            }),\n        );\n        this.taxCategories$ = this.productDetailService.getTaxCategories().pipe(takeUntil(this.destroy$));\n        this.activeTab$ = this.route.paramMap.pipe(map(qpm => qpm.get('tab') as any));\n\n        combineLatest(updatedVariants$, this.languageCode$)\n            .pipe(takeUntil(this.destroy$))\n            .subscribe(([variants, languageCode]) => {\n                this.buildVariantFormArray(variants, languageCode);\n            });\n\n        // FacetValues are provided initially by the nested array of the\n        // Product entity, but once a fetch to get all Facets is made (as when\n        // opening the FacetValue selector modal), then these additional values\n        // are concatenated onto the initial array.\n        this.facets$ = this.productDetailService.getFacets();\n        const productFacetValues$ = this.product$.pipe(map(product => product.facetValues));\n        const allFacetValues$ = this.facets$.pipe(map(flattenFacetValues));\n        const productGroup = this.getProductFormGroup();\n\n        const formFacetValueIdChanges$ = productGroup.valueChanges.pipe(\n            map(val => val.facetValueIds as string[]),\n            distinctUntilChanged(),\n        );\n        const formChangeFacetValues$ = combineLatest(\n            formFacetValueIdChanges$,\n            productFacetValues$,\n            allFacetValues$,\n        ).pipe(\n            map(([ids, productFacetValues, allFacetValues]) => {\n                const combined = [...productFacetValues, ...allFacetValues];\n                return ids.map(id => combined.find(fv => fv.id === id)).filter(notNullOrUndefined);\n            }),\n        );\n\n        this.facetValues$ = merge(productFacetValues$, formChangeFacetValues$);\n        this.productChannels$ = this.product$.pipe(map(p => p.channels));\n        this.channelPriceIncludesTax$ = this.dataService.settings\n            .getActiveChannel('cache-first')\n            .refetchOnChannelChange()\n            .mapStream(data => data.activeChannel.pricesIncludeTax)\n            .pipe(shareReplay(1));\n    }\n\n    ngOnDestroy() {\n        this.destroy();\n    }\n\n    navigateToTab(tabName: TabName) {\n        this.location.replaceState(\n            this.router\n                .createUrlTree(['./', { ...this.route.snapshot.params, tab: tabName }], {\n                    queryParamsHandling: 'merge',\n                    relativeTo: this.route,\n                })\n                .toString(),\n        );\n    }\n\n    isDefaultChannel(channelCode: string): boolean {\n        return channelCode === DEFAULT_CHANNEL_CODE;\n    }\n\n    setPage(page: number) {\n        this.currentPage$.next(page);\n    }\n\n    setItemsPerPage(value: string) {\n        this.itemsPerPage$.next(+value);\n        this.currentPage$.next(1);\n    }\n\n    assignToChannel() {\n        this.productChannels$\n            .pipe(\n                take(1),\n                switchMap(channels => {\n                    return this.modalService.fromComponent(AssignProductsToChannelDialogComponent, {\n                        size: 'lg',\n                        locals: {\n                            productIds: [this.id],\n                            currentChannelIds: channels.map(c => c.id),\n                        },\n                    });\n                }),\n            )\n            .subscribe();\n    }\n\n    removeFromChannel(channelId: string) {\n        from(getChannelCodeFromUserStatus(this.dataService, channelId))\n            .pipe(\n                switchMap(({ channelCode }) => {\n                    return this.modalService.dialog({\n                        title: _('catalog.remove-product-from-channel'),\n                        buttons: [\n                            { type: 'secondary', label: _('common.cancel') },\n                            {\n                                type: 'danger',\n                                label: _('catalog.remove-from-channel'),\n                                translationVars: { channelCode },\n                                returnValue: true,\n                            },\n                        ],\n                    });\n                }),\n                switchMap(response =>\n                    response\n                        ? this.dataService.product.removeProductsFromChannel({\n                              channelId,\n                              productIds: [this.id],\n                          })\n                        : EMPTY,\n                ),\n            )\n            .subscribe(\n                () => {\n                    this.notificationService.success(_('catalog.notify-remove-product-from-channel-success'));\n                },\n                err => {\n                    this.notificationService.error(_('catalog.notify-remove-product-from-channel-error'));\n                },\n            );\n    }\n\n    assignVariantToChannel(variant: ProductVariant.Fragment) {\n        return this.modalService\n            .fromComponent(AssignProductsToChannelDialogComponent, {\n                size: 'lg',\n                locals: {\n                    productIds: [this.id],\n                    productVariantIds: [variant.id],\n                    currentChannelIds: variant.channels.map(c => c.id),\n                },\n            })\n            .subscribe();\n    }\n\n    removeVariantFromChannel({\n        channelId,\n        variant,\n    }: {\n        channelId: string;\n        variant: ProductVariant.Fragment;\n    }) {\n        from(getChannelCodeFromUserStatus(this.dataService, channelId))\n            .pipe(\n                switchMap(({ channelCode }) => {\n                    return this.modalService.dialog({\n                        title: _('catalog.remove-product-variant-from-channel'),\n                        buttons: [\n                            { type: 'secondary', label: _('common.cancel') },\n                            {\n                                type: 'danger',\n                                label: _('catalog.remove-from-channel'),\n                                translationVars: { channelCode },\n                                returnValue: true,\n                            },\n                        ],\n                    });\n                }),\n                switchMap(response =>\n                    response\n                        ? this.dataService.product.removeVariantsFromChannel({\n                              channelId,\n                              productVariantIds: [variant.id],\n                          })\n                        : EMPTY,\n                ),\n            )\n            .subscribe(\n                () => {\n                    this.notificationService.success(_('catalog.notify-remove-variant-from-channel-success'));\n                },\n                err => {\n                    this.notificationService.error(_('catalog.notify-remove-variant-from-channel-error'));\n                },\n            );\n    }\n\n    assetsChanged(): boolean {\n        return !!Object.values(this.assetChanges).length;\n    }\n\n    variantAssetsChanged(): boolean {\n        return !!Object.keys(this.variantAssetChanges).length;\n    }\n\n    variantAssetChange(event: VariantAssetChange) {\n        this.variantAssetChanges[event.variantId] = event;\n    }\n\n    /**\n     * If creating a new product, automatically generate the slug based on the product name.\n     */\n    updateSlug(nameValue: string) {\n        combineLatest(this.entity$, this.languageCode$)\n            .pipe(take(1))\n            .subscribe(([entity, languageCode]) => {\n                const slugControl = this.detailForm.get(['product', 'slug']);\n                const currentTranslation = findTranslation(entity, languageCode);\n                const currentSlugIsEmpty = !currentTranslation || !currentTranslation.slug;\n                if (slugControl && slugControl.pristine && currentSlugIsEmpty) {\n                    slugControl.setValue(normalizeString(`${nameValue}`, '-'));\n                }\n            });\n    }\n\n    selectProductFacetValue() {\n        this.displayFacetValueModal().subscribe(facetValueIds => {\n            if (facetValueIds) {\n                const productGroup = this.getProductFormGroup();\n                const currentFacetValueIds = productGroup.value.facetValueIds;\n                productGroup.patchValue({\n                    facetValueIds: unique([...currentFacetValueIds, ...facetValueIds]),\n                });\n                productGroup.markAsDirty();\n            }\n        });\n    }\n\n    updateProductOption(input: UpdateProductOptionInput & { autoUpdate: boolean }) {\n        combineLatest(this.product$, this.languageCode$)\n            .pipe(\n                take(1),\n                mergeMap(([product, languageCode]) =>\n                    this.productDetailService.updateProductOption(input, product, languageCode),\n                ),\n            )\n            .subscribe(\n                () => {\n                    this.notificationService.success(_('common.notify-update-success'), {\n                        entity: 'ProductOption',\n                    });\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-update-error'), {\n                        entity: 'ProductOption',\n                    });\n                },\n            );\n    }\n\n    removeProductFacetValue(facetValueId: string) {\n        const productGroup = this.getProductFormGroup();\n        const currentFacetValueIds = productGroup.value.facetValueIds;\n        productGroup.patchValue({\n            facetValueIds: currentFacetValueIds.filter(id => id !== facetValueId),\n        });\n        productGroup.markAsDirty();\n    }\n\n    /**\n     * Opens a dialog to select FacetValues to apply to the select ProductVariants.\n     */\n    selectVariantFacetValue(selectedVariantIds: string[]) {\n        this.displayFacetValueModal()\n            .pipe(withLatestFrom(this.variants$))\n            .subscribe(([facetValueIds, variants]) => {\n                if (facetValueIds) {\n                    for (const variantId of selectedVariantIds) {\n                        const index = variants.findIndex(v => v.id === variantId);\n                        const variant = variants[index];\n                        const existingFacetValueIds = variant ? variant.facetValues.map(fv => fv.id) : [];\n                        const variantFormGroup = (this.detailForm.get('variants') as FormArray).controls.find(\n                            c => c.value.id === variantId,\n                        );\n                        if (variantFormGroup) {\n                            const uniqueFacetValueIds = unique([...existingFacetValueIds, ...facetValueIds]);\n                            variantFormGroup.patchValue({\n                                facetValueIds: uniqueFacetValueIds,\n                            });\n                            variantFormGroup.markAsDirty();\n                            this.variantFacetValueChanges[variantId] = uniqueFacetValueIds;\n                        }\n                    }\n                    this.changeDetector.markForCheck();\n                }\n            });\n    }\n\n    variantsToCreateAreValid(): boolean {\n        return (\n            0 < this.createVariantsConfig.variants.length &&\n            this.createVariantsConfig.variants.every(v => {\n                return v.sku !== '';\n            })\n        );\n    }\n\n    private displayFacetValueModal(): Observable<string[] | undefined> {\n        return this.productDetailService.getFacets().pipe(\n            mergeMap(facets =>\n                this.modalService.fromComponent(ApplyFacetDialogComponent, {\n                    size: 'md',\n                    closable: true,\n                    locals: { facets },\n                }),\n            ),\n            map(facetValues => facetValues && facetValues.map(v => v.id)),\n        );\n    }\n\n    create() {\n        const productGroup = this.getProductFormGroup();\n        if (!productGroup.dirty) {\n            return;\n        }\n        combineLatest(this.product$, this.languageCode$)\n            .pipe(\n                take(1),\n                mergeMap(([product, languageCode]) => {\n                    const newProduct = this.getUpdatedProduct(\n                        product,\n                        productGroup as FormGroup,\n                        languageCode,\n                    ) as CreateProductInput;\n                    return this.productDetailService.createProductWithVariants(\n                        newProduct,\n                        this.createVariantsConfig,\n                        languageCode,\n                    );\n                }),\n            )\n            .subscribe(\n                ({ createProductVariants, productId }) => {\n                    this.notificationService.success(_('common.notify-create-success'), {\n                        entity: 'Product',\n                    });\n                    this.assetChanges = {};\n                    this.variantAssetChanges = {};\n                    this.detailForm.markAsPristine();\n                    this.router.navigate(['../', productId], { relativeTo: this.route });\n                },\n                err => {\n                    // tslint:disable-next-line:no-console\n                    console.error(err);\n                    this.notificationService.error(_('common.notify-create-error'), {\n                        entity: 'Product',\n                    });\n                },\n            );\n    }\n\n    save() {\n        combineLatest(this.product$, this.languageCode$, this.channelPriceIncludesTax$)\n            .pipe(\n                take(1),\n                mergeMap(([product, languageCode, priceIncludesTax]) => {\n                    const productGroup = this.getProductFormGroup();\n                    let productInput: UpdateProductInput | undefined;\n                    let variantsInput: UpdateProductVariantInput[] | undefined;\n\n                    if (productGroup.dirty || this.assetsChanged()) {\n                        productInput = this.getUpdatedProduct(\n                            product,\n                            productGroup as FormGroup,\n                            languageCode,\n                        ) as UpdateProductInput;\n                    }\n                    const variantsArray = this.detailForm.get('variants');\n                    if ((variantsArray && variantsArray.dirty) || this.variantAssetsChanged()) {\n                        variantsInput = this.getUpdatedProductVariants(\n                            product,\n                            variantsArray as FormArray,\n                            languageCode,\n                            priceIncludesTax,\n                        );\n                    }\n\n                    return this.productDetailService.updateProduct({\n                        product,\n                        languageCode,\n                        autoUpdate:\n                            this.detailForm.get(['product', 'autoUpdateVariantNames'])?.value ?? false,\n                        productInput,\n                        variantsInput,\n                    });\n                }),\n            )\n            .subscribe(\n                result => {\n                    this.updateSlugAfterSave(result);\n                    this.detailForm.markAsPristine();\n                    this.assetChanges = {};\n                    this.variantAssetChanges = {};\n                    this.notificationService.success(_('common.notify-update-success'), {\n                        entity: 'Product',\n                    });\n                    this.changeDetector.markForCheck();\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-update-error'), {\n                        entity: 'Product',\n                    });\n                },\n            );\n    }\n\n    canDeactivate(): boolean {\n        return super.canDeactivate() && !this.assetChanges.assets && !this.assetChanges.featuredAsset;\n    }\n\n    /**\n     * Sets the values of the form on changes to the product or current language.\n     */\n    protected setFormValues(product: GetProductWithVariants.Product, languageCode: LanguageCode) {\n        const currentTranslation = findTranslation(product, languageCode);\n        this.detailForm.patchValue({\n            product: {\n                enabled: product.enabled,\n                name: currentTranslation ? currentTranslation.name : '',\n                slug: currentTranslation ? currentTranslation.slug : '',\n                description: currentTranslation ? currentTranslation.description : '',\n                facetValueIds: product.facetValues.map(fv => fv.id),\n            },\n        });\n\n        if (this.customFields.length) {\n            this.setCustomFieldFormValues(\n                this.customFields,\n                this.detailForm.get(['product', 'customFields']),\n                product,\n                currentTranslation,\n            );\n        }\n        this.buildVariantFormArray(product.variantList.items, languageCode);\n    }\n\n    private buildVariantFormArray(variants: ProductVariant.Fragment[], languageCode: LanguageCode) {\n        const variantsFormArray = this.detailForm.get('variants') as FormArray;\n        variants.forEach((variant, i) => {\n            const variantTranslation = findTranslation(variant, languageCode);\n            const pendingFacetValueChanges = this.variantFacetValueChanges[variant.id];\n            const facetValueIds = pendingFacetValueChanges\n                ? pendingFacetValueChanges\n                : variant.facetValues.map(fv => fv.id);\n            const group: VariantFormValue = {\n                id: variant.id,\n                enabled: variant.enabled,\n                sku: variant.sku,\n                name: variantTranslation ? variantTranslation.name : '',\n                price: variant.price,\n                priceWithTax: variant.priceWithTax,\n                taxCategoryId: variant.taxCategory.id,\n                stockOnHand: variant.stockOnHand,\n                useGlobalOutOfStockThreshold: variant.useGlobalOutOfStockThreshold,\n                outOfStockThreshold: variant.outOfStockThreshold,\n                trackInventory: variant.trackInventory,\n                facetValueIds,\n            };\n\n            let variantFormGroup = variantsFormArray.controls.find(c => c.value.id === variant.id) as\n                | FormGroup\n                | undefined;\n            if (variantFormGroup) {\n                if (variantFormGroup.pristine) {\n                    variantFormGroup.patchValue(group);\n                }\n            } else {\n                variantFormGroup = this.formBuilder.group({\n                    ...group,\n                    facetValueIds: this.formBuilder.control(facetValueIds),\n                });\n                variantsFormArray.insert(i, variantFormGroup);\n            }\n            if (this.customVariantFields.length) {\n                let customFieldsGroup = variantFormGroup.get(['customFields']) as FormGroup | undefined;\n\n                if (!customFieldsGroup) {\n                    customFieldsGroup = this.formBuilder.group(\n                        this.customVariantFields.reduce((hash, field) => ({ ...hash, [field.name]: '' }), {}),\n                    );\n                    variantFormGroup.addControl('customFields', customFieldsGroup);\n                }\n                this.setCustomFieldFormValues(\n                    this.customVariantFields,\n                    customFieldsGroup,\n                    variant,\n                    variantTranslation,\n                );\n            }\n        });\n    }\n\n    /**\n     * Given a product and the value of the detailForm, this method creates an updated copy of the product which\n     * can then be persisted to the API.\n     */\n    private getUpdatedProduct(\n        product: GetProductWithVariants.Product,\n        productFormGroup: FormGroup,\n        languageCode: LanguageCode,\n    ): UpdateProductInput | CreateProductInput {\n        const updatedProduct = createUpdatedTranslatable({\n            translatable: product,\n            updatedFields: productFormGroup.value,\n            customFieldConfig: this.customFields,\n            languageCode,\n            defaultTranslation: {\n                languageCode,\n                name: product.name || '',\n                slug: product.slug || '',\n                description: product.description || '',\n            },\n        });\n        return {\n            ...updatedProduct,\n            assetIds: this.assetChanges.assets?.map(a => a.id),\n            featuredAssetId: this.assetChanges.featuredAsset?.id,\n            facetValueIds: productFormGroup.value.facetValueIds,\n        } as UpdateProductInput | CreateProductInput;\n    }\n\n    /**\n     * Given an array of product variants and the values from the detailForm, this method creates an new array\n     * which can be persisted to the API.\n     */\n    private getUpdatedProductVariants(\n        product: GetProductWithVariants.Product,\n        variantsFormArray: FormArray,\n        languageCode: LanguageCode,\n        priceIncludesTax: boolean,\n    ): UpdateProductVariantInput[] {\n        const dirtyFormControls = variantsFormArray.controls.filter(c => c.dirty);\n        const dirtyVariants = dirtyFormControls\n            .map(c => this.productVariantMap.get(c.value.id))\n            .filter(notNullOrUndefined);\n        const dirtyVariantValues = dirtyFormControls.map(c => c.value);\n\n        if (dirtyVariants.length !== dirtyVariantValues.length) {\n            throw new Error(_(`error.product-variant-form-values-do-not-match`));\n        }\n        return dirtyVariants\n            .map((variant, i) => {\n                const formValue: VariantFormValue = dirtyVariantValues.find(value => value.id === variant.id);\n                const result: UpdateProductVariantInput = createUpdatedTranslatable({\n                    translatable: variant,\n                    updatedFields: formValue,\n                    customFieldConfig: this.customVariantFields,\n                    languageCode,\n                    defaultTranslation: {\n                        languageCode,\n                        name: '',\n                    },\n                });\n                result.taxCategoryId = formValue.taxCategoryId;\n                result.facetValueIds = formValue.facetValueIds;\n                result.price = priceIncludesTax ? formValue.priceWithTax : formValue.price;\n                const assetChanges = this.variantAssetChanges[variant.id];\n                if (assetChanges) {\n                    result.featuredAssetId = assetChanges.featuredAsset?.id;\n                    result.assetIds = assetChanges.assets?.map(a => a.id);\n                }\n                return result;\n            })\n            .filter(notNullOrUndefined);\n    }\n\n    private getProductFormGroup(): FormGroup {\n        return this.detailForm.get('product') as FormGroup;\n    }\n\n    /**\n     * The server may alter the slug value in order to normalize and ensure uniqueness upon saving.\n     */\n    private updateSlugAfterSave(results: Array<UpdateProductMutation | UpdateProductVariantsMutation>) {\n        const firstResult = results[0];\n        const slugControl = this.detailForm.get(['product', 'slug']);\n\n        function isUpdateMutation(input: any): input is UpdateProductMutation {\n            return input.hasOwnProperty('updateProduct');\n        }\n\n        if (slugControl && isUpdateMutation(firstResult)) {\n            slugControl.setValue(firstResult.updateProduct.slug, { emitEvent: false });\n        }\n    }\n}\n","import { AfterViewInit, Component, OnInit, ViewChild } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport {\n    BaseListComponent,\n    DataService,\n    JobQueueService,\n    JobState,\n    LanguageCode,\n    LogicalOperator,\n    ModalService,\n    NotificationService,\n    ProductSearchInputComponent,\n    SearchInput,\n    SearchProducts,\n    SelectionManager,\n    ServerConfigService,\n} from '@vendure/admin-ui/core';\nimport { EMPTY, Observable } from 'rxjs';\nimport { delay, map, switchMap, take, takeUntil, tap, withLatestFrom } from 'rxjs/operators';\n\n@Component({\n    selector: 'vdr-products-list',\n    templateUrl: './product-list.component.html',\n    styleUrls: ['./product-list.component.scss'],\n})\nexport class ProductListComponent\n    extends BaseListComponent<SearchProducts.Query, SearchProducts.Items, SearchProducts.Variables>\n    implements OnInit, AfterViewInit\n{\n    searchTerm = '';\n    facetValueIds: string[] = [];\n    groupByProduct = true;\n    selectedFacetValueIds$: Observable<string[]>;\n    facetValues$: Observable<SearchProducts.FacetValues[]>;\n    availableLanguages$: Observable<LanguageCode[]>;\n    contentLanguage$: Observable<LanguageCode>;\n    pendingSearchIndexUpdates = 0;\n    selectionManager: SelectionManager<SearchProducts.Items>;\n\n    @ViewChild('productSearchInputComponent', { static: true })\n    private productSearchInput: ProductSearchInputComponent;\n\n    constructor(\n        private dataService: DataService,\n        private modalService: ModalService,\n        private notificationService: NotificationService,\n        private jobQueueService: JobQueueService,\n        private serverConfigService: ServerConfigService,\n        router: Router,\n        route: ActivatedRoute,\n    ) {\n        super(router, route);\n        this.route.queryParamMap\n            .pipe(\n                map(qpm => qpm.get('q')),\n                takeUntil(this.destroy$),\n            )\n            .subscribe(term => {\n                this.searchTerm = term || '';\n                if (this.productSearchInput) {\n                    this.productSearchInput.setSearchTerm(term);\n                }\n            });\n        this.selectedFacetValueIds$ = this.route.queryParamMap.pipe(map(qpm => qpm.getAll('fvids')));\n\n        this.selectedFacetValueIds$.pipe(takeUntil(this.destroy$)).subscribe(ids => {\n            this.facetValueIds = ids;\n            if (this.productSearchInput) {\n                this.productSearchInput.setFacetValues(ids);\n            }\n        });\n        super.setQueryFn(\n            (...args: any[]) =>\n                this.dataService.product.searchProducts(this.searchTerm, ...args).refetchOnChannelChange(),\n            data => data.search,\n            // tslint:disable-next-line:no-shadowed-variable\n            (skip, take) => ({\n                input: {\n                    skip,\n                    take,\n                    term: this.searchTerm,\n                    facetValueIds: this.facetValueIds,\n                    facetValueOperator: LogicalOperator.AND,\n                    groupByProduct: this.groupByProduct,\n                } as SearchInput,\n            }),\n        );\n        this.selectionManager = new SelectionManager<SearchProducts.Items>({\n            multiSelect: true,\n            itemsAreEqual: (a, b) =>\n                this.groupByProduct ? a.productId === b.productId : a.productVariantId === b.productVariantId,\n            additiveMode: true,\n        });\n    }\n\n    ngOnInit() {\n        super.ngOnInit();\n\n        this.facetValues$ = this.result$.pipe(map(data => data.search.facetValues));\n\n        this.facetValues$\n            .pipe(take(1), delay(100), withLatestFrom(this.selectedFacetValueIds$))\n            .subscribe(([__, ids]) => {\n                this.productSearchInput.setFacetValues(ids);\n            });\n        this.availableLanguages$ = this.serverConfigService.getAvailableLanguages();\n        this.contentLanguage$ = this.dataService.client\n            .uiState()\n            .mapStream(({ uiState }) => uiState.contentLanguage)\n            .pipe(tap(() => this.refresh()));\n\n        this.dataService.product\n            .getPendingSearchIndexUpdates()\n            .mapSingle(({ pendingSearchIndexUpdates }) => pendingSearchIndexUpdates)\n            .subscribe(value => (this.pendingSearchIndexUpdates = value));\n    }\n\n    ngAfterViewInit() {\n        if (this.productSearchInput && this.searchTerm) {\n            setTimeout(() => this.productSearchInput.setSearchTerm(this.searchTerm));\n        }\n    }\n\n    setSearchTerm(term: string) {\n        this.searchTerm = term;\n        this.setQueryParam({ q: term || null, page: 1 });\n        this.refresh();\n    }\n\n    setFacetValueIds(ids: string[]) {\n        this.facetValueIds = ids;\n        this.setQueryParam({ fvids: ids, page: 1 });\n        this.refresh();\n    }\n\n    rebuildSearchIndex() {\n        this.dataService.product.reindex().subscribe(({ reindex }) => {\n            this.notificationService.info(_('catalog.reindexing'));\n            this.jobQueueService.addJob(reindex.id, job => {\n                if (job.state === JobState.COMPLETED) {\n                    const time = new Intl.NumberFormat().format(job.duration || 0);\n                    this.notificationService.success(_('catalog.reindex-successful'), {\n                        count: job.result.indexedItemCount,\n                        time,\n                    });\n                    this.refresh();\n                } else {\n                    this.notificationService.error(_('catalog.reindex-error'));\n                }\n            });\n        });\n    }\n\n    runPendingSearchIndexUpdates() {\n        this.dataService.product.runPendingSearchIndexUpdates().subscribe(value => {\n            this.notificationService.info(_('catalog.running-search-index-updates'), {\n                count: this.pendingSearchIndexUpdates,\n            });\n            this.pendingSearchIndexUpdates = 0;\n        });\n    }\n\n    deleteProduct(productId: string) {\n        this.modalService\n            .dialog({\n                title: _('catalog.confirm-delete-product'),\n                buttons: [\n                    { type: 'secondary', label: _('common.cancel') },\n                    { type: 'danger', label: _('common.delete'), returnValue: true },\n                ],\n            })\n            .pipe(\n                switchMap(response => (response ? this.dataService.product.deleteProduct(productId) : EMPTY)),\n                // Short delay to allow the product to be removed from the search index before\n                // refreshing.\n                delay(500),\n            )\n            .subscribe(\n                () => {\n                    this.notificationService.success(_('common.notify-delete-success'), {\n                        entity: 'Product',\n                    });\n                    this.refresh();\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-delete-error'), {\n                        entity: 'Product',\n                    });\n                },\n            );\n    }\n\n    setLanguage(code: LanguageCode) {\n        this.dataService.client.setContentLanguage(code).subscribe();\n    }\n}\n","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, OnInit } from '@angular/core';\nimport { FormArray, FormBuilder, FormControl, FormGroup } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport {\n    BaseDetailComponent,\n    CreateFacetInput,\n    createUpdatedTranslatable,\n    CustomFieldConfig,\n    DataService,\n    FacetWithValues,\n    findTranslation,\n    GetProductVariantOptions,\n    LanguageCode,\n    NotificationService,\n    Permission,\n    ProductOption,\n    ProductOptionGroup,\n    ServerConfigService,\n    UpdateFacetInput,\n    UpdateProductOptionGroupInput,\n    UpdateProductOptionInput,\n} from '@vendure/admin-ui/core';\nimport { combineLatest, forkJoin, Observable } from 'rxjs';\nimport { map, mergeMap, take } from 'rxjs/operators';\n\nimport { ProductDetailService } from '../../providers/product-detail/product-detail.service';\n\n@Component({\n    selector: 'vdr-product-options-editor',\n    templateUrl: './product-options-editor.component.html',\n    styleUrls: ['./product-options-editor.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ProductOptionsEditorComponent\n    extends BaseDetailComponent<GetProductVariantOptions.Product>\n    implements OnInit\n{\n    detailForm: FormGroup;\n    optionGroups$: Observable<GetProductVariantOptions.OptionGroups[]>;\n    languageCode$: Observable<LanguageCode>;\n    availableLanguages$: Observable<LanguageCode[]>;\n    optionGroupCustomFields: CustomFieldConfig[];\n    optionCustomFields: CustomFieldConfig[];\n    autoUpdateVariantNames = true;\n    readonly updatePermission = [Permission.UpdateCatalog, Permission.UpdateProduct];\n\n    constructor(\n        protected route: ActivatedRoute,\n        protected router: Router,\n        protected serverConfigService: ServerConfigService,\n        protected dataService: DataService,\n        private productDetailService: ProductDetailService,\n        private formBuilder: FormBuilder,\n        private changeDetector: ChangeDetectorRef,\n        private notificationService: NotificationService,\n    ) {\n        super(route, router, serverConfigService, dataService);\n        this.optionGroupCustomFields = this.getCustomFieldConfig('ProductOptionGroup');\n        this.optionCustomFields = this.getCustomFieldConfig('ProductOption');\n    }\n\n    ngOnInit(): void {\n        this.optionGroups$ = this.route.snapshot.data.entity.pipe(\n            map((product: GetProductVariantOptions.Product) => product.optionGroups),\n        );\n        this.detailForm = new FormGroup({\n            optionGroups: new FormArray([]),\n        });\n        super.init();\n    }\n\n    getOptionGroups(): FormGroup[] {\n        const optionGroups = this.detailForm.get('optionGroups');\n        return (optionGroups as FormArray).controls as FormGroup[];\n    }\n\n    getOptions(optionGroup: FormGroup): FormGroup[] {\n        const options = optionGroup.get('options');\n        return (options as FormArray).controls as FormGroup[];\n    }\n\n    save() {\n        if (this.detailForm.invalid || this.detailForm.pristine) {\n            return;\n        }\n        // tslint:disable-next-line:no-non-null-assertion\n        const $product = this.dataService.product.getProduct(this.id).mapSingle(data => data.product!);\n        combineLatest(this.entity$, this.languageCode$, $product)\n            .pipe(\n                take(1),\n                mergeMap(([{ optionGroups }, languageCode, product]) => {\n                    const updateOperations: Array<Observable<any>> = [];\n                    for (const optionGroupForm of this.getOptionGroups()) {\n                        if (optionGroupForm.get('name')?.dirty || optionGroupForm.get('code')?.dirty) {\n                            const optionGroupEntity = optionGroups.find(\n                                og => og.id === optionGroupForm.value.id,\n                            );\n                            if (optionGroupEntity) {\n                                const input = this.getUpdatedOptionGroup(\n                                    optionGroupEntity,\n                                    optionGroupForm,\n                                    languageCode,\n                                );\n                                updateOperations.push(\n                                    this.dataService.product.updateProductOptionGroup(input),\n                                );\n                            }\n                        }\n\n                        for (const optionForm of this.getOptions(optionGroupForm)) {\n                            if (optionForm.get('name')?.dirty || optionForm.get('code')?.dirty) {\n                                const optionGroup = optionGroups\n                                    .find(og => og.id === optionGroupForm.value.id)\n                                    ?.options.find(o => o.id === optionForm.value.id);\n                                if (optionGroup) {\n                                    const input = this.getUpdatedOption(\n                                        optionGroup,\n                                        optionForm,\n                                        languageCode,\n                                    );\n                                    updateOperations.push(\n                                        this.productDetailService.updateProductOption(\n                                            { ...input, autoUpdate: this.autoUpdateVariantNames },\n                                            product,\n                                            languageCode,\n                                        ),\n                                    );\n                                }\n                            }\n                        }\n                    }\n                    return forkJoin(updateOperations);\n                }),\n            )\n            .subscribe(\n                () => {\n                    this.detailForm.markAsPristine();\n                    this.changeDetector.markForCheck();\n                    this.notificationService.success(_('common.notify-update-success'), {\n                        entity: 'ProductOptionGroup',\n                    });\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-update-error'), {\n                        entity: 'ProductOptionGroup',\n                    });\n                },\n            );\n    }\n\n    private getUpdatedOptionGroup(\n        optionGroup: ProductOptionGroup.Fragment,\n        optionGroupFormGroup: FormGroup,\n        languageCode: LanguageCode,\n    ): UpdateProductOptionGroupInput {\n        const input = createUpdatedTranslatable({\n            translatable: optionGroup,\n            updatedFields: optionGroupFormGroup.value,\n            customFieldConfig: this.optionGroupCustomFields,\n            languageCode,\n            defaultTranslation: {\n                languageCode,\n                name: optionGroup.name || '',\n            },\n        });\n        return input;\n    }\n\n    private getUpdatedOption(\n        option: ProductOption.Fragment,\n        optionFormGroup: FormGroup,\n        languageCode: LanguageCode,\n    ): UpdateProductOptionInput {\n        const input = createUpdatedTranslatable({\n            translatable: option,\n            updatedFields: optionFormGroup.value,\n            customFieldConfig: this.optionGroupCustomFields,\n            languageCode,\n            defaultTranslation: {\n                languageCode,\n                name: option.name || '',\n            },\n        });\n        return input;\n    }\n\n    protected setFormValues(entity: GetProductVariantOptions.Product, languageCode: LanguageCode): void {\n        const groupsFormArray = new FormArray([]);\n        for (const optionGroup of entity.optionGroups) {\n            const groupTranslation = findTranslation(optionGroup, languageCode);\n            const group = {\n                id: optionGroup.id,\n                createdAt: optionGroup.createdAt,\n                updatedAt: optionGroup.updatedAt,\n                code: optionGroup.code,\n                name: groupTranslation ? groupTranslation.name : '',\n            };\n            const optionsFormArray = new FormArray([]);\n\n            for (const option of optionGroup.options) {\n                const optionTranslation = findTranslation(option, languageCode);\n                const optionControl = this.formBuilder.group({\n                    id: option.id,\n                    createdAt: option.createdAt,\n                    updatedAt: option.updatedAt,\n                    code: option.code,\n                    name: optionTranslation ? optionTranslation.name : '',\n                });\n                optionsFormArray.push(optionControl);\n            }\n\n            const groupControl = this.formBuilder.group(group);\n            groupControl.addControl('options', optionsFormArray);\n            groupsFormArray.push(groupControl);\n        }\n        this.detailForm.setControl('optionGroups', groupsFormArray);\n    }\n}\n","import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { Dialog, GetProductVariantOptions } from '@vendure/admin-ui/core';\n\n@Component({\n    selector: 'vdr-confirm-variant-deletion-dialog',\n    templateUrl: './confirm-variant-deletion-dialog.component.html',\n    styleUrls: ['./confirm-variant-deletion-dialog.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ConfirmVariantDeletionDialogComponent implements Dialog<boolean> {\n    resolveWith: (result?: boolean) => void;\n    variants: GetProductVariantOptions.Variants[] = [];\n\n    confirm() {\n        this.resolveWith(true);\n    }\n\n    cancel() {\n        this.resolveWith();\n    }\n}\n","import { ChangeDetectionStrategy, Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport {\n    CreateProductOptionGroup,\n    CreateProductOptionInput,\n    CurrencyCode,\n    DataService,\n    DeactivateAware,\n    DeletionResult,\n    getDefaultUiLanguage,\n    GetProductVariantOptions,\n    LanguageCode,\n    ModalService,\n    NotificationService,\n    ProductOptionGroupWithOptionsFragment,\n} from '@vendure/admin-ui/core';\nimport { normalizeString } from '@vendure/common/lib/normalize-string';\nimport { pick } from '@vendure/common/lib/pick';\nimport { generateAllCombinations, notNullOrUndefined } from '@vendure/common/lib/shared-utils';\nimport { unique } from '@vendure/common/lib/unique';\nimport { EMPTY, forkJoin, Observable, of } from 'rxjs';\nimport { defaultIfEmpty, filter, map, mergeMap, switchMap } from 'rxjs/operators';\n\nimport { ProductDetailService } from '../../providers/product-detail/product-detail.service';\nimport { ConfirmVariantDeletionDialogComponent } from '../confirm-variant-deletion-dialog/confirm-variant-deletion-dialog.component';\n\nexport class GeneratedVariant {\n    isDefault: boolean;\n    options: Array<{ name: string; id?: string }>;\n    productVariantId?: string;\n    enabled: boolean;\n    existing: boolean;\n    sku: string;\n    price: number;\n    stock: number;\n\n    constructor(config: Partial<GeneratedVariant>) {\n        for (const key of Object.keys(config)) {\n            this[key] = config[key];\n        }\n    }\n}\n\ninterface OptionGroupUiModel {\n    id?: string;\n    isNew: boolean;\n    name: string;\n    locked: boolean;\n    values: Array<{\n        id?: string;\n        name: string;\n        locked: boolean;\n    }>;\n}\n\n@Component({\n    selector: 'vdr-product-variants-editor',\n    templateUrl: './product-variants-editor.component.html',\n    styleUrls: ['./product-variants-editor.component.scss'],\n    changeDetection: ChangeDetectionStrategy.Default,\n})\nexport class ProductVariantsEditorComponent implements OnInit, DeactivateAware {\n    formValueChanged = false;\n    optionsChanged = false;\n    generatedVariants: GeneratedVariant[] = [];\n    optionGroups: OptionGroupUiModel[];\n    product: GetProductVariantOptions.Product;\n    currencyCode: CurrencyCode;\n    private languageCode: LanguageCode;\n\n    constructor(\n        private route: ActivatedRoute,\n        private dataService: DataService,\n        private productDetailService: ProductDetailService,\n        private notificationService: NotificationService,\n        private modalService: ModalService,\n    ) {}\n\n    ngOnInit() {\n        this.initOptionsAndVariants();\n        this.languageCode =\n            (this.route.snapshot.paramMap.get('lang') as LanguageCode) || getDefaultUiLanguage();\n        this.dataService.settings.getActiveChannel().single$.subscribe(data => {\n            this.currencyCode = data.activeChannel.currencyCode;\n        });\n    }\n\n    onFormChanged(variantInfo: GeneratedVariant) {\n        this.formValueChanged = true;\n        variantInfo.enabled = true;\n    }\n\n    canDeactivate(): boolean {\n        return !this.formValueChanged;\n    }\n\n    getVariantsToAdd() {\n        return this.generatedVariants.filter(v => !v.existing && v.enabled);\n    }\n\n    getVariantName(variant: GeneratedVariant) {\n        return variant.options.length === 0\n            ? _('catalog.default-variant')\n            : variant.options.map(o => o.name).join(' ');\n    }\n\n    addOptionGroup() {\n        this.optionGroups.push({\n            isNew: true,\n            locked: false,\n            name: '',\n            values: [],\n        });\n        this.optionsChanged = true;\n    }\n\n    removeOptionGroup(optionGroup: OptionGroupUiModel) {\n        const id = optionGroup.id;\n        if (optionGroup.isNew) {\n            this.optionGroups = this.optionGroups.filter(og => og !== optionGroup);\n            this.generateVariants();\n            this.optionsChanged = true;\n        } else if (id) {\n            this.modalService\n                .dialog({\n                    title: _('catalog.confirm-delete-product-option-group'),\n                    translationVars: { name: optionGroup.name },\n                    buttons: [\n                        { type: 'secondary', label: _('common.cancel') },\n                        { type: 'danger', label: _('common.delete'), returnValue: true },\n                    ],\n                })\n                .pipe(\n                    switchMap(val => {\n                        if (val) {\n                            return this.dataService.product.removeOptionGroupFromProduct({\n                                optionGroupId: id,\n                                productId: this.product.id,\n                            });\n                        } else {\n                            return EMPTY;\n                        }\n                    }),\n                )\n                .subscribe(({ removeOptionGroupFromProduct }) => {\n                    if (removeOptionGroupFromProduct.__typename === 'Product') {\n                        this.notificationService.success(_('common.notify-delete-success'), {\n                            entity: 'ProductOptionGroup',\n                        });\n                        this.initOptionsAndVariants();\n                        this.optionsChanged = true;\n                    } else if (removeOptionGroupFromProduct.__typename === 'ProductOptionInUseError') {\n                        this.notificationService.error(removeOptionGroupFromProduct.message ?? '');\n                    }\n                });\n        }\n    }\n\n    addOption(index: number, optionName: string) {\n        const group = this.optionGroups[index];\n        if (group) {\n            group.values.push({ name: optionName, locked: false });\n            this.generateVariants();\n            this.optionsChanged = true;\n        }\n    }\n\n    removeOption(index: number, { id, name }: { id?: string; name: string }) {\n        const optionGroup = this.optionGroups[index];\n        if (optionGroup) {\n            if (!id) {\n                optionGroup.values = optionGroup.values.filter(v => v.name !== name);\n                this.generateVariants();\n            } else {\n                this.modalService\n                    .dialog({\n                        title: _('catalog.confirm-delete-product-option'),\n                        translationVars: { name },\n                        buttons: [\n                            { type: 'secondary', label: _('common.cancel') },\n                            { type: 'danger', label: _('common.delete'), returnValue: true },\n                        ],\n                    })\n                    .pipe(\n                        switchMap(val => {\n                            if (val) {\n                                return this.dataService.product.deleteProductOption(id);\n                            } else {\n                                return EMPTY;\n                            }\n                        }),\n                    )\n                    .subscribe(({ deleteProductOption }) => {\n                        if (deleteProductOption.result === DeletionResult.DELETED) {\n                            this.notificationService.success(_('common.notify-delete-success'), {\n                                entity: 'ProductOption',\n                            });\n                            optionGroup.values = optionGroup.values.filter(v => v.id !== id);\n                            this.generateVariants();\n                            this.optionsChanged = true;\n                        } else {\n                            this.notificationService.error(deleteProductOption.message ?? '');\n                        }\n                    });\n            }\n        }\n    }\n\n    generateVariants() {\n        const groups = this.optionGroups.map(g => g.values);\n        const previousVariants = this.generatedVariants;\n        const generatedVariantFactory = (\n            isDefault: boolean,\n            options: GeneratedVariant['options'],\n            existingVariant?: GetProductVariantOptions.Variants,\n            prototypeVariant?: GetProductVariantOptions.Variants,\n        ): GeneratedVariant => {\n            const prototype = this.getVariantPrototype(options, previousVariants);\n            return new GeneratedVariant({\n                enabled: true,\n                existing: !!existingVariant,\n                productVariantId: existingVariant?.id,\n                isDefault,\n                options,\n                price: existingVariant?.price ?? prototypeVariant?.price ?? prototype.price,\n                sku: existingVariant?.sku ?? prototypeVariant?.sku ?? prototype.sku,\n                stock: existingVariant?.stockOnHand ?? prototypeVariant?.stockOnHand ?? prototype.stock,\n            });\n        };\n        this.generatedVariants = groups.length\n            ? generateAllCombinations(groups).map(options => {\n                  const existingVariant = this.product.variants.find(v =>\n                      this.optionsAreEqual(v.options, options),\n                  );\n                  const prototypeVariant = this.product.variants.find(v =>\n                      this.optionsAreSubset(v.options, options),\n                  );\n                  return generatedVariantFactory(false, options, existingVariant, prototypeVariant);\n              })\n            : [generatedVariantFactory(true, [], this.product.variants[0])];\n    }\n\n    /**\n     * Returns one of the existing variants to base the newly-generated variant's\n     * details off.\n     */\n    private getVariantPrototype(\n        options: GeneratedVariant['options'],\n        previousVariants: GeneratedVariant[],\n    ): Pick<GeneratedVariant, 'sku' | 'price' | 'stock'> {\n        const variantsWithSimilarOptions = previousVariants.filter(v =>\n            options.map(o => o.name).filter(name => v.options.map(o => o.name).includes(name)),\n        );\n        if (variantsWithSimilarOptions.length) {\n            return pick(previousVariants[0], ['sku', 'price', 'stock']);\n        }\n        return {\n            sku: '',\n            price: 0,\n            stock: 0,\n        };\n    }\n\n    deleteVariant(id: string, options: GeneratedVariant['options']) {\n        this.modalService\n            .dialog({\n                title: _('catalog.confirm-delete-product-variant'),\n                translationVars: { name: options.map(o => o.name).join(' ') },\n                buttons: [\n                    { type: 'secondary', label: _('common.cancel') },\n                    { type: 'danger', label: _('common.delete'), returnValue: true },\n                ],\n            })\n            .pipe(\n                switchMap(response =>\n                    response ? this.productDetailService.deleteProductVariant(id, this.product.id) : EMPTY,\n                ),\n                switchMap(() => this.reFetchProduct(null)),\n            )\n            .subscribe(\n                () => {\n                    this.notificationService.success(_('common.notify-delete-success'), {\n                        entity: 'ProductVariant',\n                    });\n                    this.initOptionsAndVariants();\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-delete-error'), {\n                        entity: 'ProductVariant',\n                    });\n                },\n            );\n    }\n\n    save() {\n        this.optionGroups = this.optionGroups.filter(g => g.values.length);\n        const newOptionGroups = this.optionGroups\n            .filter(og => og.isNew)\n            .map(og => ({\n                name: og.name,\n                values: [],\n            }));\n\n        this.checkUniqueSkus()\n            .pipe(\n                mergeMap(() => this.confirmDeletionOfObsoleteVariants()),\n                mergeMap(() =>\n                    this.productDetailService.createProductOptionGroups(newOptionGroups, this.languageCode),\n                ),\n                mergeMap(createdOptionGroups => this.addOptionGroupsToProduct(createdOptionGroups)),\n                mergeMap(createdOptionGroups => this.addNewOptionsToGroups(createdOptionGroups)),\n                mergeMap(groupsIds => this.fetchOptionGroups(groupsIds)),\n                mergeMap(groups => this.createNewProductVariants(groups)),\n                mergeMap(res => this.deleteObsoleteVariants(res.createProductVariants)),\n                mergeMap(variants => this.reFetchProduct(variants)),\n            )\n            .subscribe({\n                next: variants => {\n                    this.formValueChanged = false;\n                    this.notificationService.success(_('catalog.created-new-variants-success'), {\n                        count: variants.length,\n                    });\n                    this.initOptionsAndVariants();\n                    this.optionsChanged = false;\n                },\n            });\n    }\n\n    private checkUniqueSkus() {\n        const withDuplicateSkus = this.generatedVariants.filter((variant, index) => {\n            return (\n                variant.enabled &&\n                this.generatedVariants.find(gv => gv.sku.trim() === variant.sku.trim() && gv !== variant)\n            );\n        });\n        if (withDuplicateSkus.length) {\n            return this.modalService\n                .dialog({\n                    title: _('catalog.duplicate-sku-warning'),\n                    body: unique(withDuplicateSkus.map(v => `${v.sku}`)).join(', '),\n                    buttons: [{ label: _('common.close'), returnValue: false, type: 'primary' }],\n                })\n                .pipe(mergeMap(res => EMPTY));\n        } else {\n            return of(true);\n        }\n    }\n\n    private confirmDeletionOfObsoleteVariants(): Observable<boolean> {\n        const obsoleteVariants = this.getObsoleteVariants();\n        if (obsoleteVariants.length) {\n            return this.modalService\n                .fromComponent(ConfirmVariantDeletionDialogComponent, {\n                    locals: {\n                        variants: obsoleteVariants,\n                    },\n                })\n                .pipe(\n                    mergeMap(res => {\n                        return res === true ? of(true) : EMPTY;\n                    }),\n                );\n        } else {\n            return of(true);\n        }\n    }\n\n    private getObsoleteVariants() {\n        return this.product.variants.filter(\n            variant => !this.generatedVariants.find(gv => gv.productVariantId === variant.id),\n        );\n    }\n\n    private hasOnlyDefaultVariant(product: GetProductVariantOptions.Product): boolean {\n        return product.variants.length === 1 && product.optionGroups.length === 0;\n    }\n\n    private addOptionGroupsToProduct(\n        createdOptionGroups: CreateProductOptionGroup.CreateProductOptionGroup[],\n    ): Observable<CreateProductOptionGroup.CreateProductOptionGroup[]> {\n        if (createdOptionGroups.length) {\n            return forkJoin(\n                createdOptionGroups.map(optionGroup => {\n                    return this.dataService.product.addOptionGroupToProduct({\n                        productId: this.product.id,\n                        optionGroupId: optionGroup.id,\n                    });\n                }),\n            ).pipe(map(() => createdOptionGroups));\n        } else {\n            return of([]);\n        }\n    }\n\n    private addNewOptionsToGroups(\n        createdOptionGroups: CreateProductOptionGroup.CreateProductOptionGroup[],\n    ): Observable<string[]> {\n        const newOptions: CreateProductOptionInput[] = this.optionGroups\n            .map(og => {\n                const createdGroup = createdOptionGroups.find(cog => cog.name === og.name);\n                const productOptionGroupId = createdGroup ? createdGroup.id : og.id;\n                if (!productOptionGroupId) {\n                    throw new Error('Could not get a productOptionGroupId');\n                }\n                return og.values\n                    .filter(v => !v.locked)\n                    .map(v => ({\n                        productOptionGroupId,\n                        code: normalizeString(v.name, '-'),\n                        translations: [{ name: v.name, languageCode: this.languageCode }],\n                    }));\n            })\n            .reduce((flat, options) => [...flat, ...options], []);\n\n        const allGroupIds = [\n            ...createdOptionGroups.map(g => g.id),\n            ...this.optionGroups.map(g => g.id).filter(notNullOrUndefined),\n        ];\n\n        if (newOptions.length) {\n            return forkJoin(newOptions.map(input => this.dataService.product.addOptionToGroup(input))).pipe(\n                map(() => allGroupIds),\n            );\n        } else {\n            return of(allGroupIds);\n        }\n    }\n\n    private fetchOptionGroups(groupsIds: string[]): Observable<ProductOptionGroupWithOptionsFragment[]> {\n        return forkJoin(\n            groupsIds.map(id =>\n                this.dataService.product\n                    .getProductOptionGroup(id)\n                    .mapSingle(data => data.productOptionGroup)\n                    .pipe(filter(notNullOrUndefined)),\n            ),\n        ).pipe(defaultIfEmpty([] as ProductOptionGroupWithOptionsFragment[]));\n    }\n\n    private createNewProductVariants(groups: ProductOptionGroupWithOptionsFragment[]) {\n        const options = groups\n            .filter(notNullOrUndefined)\n            .map(og => og.options)\n            .reduce((flat, o) => [...flat, ...o], []);\n        const variants = this.generatedVariants\n            .filter(v => v.enabled && !v.existing)\n            .map(v => {\n                const optionIds = groups.map((group, index) => {\n                    const option = group.options.find(o => o.name === v.options[index].name);\n                    if (option) {\n                        return option.id;\n                    } else {\n                        throw new Error(`Could not find a matching option for group ${group.name}`);\n                    }\n                });\n                return {\n                    price: v.price,\n                    sku: v.sku,\n                    stock: v.stock,\n                    optionIds,\n                };\n            });\n        return this.productDetailService.createProductVariants(\n            this.product,\n            variants,\n            options,\n            this.languageCode,\n        );\n    }\n\n    private deleteObsoleteVariants<T>(input: T): Observable<T> {\n        const obsoleteVariants = this.getObsoleteVariants();\n        if (obsoleteVariants.length) {\n            const deleteOperations = obsoleteVariants.map(v =>\n                this.dataService.product.deleteProductVariant(v.id).pipe(map(() => input)),\n            );\n            return forkJoin(...deleteOperations);\n        } else {\n            return of(input);\n        }\n    }\n\n    private reFetchProduct<T>(input: T): Observable<T> {\n        // Re-fetch the Product to force an update to the view.\n        const id = this.route.snapshot.paramMap.get('id');\n        if (id) {\n            return this.dataService.product.getProduct(id).single$.pipe(map(() => input));\n        } else {\n            return of(input);\n        }\n    }\n\n    initOptionsAndVariants() {\n        this.dataService.product\n            // tslint:disable-next-line:no-non-null-assertion\n            .getProductVariantsOptions(this.route.snapshot.paramMap.get('id')!)\n            // tslint:disable-next-line:no-non-null-assertion\n            .mapSingle(({ product }) => product!)\n            .subscribe(p => {\n                this.product = p;\n                const allUsedOptionIds = p.variants.map(v => v.options.map(option => option.id)).flat();\n                const allUsedOptionGroupIds = p.variants\n                    .map(v => v.options.map(option => option.groupId))\n                    .flat();\n                this.optionGroups = p.optionGroups.map(og => {\n                    return {\n                        id: og.id,\n                        isNew: false,\n                        name: og.name,\n                        locked: allUsedOptionGroupIds.includes(og.id),\n                        values: og.options.map(o => ({\n                            id: o.id,\n                            name: o.name,\n                            locked: allUsedOptionIds.includes(o.id),\n                        })),\n                    };\n                });\n                this.generateVariants();\n            });\n    }\n\n    private optionsAreEqual(a: Array<{ name: string }>, b: Array<{ name: string }>): boolean {\n        return this.toOptionString(a) === this.toOptionString(b);\n    }\n\n    private optionsAreSubset(a: Array<{ name: string }>, b: Array<{ name: string }>): boolean {\n        return this.toOptionString(b).includes(this.toOptionString(a));\n    }\n\n    private toOptionString(o: Array<{ name: string }>): string {\n        return o\n            .map(x => x.name)\n            .sort()\n            .join('|');\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { Asset, AssetType, BaseEntityResolver } from '@vendure/admin-ui/core';\nimport { DataService } from '@vendure/admin-ui/core';\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class AssetResolver extends BaseEntityResolver<Asset.Fragment> {\n    constructor(router: Router, dataService: DataService) {\n        super(\n            router,\n            {\n                __typename: 'Asset' as const,\n                id: '',\n                createdAt: '',\n                updatedAt: '',\n                name: '',\n                type: AssetType.IMAGE,\n                fileSize: 0,\n                mimeType: '',\n                width: 0,\n                height: 0,\n                source: '',\n                preview: '',\n                focalPoint: null,\n            },\n            id => dataService.product.getAsset(id).mapStream(data => data.asset),\n        );\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { BaseEntityResolver, Collection, DataService, getDefaultUiLanguage } from '@vendure/admin-ui/core';\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class CollectionResolver extends BaseEntityResolver<Collection.Fragment> {\n    constructor(router: Router, dataService: DataService) {\n        super(\n            router,\n            {\n                __typename: 'Collection' as 'Collection',\n                id: '',\n                createdAt: '',\n                updatedAt: '',\n                languageCode: getDefaultUiLanguage(),\n                name: '',\n                slug: '',\n                isPrivate: false,\n                breadcrumbs: [],\n                description: '',\n                featuredAsset: null,\n                assets: [],\n                translations: [],\n                filters: [],\n                parent: {} as any,\n                children: null,\n            },\n            id => dataService.collection.getCollection(id).mapStream(data => data.collection),\n        );\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { BaseEntityResolver } from '@vendure/admin-ui/core';\nimport { FacetWithValues } from '@vendure/admin-ui/core';\nimport { getDefaultUiLanguage } from '@vendure/admin-ui/core';\nimport { DataService } from '@vendure/admin-ui/core';\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class FacetResolver extends BaseEntityResolver<FacetWithValues.Fragment> {\n    constructor(router: Router, dataService: DataService) {\n        super(\n            router,\n            {\n                __typename: 'Facet' as 'Facet',\n                id: '',\n                createdAt: '',\n                updatedAt: '',\n                isPrivate: false,\n                languageCode: getDefaultUiLanguage(),\n                name: '',\n                code: '',\n                translations: [],\n                values: [],\n            },\n            (id) => dataService.facet.getFacet(id).mapStream((data) => data.facet),\n        );\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport {\n    BaseEntityResolver,\n    DataService,\n    getDefaultUiLanguage,\n    GetProductWithVariants,\n} from '@vendure/admin-ui/core';\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class ProductResolver extends BaseEntityResolver<GetProductWithVariants.Product> {\n    constructor(dataService: DataService, router: Router) {\n        super(\n            router,\n            {\n                __typename: 'Product' as 'Product',\n                id: '',\n                createdAt: '',\n                updatedAt: '',\n                enabled: true,\n                languageCode: getDefaultUiLanguage(),\n                name: '',\n                slug: '',\n                featuredAsset: null,\n                assets: [],\n                description: '',\n                translations: [],\n                optionGroups: [],\n                facetValues: [],\n                variantList: { items: [], totalItems: 0 },\n                channels: [],\n            },\n            id =>\n                dataService.product\n                    .getProduct(id, { take: 10 })\n                    .refetchOnChannelChange()\n                    .mapStream(data => data.product),\n        );\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { BaseEntityResolver } from '@vendure/admin-ui/core';\nimport { GetProductVariantOptions } from '@vendure/admin-ui/core';\nimport { DataService } from '@vendure/admin-ui/core';\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class ProductVariantsResolver extends BaseEntityResolver<GetProductVariantOptions.Product> {\n    constructor(router: Router, dataService: DataService) {\n        super(\n            router,\n            {\n                __typename: 'Product' as 'Product',\n                id: '',\n                createdAt: '',\n                updatedAt: '',\n                name: '',\n                optionGroups: [],\n                variants: [],\n            },\n            id => dataService.product.getProductVariantsOptions(id).mapStream(data => data.product),\n        );\n    }\n}\n","import { Route } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport {\n    Asset,\n    CanDeactivateDetailGuard,\n    Collection,\n    createResolveData,\n    detailBreadcrumb,\n    FacetWithValues,\n    GetProductWithVariants,\n} from '@vendure/admin-ui/core';\nimport { map } from 'rxjs/operators';\n\nimport { AssetDetailComponent } from './components/asset-detail/asset-detail.component';\nimport { AssetListComponent } from './components/asset-list/asset-list.component';\nimport { CollectionDetailComponent } from './components/collection-detail/collection-detail.component';\nimport { CollectionListComponent } from './components/collection-list/collection-list.component';\nimport { FacetDetailComponent } from './components/facet-detail/facet-detail.component';\nimport { FacetListComponent } from './components/facet-list/facet-list.component';\nimport { ProductDetailComponent } from './components/product-detail/product-detail.component';\nimport { ProductListComponent } from './components/product-list/product-list.component';\nimport { ProductOptionsEditorComponent } from './components/product-options-editor/product-options-editor.component';\nimport { ProductVariantsEditorComponent } from './components/product-variants-editor/product-variants-editor.component';\nimport { AssetResolver } from './providers/routing/asset-resolver';\nimport { CollectionResolver } from './providers/routing/collection-resolver';\nimport { FacetResolver } from './providers/routing/facet-resolver';\nimport { ProductResolver } from './providers/routing/product-resolver';\nimport { ProductVariantsResolver } from './providers/routing/product-variants-resolver';\n\nexport const catalogRoutes: Route[] = [\n    {\n        path: 'products',\n        component: ProductListComponent,\n        data: {\n            breadcrumb: _('breadcrumb.products'),\n        },\n    },\n    {\n        path: 'products/:id',\n        component: ProductDetailComponent,\n        resolve: createResolveData(ProductResolver),\n        canDeactivate: [CanDeactivateDetailGuard],\n        data: {\n            breadcrumb: productBreadcrumb,\n        },\n    },\n    {\n        path: 'products/:id/manage-variants',\n        component: ProductVariantsEditorComponent,\n        resolve: createResolveData(ProductVariantsResolver),\n        canDeactivate: [CanDeactivateDetailGuard],\n        data: {\n            breadcrumb: productVariantEditorBreadcrumb,\n        },\n    },\n    {\n        path: 'products/:id/options',\n        component: ProductOptionsEditorComponent,\n        resolve: createResolveData(ProductVariantsResolver),\n        canDeactivate: [CanDeactivateDetailGuard],\n        data: {\n            breadcrumb: productOptionsEditorBreadcrumb,\n        },\n    },\n    {\n        path: 'facets',\n        component: FacetListComponent,\n        data: {\n            breadcrumb: _('breadcrumb.facets'),\n        },\n    },\n    {\n        path: 'facets/:id',\n        component: FacetDetailComponent,\n        resolve: createResolveData(FacetResolver),\n        canDeactivate: [CanDeactivateDetailGuard],\n        data: {\n            breadcrumb: facetBreadcrumb,\n        },\n    },\n    {\n        path: 'collections',\n        component: CollectionListComponent,\n        data: {\n            breadcrumb: _('breadcrumb.collections'),\n        },\n    },\n    {\n        path: 'collections/:id',\n        component: CollectionDetailComponent,\n        resolve: createResolveData(CollectionResolver),\n        canDeactivate: [CanDeactivateDetailGuard],\n        data: {\n            breadcrumb: collectionBreadcrumb,\n        },\n    },\n    {\n        path: 'assets',\n        component: AssetListComponent,\n        data: {\n            breadcrumb: _('breadcrumb.assets'),\n        },\n    },\n    {\n        path: 'assets/:id',\n        component: AssetDetailComponent,\n        resolve: createResolveData(AssetResolver),\n        data: {\n            breadcrumb: assetBreadcrumb,\n        },\n    },\n];\n\nexport function productBreadcrumb(data: any, params: any) {\n    return detailBreadcrumb<GetProductWithVariants.Product>({\n        entity: data.entity,\n        id: params.id,\n        breadcrumbKey: 'breadcrumb.products',\n        getName: product => product.name,\n        route: 'products',\n    });\n}\n\nexport function productVariantEditorBreadcrumb(data: any, params: any) {\n    return data.entity.pipe(\n        map((entity: any) => {\n            return [\n                {\n                    label: _('breadcrumb.products'),\n                    link: ['../', 'products'],\n                },\n                {\n                    label: `${entity.name}`,\n                    link: ['../', 'products', params.id, { tab: 'variants' }],\n                },\n                {\n                    label: _('breadcrumb.manage-variants'),\n                    link: ['manage-variants'],\n                },\n            ];\n        }),\n    );\n}\n\nexport function productOptionsEditorBreadcrumb(data: any, params: any) {\n    return data.entity.pipe(\n        map((entity: any) => {\n            return [\n                {\n                    label: _('breadcrumb.products'),\n                    link: ['../', 'products'],\n                },\n                {\n                    label: `${entity.name}`,\n                    link: ['../', 'products', params.id, { tab: 'variants' }],\n                },\n                {\n                    label: _('breadcrumb.product-options'),\n                    link: ['options'],\n                },\n            ];\n        }),\n    );\n}\n\nexport function facetBreadcrumb(data: any, params: any) {\n    return detailBreadcrumb<FacetWithValues.Fragment>({\n        entity: data.entity,\n        id: params.id,\n        breadcrumbKey: 'breadcrumb.facets',\n        getName: facet => facet.name,\n        route: 'facets',\n    });\n}\n\nexport function collectionBreadcrumb(data: any, params: any) {\n    return detailBreadcrumb<Collection.Fragment>({\n        entity: data.entity,\n        id: params.id,\n        breadcrumbKey: 'breadcrumb.collections',\n        getName: collection => collection.name,\n        route: 'collections',\n    });\n}\n\nexport function assetBreadcrumb(data: any, params: any) {\n    return detailBreadcrumb<Asset.Fragment>({\n        entity: data.entity,\n        id: params.id,\n        breadcrumbKey: 'breadcrumb.assets',\n        getName: asset => asset.name,\n        route: 'assets',\n    });\n}\n","import { CdkDragDrop, moveItemInArray } from '@angular/cdk/drag-drop';\nimport {\n    ChangeDetectionStrategy,\n    ChangeDetectorRef,\n    Component,\n    EventEmitter,\n    HostBinding,\n    Input,\n    Output,\n} from '@angular/core';\nimport {\n    Asset,\n    AssetPickerDialogComponent,\n    AssetPreviewDialogComponent,\n    ModalService,\n    Permission,\n} from '@vendure/admin-ui/core';\nimport { unique } from '@vendure/common/lib/unique';\n\nexport interface AssetChange {\n    assets: Asset[];\n    featuredAsset: Asset | undefined;\n}\n\n/**\n * A component which displays the Assets, and allows assets to be removed and\n * added, and for the featured asset to be set.\n *\n * Note: rather complex code for drag drop is due to a limitation of the default CDK implementation\n * which is addressed by a work-around from here: https://github.com/angular/components/issues/13372#issuecomment-483998378\n */\n@Component({\n    selector: 'vdr-assets',\n    templateUrl: './assets.component.html',\n    styleUrls: ['./assets.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class AssetsComponent {\n    @Input('assets') set assetsSetter(val: Asset[]) {\n        // create a new non-readonly array of assets\n        this.assets = (val || []).slice();\n    }\n\n    @Input() featuredAsset: Asset | undefined;\n    @HostBinding('class.compact')\n    @Input()\n    compact = false;\n    @Output() change = new EventEmitter<AssetChange>();\n\n    public assets: Asset[] = [];\n\n    @Input()\n    updatePermissions: string | string[] | Permission | Permission[];\n\n    constructor(private modalService: ModalService, private changeDetector: ChangeDetectorRef) {}\n\n    selectAssets() {\n        this.modalService\n            .fromComponent(AssetPickerDialogComponent, {\n                size: 'xl',\n            })\n            .subscribe(result => {\n                if (result && result.length) {\n                    this.assets = unique(this.assets.concat(result), 'id');\n                    if (!this.featuredAsset) {\n                        this.featuredAsset = result[0];\n                    }\n                    this.emitChangeEvent(this.assets, this.featuredAsset);\n                    this.changeDetector.markForCheck();\n                }\n            });\n    }\n\n    setAsFeatured(asset: Asset) {\n        this.featuredAsset = asset;\n        this.emitChangeEvent(this.assets, asset);\n    }\n\n    isFeatured(asset: Asset): boolean {\n        return !!this.featuredAsset && this.featuredAsset.id === asset.id;\n    }\n\n    previewAsset(asset: Asset) {\n        this.modalService\n            .fromComponent(AssetPreviewDialogComponent, {\n                size: 'xl',\n                closable: true,\n                locals: { asset },\n            })\n            .subscribe();\n    }\n\n    removeAsset(asset: Asset) {\n        this.assets = this.assets.filter(a => a.id !== asset.id);\n        if (this.featuredAsset && this.featuredAsset.id === asset.id) {\n            this.featuredAsset = this.assets.length > 0 ? this.assets[0] : undefined;\n        }\n        this.emitChangeEvent(this.assets, this.featuredAsset);\n    }\n\n    private emitChangeEvent(assets: Asset[], featuredAsset: Asset | undefined) {\n        this.change.emit({\n            assets,\n            featuredAsset,\n        });\n    }\n\n    dropListDropped(event: CdkDragDrop<number>) {\n        moveItemInArray(this.assets, event.previousContainer.data, event.container.data);\n        this.emitChangeEvent(this.assets, this.featuredAsset);\n    }\n}\n","import { ChangeDetectionStrategy, Component, OnInit } from '@angular/core';\nimport { FormControl } from '@angular/forms';\nimport { DataService, Dialog, GetChannels, NotificationService } from '@vendure/admin-ui/core';\nimport { combineLatest } from 'rxjs';\n\n@Component({\n    selector: 'vdr-assign-to-channel-dialog',\n    templateUrl: './assign-to-channel-dialog.component.html',\n    styleUrls: ['./assign-to-channel-dialog.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class AssignToChannelDialogComponent implements OnInit, Dialog<GetChannels.Channels> {\n    selectedChannel: GetChannels.Channels | null | undefined;\n    currentChannel: GetChannels.Channels;\n    availableChannels: GetChannels.Channels[];\n    resolveWith: (result?: GetChannels.Channels) => void;\n    selectedChannelIdControl = new FormControl();\n\n    // assigned by ModalService.fromComponent() call\n\n    constructor(private dataService: DataService, private notificationService: NotificationService) {}\n\n    ngOnInit() {\n        const activeChannelId$ = this.dataService.client\n            .userStatus()\n            .mapSingle(({ userStatus }) => userStatus.activeChannelId);\n        const allChannels$ = this.dataService.settings.getChannels().mapSingle(data => data.channels);\n\n        combineLatest(activeChannelId$, allChannels$).subscribe(([activeChannelId, channels]) => {\n            // tslint:disable-next-line:no-non-null-assertion\n            this.currentChannel = channels.find(c => c.id === activeChannelId)!;\n            this.availableChannels = channels;\n        });\n\n        this.selectedChannelIdControl.valueChanges.subscribe(ids => {\n            this.selectChannel(ids);\n        });\n    }\n\n    selectChannel(channelIds: string[]) {\n        this.selectedChannel = this.availableChannels.find(c => c.id === channelIds[0]);\n    }\n\n    assign() {\n        const selectedChannel = this.selectedChannel;\n        if (selectedChannel) {\n            this.resolveWith(selectedChannel);\n        }\n    }\n\n    cancel() {\n        this.resolveWith();\n    }\n}\n","import { gql } from 'apollo-angular';\n\nexport const GET_PRODUCTS_WITH_FACET_VALUES_BY_IDS = gql`\n    query GetProductsWithFacetValuesByIds($ids: [String!]!) {\n        products(options: { filter: { id: { in: $ids } } }) {\n            items {\n                id\n                name\n                facetValues {\n                    id\n                    name\n                    code\n                    facet {\n                        id\n                        name\n                        code\n                    }\n                }\n            }\n        }\n    }\n`;\n\nexport const GET_VARIANTS_WITH_FACET_VALUES_BY_IDS = gql`\n    query GetVariantsWithFacetValuesByIds($ids: [String!]!) {\n        productVariants(options: { filter: { id: { in: $ids } } }) {\n            items {\n                id\n                name\n                sku\n                facetValues {\n                    id\n                    name\n                    code\n                    facet {\n                        id\n                        name\n                        code\n                    }\n                }\n            }\n        }\n    }\n`;\n\nexport const UPDATE_PRODUCTS_BULK = gql`\n    mutation UpdateProductsBulk($input: [UpdateProductInput!]!) {\n        updateProducts(input: $input) {\n            id\n            name\n            facetValues {\n                id\n                name\n                code\n            }\n        }\n    }\n`;\n\nexport const UPDATE_VARIANTS_BULK = gql`\n    mutation UpdateVariantsBulk($input: [UpdateProductVariantInput!]!) {\n        updateProductVariants(input: $input) {\n            id\n            name\n            facetValues {\n                id\n                name\n                code\n            }\n        }\n    }\n`;\n","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, OnDestroy, OnInit } from '@angular/core';\nimport {\n    DataService,\n    Dialog,\n    FacetWithValuesFragment,\n    GetProductsWithFacetValuesByIdsQuery,\n    GetProductsWithFacetValuesByIdsQueryVariables,\n    GetVariantsWithFacetValuesByIdsQuery,\n    UpdateProductsBulkMutation,\n    UpdateProductsBulkMutationVariables,\n    UpdateVariantsBulkMutation,\n    UpdateVariantsBulkMutationVariables,\n} from '@vendure/admin-ui/core';\nimport { unique } from '@vendure/common/lib/unique';\nimport { Observable, Subscription } from 'rxjs';\nimport { shareReplay, switchMap } from 'rxjs/operators';\n\nimport {\n    GET_PRODUCTS_WITH_FACET_VALUES_BY_IDS,\n    GET_VARIANTS_WITH_FACET_VALUES_BY_IDS,\n    UPDATE_PRODUCTS_BULK,\n    UPDATE_VARIANTS_BULK,\n} from './bulk-add-facet-values-dialog.graphql';\n\ninterface ProductOrVariant {\n    id: string;\n    name: string;\n    sku?: string;\n    facetValues: Array<{\n        id: string;\n        name: string;\n        code: string;\n        facet: Array<{\n            id: string;\n            name: string;\n            code: string;\n        }>;\n    }>;\n}\n\n@Component({\n    selector: 'vdr-bulk-add-facet-values-dialog',\n    templateUrl: './bulk-add-facet-values-dialog.component.html',\n    styleUrls: ['./bulk-add-facet-values-dialog.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class BulkAddFacetValuesDialogComponent\n    implements OnInit, OnDestroy, Dialog<FacetWithValuesFragment[]>\n{\n    resolveWith: (result?: FacetWithValuesFragment[]) => void;\n    /* provided by call to ModalService */\n    mode: 'product' | 'variant' = 'product';\n    ids?: string[];\n    facets: FacetWithValuesFragment[] = [];\n    state: 'loading' | 'ready' | 'saving' = 'loading';\n\n    selectedValues: FacetWithValuesFragment[] = [];\n    items: ProductOrVariant[] = [];\n    facetValuesRemoved = false;\n    private subscription: Subscription;\n    constructor(private dataService: DataService, private changeDetectorRef: ChangeDetectorRef) {}\n\n    ngOnInit(): void {\n        const fetchData$: Observable<any> =\n            this.mode === 'product'\n                ? this.dataService\n                      .query<\n                          GetProductsWithFacetValuesByIdsQuery,\n                          GetProductsWithFacetValuesByIdsQueryVariables\n                      >(GET_PRODUCTS_WITH_FACET_VALUES_BY_IDS, {\n                          ids: this.ids ?? [],\n                      })\n                      .mapSingle(({ products }) =>\n                          products.items.map(p => ({ ...p, facetValues: [...p.facetValues] })),\n                      )\n                : this.dataService\n                      .query<\n                          GetVariantsWithFacetValuesByIdsQuery,\n                          GetProductsWithFacetValuesByIdsQueryVariables\n                      >(GET_VARIANTS_WITH_FACET_VALUES_BY_IDS, {\n                          ids: this.ids ?? [],\n                      })\n                      .mapSingle(({ productVariants }) =>\n                          productVariants.items.map(p => ({ ...p, facetValues: [...p.facetValues] })),\n                      );\n        this.subscription = fetchData$.subscribe({\n            next: items => {\n                this.items = items;\n                this.state = 'ready';\n                this.changeDetectorRef.markForCheck();\n            },\n        });\n    }\n\n    ngOnDestroy() {\n        this.subscription?.unsubscribe();\n    }\n\n    cancel() {\n        this.resolveWith();\n    }\n\n    removeFacetValue(item: ProductOrVariant, facetValueId: string) {\n        item.facetValues = item.facetValues.filter(fv => fv.id !== facetValueId);\n        this.facetValuesRemoved = true;\n    }\n\n    addFacetValues() {\n        const selectedFacetValueIds = this.selectedValues.map(sv => sv.id);\n        this.state = 'saving';\n        const save$: Observable<any> =\n            this.mode === 'product'\n                ? this.dataService.mutate<UpdateProductsBulkMutation, UpdateProductsBulkMutationVariables>(\n                      UPDATE_PRODUCTS_BULK,\n                      {\n                          input: this.items?.map(product => ({\n                              id: product.id,\n                              facetValueIds: unique([\n                                  ...product.facetValues.map(fv => fv.id),\n                                  ...selectedFacetValueIds,\n                              ]),\n                          })),\n                      },\n                  )\n                : this.dataService.mutate<UpdateVariantsBulkMutation, UpdateVariantsBulkMutationVariables>(\n                      UPDATE_VARIANTS_BULK,\n                      {\n                          input: this.items?.map(product => ({\n                              id: product.id,\n                              facetValueIds: unique([\n                                  ...product.facetValues.map(fv => fv.id),\n                                  ...selectedFacetValueIds,\n                              ]),\n                          })),\n                      },\n                  );\n        return save$.subscribe(result => {\n            this.resolveWith(this.selectedValues);\n        });\n    }\n}\n","import {\n    ChangeDetectionStrategy,\n    Component,\n    ContentChild,\n    Input,\n    OnChanges,\n    OnDestroy,\n    OnInit,\n    SimpleChanges,\n    TemplateRef,\n} from '@angular/core';\nimport { FormControl } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport {\n    CollectionFilterParameter,\n    ConfigurableOperationInput,\n    DataService,\n    GetCollectionContents,\n} from '@vendure/admin-ui/core';\nimport { BehaviorSubject, combineLatest, Observable, of, Subject } from 'rxjs';\nimport {\n    catchError,\n    debounceTime,\n    distinctUntilChanged,\n    filter,\n    finalize,\n    map,\n    startWith,\n    switchMap,\n    takeUntil,\n    tap,\n} from 'rxjs/operators';\n\n@Component({\n    selector: 'vdr-collection-contents',\n    templateUrl: './collection-contents.component.html',\n    styleUrls: ['./collection-contents.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class CollectionContentsComponent implements OnInit, OnChanges, OnDestroy {\n    @Input() collectionId: string;\n    @Input() parentId: string;\n    @Input() updatedFilters: ConfigurableOperationInput[] | undefined;\n    @Input() previewUpdatedFilters = false;\n    @ContentChild(TemplateRef, { static: true }) headerTemplate: TemplateRef<any>;\n\n    contents$: Observable<GetCollectionContents.Items[]>;\n    contentsTotalItems$: Observable<number>;\n    contentsItemsPerPage$: Observable<number>;\n    contentsCurrentPage$: Observable<number>;\n    filterTermControl = new FormControl('');\n    isLoading = false;\n    private collectionIdChange$ = new BehaviorSubject<string>('');\n    private parentIdChange$ = new BehaviorSubject<string>('');\n    private filterChanges$ = new BehaviorSubject<ConfigurableOperationInput[]>([]);\n    private refresh$ = new BehaviorSubject<boolean>(true);\n    private destroy$ = new Subject<void>();\n\n    constructor(private route: ActivatedRoute, private router: Router, private dataService: DataService) {}\n\n    ngOnInit() {\n        this.contentsCurrentPage$ = this.route.queryParamMap.pipe(\n            map(qpm => qpm.get('contentsPage')),\n            map(page => (!page ? 1 : +page)),\n            startWith(1),\n            distinctUntilChanged(),\n        );\n\n        this.contentsItemsPerPage$ = this.route.queryParamMap.pipe(\n            map(qpm => qpm.get('contentsPerPage')),\n            map(perPage => (!perPage ? 10 : +perPage)),\n            startWith(10),\n            distinctUntilChanged(),\n        );\n\n        const filterTerm$ = this.filterTermControl.valueChanges.pipe(\n            debounceTime(250),\n            tap(() => this.setContentsPageNumber(1)),\n            startWith(''),\n        );\n\n        const filterChanges$ = this.filterChanges$.asObservable().pipe(\n            filter(() => this.previewUpdatedFilters),\n            tap(() => this.setContentsPageNumber(1)),\n            startWith([]),\n        );\n\n        const fetchUpdate$ = combineLatest(\n            this.collectionIdChange$,\n            this.parentIdChange$,\n            this.contentsCurrentPage$,\n            this.contentsItemsPerPage$,\n            filterTerm$,\n            filterChanges$,\n            this.refresh$,\n        );\n\n        const collection$ = fetchUpdate$.pipe(\n            takeUntil(this.destroy$),\n            tap(() => (this.isLoading = true)),\n            debounceTime(50),\n            switchMap(([id, parentId, currentPage, itemsPerPage, filterTerm, filters]) => {\n                const take = itemsPerPage;\n                const skip = (currentPage - 1) * itemsPerPage;\n                if (filters.length && this.previewUpdatedFilters) {\n                    const filterClause = filterTerm\n                        ? ({ name: { contains: filterTerm } } as CollectionFilterParameter)\n                        : undefined;\n                    return this.dataService.collection\n                        .previewCollectionVariants(\n                            {\n                                parentId,\n                                filters,\n                            },\n                            {\n                                take,\n                                skip,\n                                filter: filterClause,\n                            },\n                        )\n                        .mapSingle(data => data.previewCollectionVariants)\n                        .pipe(catchError(() => of({ items: [], totalItems: 0 })));\n                } else if (id) {\n                    return this.dataService.collection\n                        .getCollectionContents(id, take, skip, filterTerm)\n                        .mapSingle(data => data.collection?.productVariants);\n                } else {\n                    return of(null);\n                }\n            }),\n            tap(() => (this.isLoading = false)),\n            finalize(() => (this.isLoading = false)),\n        );\n\n        this.contents$ = collection$.pipe(map(result => (result ? result.items : [])));\n        this.contentsTotalItems$ = collection$.pipe(map(result => (result ? result.totalItems : 0)));\n    }\n\n    ngOnChanges(changes: SimpleChanges): void {\n        if ('collectionId' in changes) {\n            this.collectionIdChange$.next(changes.collectionId.currentValue);\n        }\n        if ('parentId' in changes) {\n            this.parentIdChange$.next(changes.parentId.currentValue);\n        }\n        if ('updatedFilters' in changes) {\n            if (this.updatedFilters) {\n                this.filterChanges$.next(this.updatedFilters);\n            }\n        }\n    }\n\n    ngOnDestroy() {\n        this.destroy$.next();\n        this.destroy$.complete();\n    }\n\n    setContentsPageNumber(page: number) {\n        this.setParam('contentsPage', page);\n    }\n\n    setContentsItemsPerPage(perPage: number) {\n        this.setParam('contentsPerPage', perPage);\n    }\n\n    refresh() {\n        this.refresh$.next(true);\n    }\n\n    private setParam(key: string, value: any) {\n        this.router.navigate(['./'], {\n            relativeTo: this.route,\n            queryParams: {\n                [key]: value,\n            },\n            queryParamsHandling: 'merge',\n            replaceUrl: true,\n        });\n    }\n}\n","import { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport {\n    BulkAction,\n    currentChannelIsNotDefault,\n    DataService,\n    DeletionResult,\n    getChannelCodeFromUserStatus,\n    isMultiChannel,\n    ModalService,\n    NotificationService,\n    Permission,\n} from '@vendure/admin-ui/core';\nimport { unique } from '@vendure/common/lib/unique';\nimport { EMPTY, from, of } from 'rxjs';\nimport { mapTo, switchMap } from 'rxjs/operators';\n\nimport { AssignToChannelDialogComponent } from '../assign-to-channel-dialog/assign-to-channel-dialog.component';\nimport { CollectionPartial } from '../collection-tree/collection-tree.component';\n\nimport { CollectionListComponent } from './collection-list.component';\n\nexport const deleteCollectionsBulkAction: BulkAction<CollectionPartial, CollectionListComponent> = {\n    location: 'collection-list',\n    label: _('common.delete'),\n    icon: 'trash',\n    iconClass: 'is-danger',\n    requiresPermission: userPermissions =>\n        userPermissions.includes(Permission.DeleteCollection) ||\n        userPermissions.includes(Permission.DeleteCatalog),\n    onClick: ({ injector, selection, hostComponent, clearSelection }) => {\n        const modalService = injector.get(ModalService);\n        const dataService = injector.get(DataService);\n        const notificationService = injector.get(NotificationService);\n\n        modalService\n            .dialog({\n                title: _('catalog.confirm-bulk-delete-collections'),\n                translationVars: {\n                    count: selection.length,\n                },\n                buttons: [\n                    { type: 'secondary', label: _('common.cancel') },\n                    { type: 'danger', label: _('common.delete'), returnValue: true },\n                ],\n            })\n            .pipe(\n                switchMap(response =>\n                    response\n                        ? dataService.collection.deleteCollections(unique(selection.map(c => c.id)))\n                        : EMPTY,\n                ),\n            )\n            .subscribe(result => {\n                let deleted = 0;\n                const errors: string[] = [];\n                for (const item of result.deleteCollections) {\n                    if (item.result === DeletionResult.DELETED) {\n                        deleted++;\n                    } else if (item.message) {\n                        errors.push(item.message);\n                    }\n                }\n                if (0 < deleted) {\n                    notificationService.success(_('catalog.notify-bulk-delete-collections-success'), {\n                        count: deleted,\n                    });\n                }\n                if (0 < errors.length) {\n                    notificationService.error(errors.join('\\n'));\n                }\n                hostComponent.refresh();\n                clearSelection();\n            });\n    },\n};\n\nexport const assignCollectionsToChannelBulkAction: BulkAction<CollectionPartial, CollectionListComponent> = {\n    location: 'collection-list',\n    label: _('catalog.assign-to-channel'),\n    icon: 'layers',\n    requiresPermission: userPermissions =>\n        userPermissions.includes(Permission.UpdateCatalog) ||\n        userPermissions.includes(Permission.UpdateProduct),\n    isVisible: ({ injector }) => isMultiChannel(injector.get(DataService)),\n    onClick: ({ injector, selection, hostComponent, clearSelection }) => {\n        const modalService = injector.get(ModalService);\n        const dataService = injector.get(DataService);\n        const notificationService = injector.get(NotificationService);\n        modalService\n            .fromComponent(AssignToChannelDialogComponent, {\n                size: 'md',\n                locals: {},\n            })\n            .pipe(\n                switchMap(result => {\n                    if (result) {\n                        return dataService.collection\n                            .assignCollectionsToChannel({\n                                collectionIds: selection.map(c => c.id),\n                                channelId: result.id,\n                            })\n                            .pipe(mapTo(result));\n                    } else {\n                        return EMPTY;\n                    }\n                }),\n            )\n            .subscribe(result => {\n                notificationService.success(_('catalog.assign-collections-to-channel-success'), {\n                    count: selection.length,\n                    channelCode: result.code,\n                });\n                clearSelection();\n            });\n    },\n};\n\nexport const removeCollectionsFromChannelBulkAction: BulkAction<CollectionPartial, CollectionListComponent> =\n    {\n        location: 'collection-list',\n        label: _('catalog.remove-from-channel'),\n        requiresPermission: userPermissions =>\n            userPermissions.includes(Permission.UpdateChannel) ||\n            userPermissions.includes(Permission.UpdateProduct),\n        getTranslationVars: ({ injector }) => getChannelCodeFromUserStatus(injector.get(DataService)),\n        icon: 'layers',\n        iconClass: 'is-warning',\n        isVisible: ({ injector }) => currentChannelIsNotDefault(injector.get(DataService)),\n        onClick: ({ injector, selection, hostComponent, clearSelection }) => {\n            const modalService = injector.get(ModalService);\n            const dataService = injector.get(DataService);\n            const notificationService = injector.get(NotificationService);\n            const activeChannelId$ = dataService.client\n                .userStatus()\n                .mapSingle(({ userStatus }) => userStatus.activeChannelId);\n\n            from(getChannelCodeFromUserStatus(injector.get(DataService)))\n                .pipe(\n                    switchMap(({ channelCode }) =>\n                        modalService.dialog({\n                            title: _('catalog.remove-from-channel'),\n                            translationVars: {\n                                channelCode,\n                            },\n                            buttons: [\n                                { type: 'secondary', label: _('common.cancel') },\n                                {\n                                    type: 'danger',\n                                    label: _('common.remove'),\n                                    returnValue: true,\n                                },\n                            ],\n                        }),\n                    ),\n                    switchMap(res =>\n                        res\n                            ? activeChannelId$.pipe(\n                                  switchMap(activeChannelId =>\n                                      activeChannelId\n                                          ? dataService.collection.removeCollectionsFromChannel({\n                                                channelId: activeChannelId,\n                                                collectionIds: selection.map(c => c.id),\n                                            })\n                                          : EMPTY,\n                                  ),\n                                  mapTo(true),\n                              )\n                            : of(false),\n                    ),\n                )\n                .subscribe(removed => {\n                    if (removed) {\n                        clearSelection();\n                        notificationService.success(\n                            _('catalog.notify-remove-collections-from-channel-success'),\n                            {\n                                count: selection.length,\n                            },\n                        );\n                        hostComponent.refresh();\n                    }\n                });\n        },\n    };\n","export type HasParent = { id: string; parent?: { id: string } | null };\nexport type TreeNode<T extends HasParent> = T & { children: Array<TreeNode<T>>; expanded: boolean };\nexport type RootNode<T extends HasParent> = { id?: string; children: Array<TreeNode<T>> };\n\n/**\n * Builds a tree from an array of nodes which have a parent.\n * Based on https://stackoverflow.com/a/31247960/772859, modified to preserve ordering.\n */\nexport function arrayToTree<T extends HasParent>(\n    nodes: T[],\n    currentState?: RootNode<T>,\n    expandedIds: string[] = [],\n): RootNode<T> {\n    const topLevelNodes: Array<TreeNode<T>> = [];\n    const mappedArr: { [id: string]: TreeNode<T> } = {};\n    const currentStateMap = treeToMap(currentState);\n\n    // First map the nodes of the array to an object -> create a hash table.\n    for (const node of nodes) {\n        mappedArr[node.id] = { ...(node as any), children: [] };\n    }\n\n    for (const id of nodes.map(n => n.id)) {\n        if (mappedArr.hasOwnProperty(id)) {\n            const mappedElem = mappedArr[id];\n            mappedElem.expanded = currentStateMap.get(id)?.expanded ?? expandedIds.includes(id);\n            const parent = mappedElem.parent;\n            if (!parent) {\n                continue;\n            }\n            // If the element is not at the root level, add it to its parent array of children.\n            const parentIsRoot = !mappedArr[parent.id];\n            if (!parentIsRoot) {\n                if (mappedArr[parent.id]) {\n                    mappedArr[parent.id].children.push(mappedElem);\n                } else {\n                    mappedArr[parent.id] = { children: [mappedElem] } as any;\n                }\n            } else {\n                topLevelNodes.push(mappedElem);\n            }\n        }\n    }\n    // tslint:disable-next-line:no-non-null-assertion\n    const rootId = topLevelNodes.length ? topLevelNodes[0].parent!.id : undefined;\n    return { id: rootId, children: topLevelNodes };\n}\n\n/**\n * Converts an existing tree (as generated by the arrayToTree function) into a flat\n * Map. This is used to persist certain states (e.g. `expanded`) when re-building the\n * tree.\n */\nfunction treeToMap<T extends HasParent>(tree?: RootNode<T>): Map<string, TreeNode<T>> {\n    const nodeMap = new Map<string, TreeNode<T>>();\n    function visit(node: TreeNode<T>) {\n        nodeMap.set(node.id, node);\n        node.children.forEach(visit);\n    }\n    if (tree) {\n        visit(tree as TreeNode<T>);\n    }\n    return nodeMap;\n}\n","import { CdkDragDrop } from '@angular/cdk/drag-drop';\nimport {\n    ChangeDetectionStrategy,\n    Component,\n    EventEmitter,\n    Input,\n    OnChanges,\n    Output,\n    SimpleChanges,\n} from '@angular/core';\nimport { Collection, SelectionManager } from '@vendure/admin-ui/core';\n\nimport { arrayToTree, HasParent, RootNode, TreeNode } from './array-to-tree';\n\nexport type RearrangeEvent = { collectionId: string; parentId: string; index: number };\nexport type CollectionPartial = Pick<Collection.Fragment, 'id' | 'parent' | 'name'>;\n\n@Component({\n    selector: 'vdr-collection-tree',\n    templateUrl: 'collection-tree.component.html',\n    styleUrls: ['./collection-tree.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class CollectionTreeComponent implements OnChanges {\n    @Input() collections: CollectionPartial[];\n    @Input() activeCollectionId: string;\n    @Input() expandAll = false;\n    @Input() expandedIds: string[] = [];\n    @Input() selectionManager: SelectionManager<CollectionPartial>;\n    @Output() rearrange = new EventEmitter<RearrangeEvent>();\n    @Output() deleteCollection = new EventEmitter<string>();\n    collectionTree: RootNode<CollectionPartial>;\n    private allMoveListItems: Array<{ path: string; id: string; ancestorIdPath: Set<string> }> = [];\n\n    ngOnChanges(changes: SimpleChanges) {\n        if ('collections' in changes && this.collections) {\n            this.collectionTree = arrayToTree(this.collections, this.collectionTree, this.expandedIds);\n            this.allMoveListItems = [];\n        }\n    }\n\n    onDrop(event: CdkDragDrop<CollectionPartial | RootNode<CollectionPartial>>) {\n        const item = event.item.data as CollectionPartial;\n        const newParent = event.container.data;\n        const newParentId = newParent.id;\n        if (newParentId == null) {\n            throw new Error(`Could not determine the ID of the root Collection`);\n        }\n        this.rearrange.emit({\n            collectionId: item.id,\n            parentId: newParentId,\n            index: event.currentIndex,\n        });\n    }\n\n    onMove(event: RearrangeEvent) {\n        this.rearrange.emit(event);\n    }\n\n    onDelete(id: string) {\n        this.deleteCollection.emit(id);\n    }\n\n    getMoveListItems(collection: CollectionPartial) {\n        if (this.allMoveListItems.length === 0) {\n            this.allMoveListItems = this.calculateAllMoveListItems();\n        }\n        return this.allMoveListItems.filter(\n            item =>\n                item.id !== collection.id &&\n                !item.ancestorIdPath.has(collection.id) &&\n                item.id !== collection.parent?.id,\n        );\n    }\n\n    calculateAllMoveListItems() {\n        const visit = (\n            node: TreeNode<any>,\n            parentPath: string[],\n            ancestorIdPath: Set<string>,\n            output: Array<{ path: string; id: string; ancestorIdPath: Set<string> }>,\n        ) => {\n            const path = parentPath.concat(node.name);\n            output.push({ path: path.slice(1).join(' / ') || 'root', id: node.id, ancestorIdPath });\n            node.children.forEach(child =>\n                visit(child, path, new Set<string>([...ancestorIdPath, node.id]), output),\n            );\n            return output;\n        };\n        return visit(this.collectionTree, [], new Set<string>(), []);\n    }\n\n    private isRootNode<T extends HasParent>(node: T | RootNode<T>): node is RootNode<T> {\n        return !node.hasOwnProperty('parent');\n    }\n}\n","import { CdkDragDrop, moveItemInArray } from '@angular/cdk/drag-drop';\nimport {\n    ChangeDetectionStrategy,\n    ChangeDetectorRef,\n    Component,\n    Input,\n    OnChanges,\n    OnDestroy,\n    OnInit,\n    Optional,\n    SimpleChanges,\n    SkipSelf,\n} from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { DataService, Permission, SelectionManager } from '@vendure/admin-ui/core';\nimport { Observable, Subscription } from 'rxjs';\nimport { map, shareReplay } from 'rxjs/operators';\n\nimport { RootNode, TreeNode } from './array-to-tree';\nimport { CollectionPartial, CollectionTreeComponent } from './collection-tree.component';\n\n@Component({\n    selector: 'vdr-collection-tree-node',\n    templateUrl: './collection-tree-node.component.html',\n    styleUrls: ['./collection-tree-node.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class CollectionTreeNodeComponent implements OnInit, OnChanges, OnDestroy {\n    depth = 0;\n    parentName: string;\n    @Input() collectionTree: TreeNode<CollectionPartial>;\n    @Input() activeCollectionId: string;\n    @Input() expandAll = false;\n    @Input() selectionManager: SelectionManager<CollectionPartial>;\n    hasUpdatePermission$: Observable<boolean>;\n    hasDeletePermission$: Observable<boolean>;\n    moveListItems: Array<{ path: string; id: string }> = [];\n    private subscription: Subscription;\n\n    constructor(\n        @SkipSelf() @Optional() private parent: CollectionTreeNodeComponent,\n        private root: CollectionTreeComponent,\n        private dataService: DataService,\n        private router: Router,\n        private route: ActivatedRoute,\n        private changeDetectorRef: ChangeDetectorRef,\n    ) {\n        if (parent) {\n            this.depth = parent.depth + 1;\n        }\n    }\n\n    ngOnInit() {\n        this.parentName = this.collectionTree.name || '<root>';\n        const permissions$ = this.dataService.client\n            .userStatus()\n            .mapStream(data => data.userStatus.permissions)\n            .pipe(shareReplay(1));\n        this.hasUpdatePermission$ = permissions$.pipe(\n            map(\n                perms =>\n                    perms.includes(Permission.UpdateCatalog) || perms.includes(Permission.UpdateCollection),\n            ),\n        );\n        this.hasDeletePermission$ = permissions$.pipe(\n            map(\n                perms =>\n                    perms.includes(Permission.DeleteCatalog) || perms.includes(Permission.DeleteCollection),\n            ),\n        );\n        this.subscription = this.selectionManager?.selectionChanges$.subscribe(() =>\n            this.changeDetectorRef.markForCheck(),\n        );\n    }\n\n    ngOnChanges(changes: SimpleChanges) {\n        const expandAllChange = changes['expandAll'];\n        if (expandAllChange) {\n            if (expandAllChange.previousValue === true && expandAllChange.currentValue === false) {\n                this.collectionTree.children.forEach(c => (c.expanded = false));\n            }\n        }\n    }\n\n    ngOnDestroy() {\n        this.subscription?.unsubscribe();\n    }\n\n    trackByFn(index: number, item: CollectionPartial) {\n        return item.id;\n    }\n\n    toggleExpanded(collection: TreeNode<CollectionPartial>) {\n        collection.expanded = !collection.expanded;\n        let expandedIds = this.route.snapshot.queryParamMap.get('expanded')?.split(',') ?? [];\n        if (collection.expanded) {\n            expandedIds.push(collection.id);\n        } else {\n            expandedIds = expandedIds.filter(id => id !== collection.id);\n        }\n        this.router.navigate(['./'], {\n            queryParams: {\n                expanded: expandedIds.filter(id => !!id).join(','),\n            },\n            queryParamsHandling: 'merge',\n            relativeTo: this.route,\n        });\n    }\n\n    getMoveListItems(collection: CollectionPartial) {\n        this.moveListItems = this.root.getMoveListItems(collection);\n    }\n\n    move(collection: CollectionPartial, parentId: string) {\n        this.root.onMove({\n            index: 0,\n            parentId,\n            collectionId: collection.id,\n        });\n    }\n\n    moveUp(collection: CollectionPartial, currentIndex: number) {\n        if (!collection.parent) {\n            return;\n        }\n        this.root.onMove({\n            index: currentIndex - 1,\n            parentId: collection.parent.id,\n            collectionId: collection.id,\n        });\n    }\n\n    moveDown(collection: CollectionPartial, currentIndex: number) {\n        if (!collection.parent) {\n            return;\n        }\n        this.root.onMove({\n            index: currentIndex + 1,\n            parentId: collection.parent.id,\n            collectionId: collection.id,\n        });\n    }\n\n    drop(event: CdkDragDrop<CollectionPartial | RootNode<CollectionPartial>>) {\n        moveItemInArray(this.collectionTree.children, event.previousIndex, event.currentIndex);\n        this.root.onDrop(event);\n    }\n\n    delete(id: string) {\n        this.root.onDelete(id);\n    }\n}\n","import { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport {\n    BulkAction,\n    currentChannelIsNotDefault,\n    DataService,\n    DeletionResult,\n    getChannelCodeFromUserStatus,\n    GetFacetList,\n    isMultiChannel,\n    ModalService,\n    NotificationService,\n    Permission,\n} from '@vendure/admin-ui/core';\nimport { unique } from '@vendure/common/lib/unique';\nimport { EMPTY, of } from 'rxjs';\nimport { map, mapTo, switchMap } from 'rxjs/operators';\n\nimport { AssignToChannelDialogComponent } from '../assign-to-channel-dialog/assign-to-channel-dialog.component';\n\nimport { FacetListComponent } from './facet-list.component';\n\nexport const deleteFacetsBulkAction: BulkAction<GetFacetList.Items, FacetListComponent> = {\n    location: 'facet-list',\n    label: _('common.delete'),\n    icon: 'trash',\n    iconClass: 'is-danger',\n    requiresPermission: userPermissions =>\n        userPermissions.includes(Permission.DeleteFacet) ||\n        userPermissions.includes(Permission.DeleteCatalog),\n    onClick: ({ injector, selection, hostComponent, clearSelection }) => {\n        const modalService = injector.get(ModalService);\n        const dataService = injector.get(DataService);\n        const notificationService = injector.get(NotificationService);\n\n        function showModalAndDelete(facetIds: string[], message?: string) {\n            return modalService\n                .dialog({\n                    title: _('catalog.confirm-bulk-delete-facets'),\n                    translationVars: {\n                        count: selection.length,\n                    },\n                    size: message ? 'lg' : 'md',\n                    body: message,\n                    buttons: [\n                        { type: 'secondary', label: _('common.cancel') },\n                        {\n                            type: 'danger',\n                            label: message ? _('common.force-delete') : _('common.delete'),\n                            returnValue: true,\n                        },\n                    ],\n                })\n                .pipe(\n                    switchMap(res =>\n                        res\n                            ? dataService.facet\n                                  .deleteFacets(facetIds, !!message)\n                                  .pipe(map(res2 => res2.deleteFacets))\n                            : of([]),\n                    ),\n                );\n        }\n\n        showModalAndDelete(unique(selection.map(f => f.id)))\n            .pipe(\n                switchMap(result => {\n                    let deletedCount = 0;\n                    const errors: string[] = [];\n                    const errorIds: string[] = [];\n                    let i = 0;\n                    for (const item of result) {\n                        if (item.result === DeletionResult.DELETED) {\n                            deletedCount++;\n                        } else if (item.message) {\n                            errors.push(item.message);\n                            errorIds.push(selection[i]?.id);\n                        }\n                        i++;\n                    }\n                    if (0 < errorIds.length) {\n                        return showModalAndDelete(errorIds, errors.join('\\n')).pipe(\n                            map(result2 => {\n                                const deletedCount2 = result2.filter(\n                                    r => r.result === DeletionResult.DELETED,\n                                ).length;\n                                return deletedCount + deletedCount2;\n                            }),\n                        );\n                    } else {\n                        return of(deletedCount);\n                    }\n                }),\n            )\n            .subscribe(deletedCount => {\n                if (deletedCount) {\n                    hostComponent.refresh();\n                    clearSelection();\n                    notificationService.success(_('catalog.notify-bulk-delete-facets-success'), {\n                        count: deletedCount,\n                    });\n                }\n            });\n    },\n};\n\nexport const assignFacetsToChannelBulkAction: BulkAction<GetFacetList.Items, FacetListComponent> = {\n    location: 'facet-list',\n    label: _('catalog.assign-to-channel'),\n    icon: 'layers',\n    requiresPermission: userPermissions =>\n        userPermissions.includes(Permission.UpdateFacet) ||\n        userPermissions.includes(Permission.UpdateCatalog),\n    isVisible: ({ injector }) => isMultiChannel(injector.get(DataService)),\n    onClick: ({ injector, selection, hostComponent, clearSelection }) => {\n        const modalService = injector.get(ModalService);\n        const dataService = injector.get(DataService);\n        const notificationService = injector.get(NotificationService);\n        modalService\n            .fromComponent(AssignToChannelDialogComponent, {\n                size: 'md',\n                locals: {},\n            })\n            .pipe(\n                switchMap(result => {\n                    if (result) {\n                        return dataService.facet\n                            .assignFacetsToChannel({\n                                facetIds: selection.map(f => f.id),\n                                channelId: result.id,\n                            })\n                            .pipe(mapTo(result));\n                    } else {\n                        return EMPTY;\n                    }\n                }),\n            )\n            .subscribe(result => {\n                notificationService.success(_('catalog.assign-facets-to-channel-success'), {\n                    count: selection.length,\n                    channelCode: result.code,\n                });\n                clearSelection();\n            });\n    },\n};\n\nexport const removeFacetsFromChannelBulkAction: BulkAction<GetFacetList.Items, FacetListComponent> = {\n    location: 'facet-list',\n    label: _('catalog.remove-from-channel'),\n    getTranslationVars: ({ injector }) => getChannelCodeFromUserStatus(injector.get(DataService)),\n    icon: 'layers',\n    iconClass: 'is-warning',\n    requiresPermission: userPermissions =>\n        userPermissions.includes(Permission.UpdateFacet) ||\n        userPermissions.includes(Permission.UpdateCatalog),\n    isVisible: ({ injector }) => currentChannelIsNotDefault(injector.get(DataService)),\n    onClick: ({ injector, selection, hostComponent, clearSelection }) => {\n        const modalService = injector.get(ModalService);\n        const dataService = injector.get(DataService);\n        const notificationService = injector.get(NotificationService);\n\n        const activeChannelId$ = dataService.client\n            .userStatus()\n            .mapSingle(({ userStatus }) => userStatus.activeChannelId);\n\n        function showModalAndDelete(facetIds: string[], message?: string) {\n            return modalService\n                .dialog({\n                    title: _('catalog.remove-from-channel'),\n                    translationVars: {\n                        count: selection.length,\n                    },\n                    size: message ? 'lg' : 'md',\n                    body: message,\n                    buttons: [\n                        { type: 'secondary', label: _('common.cancel') },\n                        {\n                            type: 'danger',\n                            label: message ? _('common.force-remove') : _('common.remove'),\n                            returnValue: true,\n                        },\n                    ],\n                })\n                .pipe(\n                    switchMap(res =>\n                        res\n                            ? activeChannelId$.pipe(\n                                  switchMap(activeChannelId =>\n                                      activeChannelId\n                                          ? dataService.facet.removeFacetsFromChannel({\n                                                channelId: activeChannelId,\n                                                facetIds,\n                                                force: !!message,\n                                            })\n                                          : EMPTY,\n                                  ),\n                                  map(res2 => res2.removeFacetsFromChannel),\n                              )\n                            : EMPTY,\n                    ),\n                );\n        }\n\n        showModalAndDelete(unique(selection.map(f => f.id)))\n            .pipe(\n                switchMap(result => {\n                    let removedCount = selection.length;\n                    const errors: string[] = [];\n                    const errorIds: string[] = [];\n                    let i = 0;\n                    for (const item of result) {\n                        if (item.__typename === 'FacetInUseError') {\n                            errors.push(item.message);\n                            errorIds.push(selection[i]?.id);\n                            removedCount--;\n                        }\n                        i++;\n                    }\n                    if (0 < errorIds.length) {\n                        return showModalAndDelete(errorIds, errors.join('\\n')).pipe(\n                            map(result2 => {\n                                const notRemovedCount = result2.filter(\n                                    r => r.__typename === 'FacetInUseError',\n                                ).length;\n                                return selection.length - notRemovedCount;\n                            }),\n                        );\n                    } else {\n                        return of(removedCount);\n                    }\n                }),\n                switchMap(removedCount =>\n                    removedCount\n                        ? getChannelCodeFromUserStatus(dataService).then(({ channelCode }) => ({\n                              channelCode,\n                              removedCount,\n                          }))\n                        : EMPTY,\n                ),\n            )\n            .subscribe(({ removedCount, channelCode }) => {\n                if (removedCount) {\n                    hostComponent.refresh();\n                    clearSelection();\n                    notificationService.success(_('catalog.notify-remove-facets-from-channel-success'), {\n                        count: removedCount,\n                        channelCode,\n                    });\n                }\n            });\n    },\n};\n","import { Component, ElementRef, EventEmitter, OnInit, Output, QueryList, ViewChildren } from '@angular/core';\nimport { CurrencyCode, DataService } from '@vendure/admin-ui/core';\nimport { generateAllCombinations } from '@vendure/common/lib/shared-utils';\n\nimport { OptionValueInputComponent } from '../option-value-input/option-value-input.component';\n\nconst DEFAULT_VARIANT_CODE = '__DEFAULT_VARIANT__';\nexport type CreateVariantValues = {\n    optionValues: string[];\n    enabled: boolean;\n    sku: string;\n    price: number;\n    stock: number;\n};\nexport type CreateProductVariantsConfig = {\n    groups: Array<{ name: string; values: string[] }>;\n    variants: CreateVariantValues[];\n};\n\n@Component({\n    selector: 'vdr-generate-product-variants',\n    templateUrl: './generate-product-variants.component.html',\n    styleUrls: ['./generate-product-variants.component.scss'],\n})\nexport class GenerateProductVariantsComponent implements OnInit {\n    @Output() variantsChange = new EventEmitter<CreateProductVariantsConfig>();\n    @ViewChildren('optionGroupName', { read: ElementRef }) groupNameInputs: QueryList<ElementRef>;\n    optionGroups: Array<{ name: string; values: Array<{ name: string; locked: boolean }> }> = [];\n    currencyCode: CurrencyCode;\n    variants: Array<{ id: string; values: string[] }>;\n    variantFormValues: { [id: string]: CreateVariantValues } = {};\n    constructor(private dataService: DataService) {}\n\n    ngOnInit() {\n        this.dataService.settings.getActiveChannel().single$.subscribe(data => {\n            this.currencyCode = data.activeChannel.currencyCode;\n        });\n\n        this.generateVariants();\n    }\n\n    addOption() {\n        this.optionGroups.push({ name: '', values: [] });\n        const index = this.optionGroups.length - 1;\n        setTimeout(() => {\n            const input = this.groupNameInputs.get(index)?.nativeElement;\n            input?.focus();\n        });\n    }\n\n    removeOption(name: string) {\n        this.optionGroups = this.optionGroups.filter(g => g.name !== name);\n        this.generateVariants();\n    }\n\n    generateVariants() {\n        const totalValuesCount = this.optionGroups.reduce((sum, group) => sum + group.values.length, 0);\n        const groups = totalValuesCount\n            ? this.optionGroups.map(g => g.values.map(v => v.name))\n            : [[DEFAULT_VARIANT_CODE]];\n        this.variants = generateAllCombinations(groups).map(values => ({ id: values.join('|'), values }));\n\n        this.variants.forEach(variant => {\n            if (!this.variantFormValues[variant.id]) {\n                this.variantFormValues[variant.id] = {\n                    optionValues: variant.values,\n                    enabled: true,\n                    price: this.copyFromDefault(variant.id, 'price', 0),\n                    sku: this.copyFromDefault(variant.id, 'sku', ''),\n                    stock: this.copyFromDefault(variant.id, 'stock', 0),\n                };\n            }\n        });\n        this.onFormChange();\n    }\n\n    trackByFn(index: number, variant: { name: string; values: string[] }) {\n        return variant.values.join('|');\n    }\n\n    handleEnter(event: KeyboardEvent, optionValueInputComponent: OptionValueInputComponent) {\n        event.preventDefault();\n        event.stopPropagation();\n        optionValueInputComponent.focus();\n    }\n\n    onFormChange() {\n        const variantsToCreate = this.variants.map(v => this.variantFormValues[v.id]).filter(v => v.enabled);\n        this.variantsChange.emit({\n            groups: this.optionGroups.map(og => ({ name: og.name, values: og.values.map(v => v.name) })),\n            variants: variantsToCreate,\n        });\n    }\n\n    private copyFromDefault<T extends keyof CreateVariantValues>(\n        variantId: string,\n        prop: T,\n        value: CreateVariantValues[T],\n    ): CreateVariantValues[T] {\n        return variantId !== DEFAULT_VARIANT_CODE\n            ? this.variantFormValues[DEFAULT_VARIANT_CODE][prop]\n            : value;\n    }\n}\n","import {\n    ChangeDetectionStrategy,\n    ChangeDetectorRef,\n    Component,\n    ElementRef,\n    EventEmitter,\n    forwardRef,\n    Input,\n    OnChanges,\n    OnInit,\n    Output,\n    Provider,\n    QueryList,\n    SimpleChanges,\n    ViewChild,\n    ViewChildren,\n} from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { unique } from '@vendure/common/lib/unique';\n\nexport const OPTION_VALUE_INPUT_VALUE_ACCESSOR: Provider = {\n    provide: NG_VALUE_ACCESSOR,\n    useExisting: forwardRef(() => OptionValueInputComponent),\n    multi: true,\n};\n\ninterface Option {\n    id?: string;\n    name: string;\n    locked: boolean;\n}\n\n@Component({\n    selector: 'vdr-option-value-input',\n    templateUrl: './option-value-input.component.html',\n    styleUrls: ['./option-value-input.component.scss'],\n    changeDetection: ChangeDetectionStrategy.Default,\n    providers: [OPTION_VALUE_INPUT_VALUE_ACCESSOR],\n})\nexport class OptionValueInputComponent implements ControlValueAccessor {\n    @Input() groupName = '';\n    @ViewChild('textArea', { static: true }) textArea: ElementRef<HTMLTextAreaElement>;\n    @ViewChildren('editNameInput', { read: ElementRef }) nameInputs: QueryList<ElementRef>;\n    @Input() options: Option[];\n    @Output() add = new EventEmitter<Option>();\n    @Output() remove = new EventEmitter<Option>();\n    @Output() edit = new EventEmitter<{ index: number; option: Option }>();\n    @Input() disabled = false;\n    input = '';\n    isFocussed = false;\n    lastSelected = false;\n    formValue: Option[];\n    editingIndex = -1;\n    onChangeFn: (value: any) => void;\n    onTouchFn: (value: any) => void;\n\n    get optionValues(): Option[] {\n        return this.formValue ?? this.options ?? [];\n    }\n\n    constructor(private changeDetector: ChangeDetectorRef) {}\n\n    registerOnChange(fn: any): void {\n        this.onChangeFn = fn;\n    }\n\n    registerOnTouched(fn: any): void {\n        this.onTouchFn = fn;\n    }\n\n    setDisabledState(isDisabled: boolean): void {\n        this.disabled = isDisabled;\n        this.changeDetector.markForCheck();\n    }\n\n    writeValue(obj: any): void {\n        this.formValue = obj || [];\n    }\n\n    focus() {\n        this.textArea.nativeElement.focus();\n    }\n\n    editName(index: number, event: MouseEvent) {\n        const optionValue = this.optionValues[index];\n        if (!optionValue.locked && !optionValue.id) {\n            event.cancelBubble = true;\n            this.editingIndex = index;\n            const input = this.nameInputs.get(index)?.nativeElement;\n            setTimeout(() => input?.focus());\n        }\n    }\n\n    updateOption(index: number, event: InputEvent) {\n        const optionValue = this.optionValues[index];\n        const newName = (event.target as HTMLInputElement).value;\n        if (optionValue) {\n            if (newName) {\n                optionValue.name = newName;\n                this.edit.emit({ index, option: optionValue });\n            }\n            this.editingIndex = -1;\n        }\n    }\n\n    removeOption(option: Option) {\n        if (!option.locked) {\n            if (this.formValue) {\n                this.formValue = this.formValue?.filter(o => o.name !== option.name);\n                this.onChangeFn(this.formValue);\n            } else {\n                this.remove.emit(option);\n            }\n        }\n    }\n\n    handleKey(event: KeyboardEvent) {\n        switch (event.key) {\n            case ',':\n            case 'Enter':\n                this.addOptionValue();\n                event.preventDefault();\n                break;\n            case 'Backspace':\n                if (this.lastSelected) {\n                    this.removeLastOption();\n                    this.lastSelected = false;\n                } else if (this.input === '') {\n                    this.lastSelected = true;\n                }\n                break;\n            default:\n                this.lastSelected = false;\n        }\n    }\n\n    handleBlur() {\n        this.isFocussed = false;\n        this.addOptionValue();\n    }\n\n    private addOptionValue() {\n        const options = this.parseInputIntoOptions(this.input).filter(option => {\n            // do not add an option with the same name\n            // as an existing option\n            const existing = this.options ?? this.formValue;\n            return !existing?.find(o => o?.name === option.name);\n        });\n        if (!this.formValue && this.options) {\n            for (const option of options) {\n                this.add.emit(option);\n            }\n        } else {\n            this.formValue = unique([...this.formValue, ...options]);\n            this.onChangeFn(this.formValue);\n        }\n        this.input = '';\n    }\n\n    private parseInputIntoOptions(input: string): Option[] {\n        return input\n            .split(/[,\\n]/)\n            .map(s => s.trim())\n            .filter(s => s !== '')\n            .map(s => ({ name: s, locked: false }));\n    }\n\n    private removeLastOption() {\n        if (this.optionValues.length) {\n            const option = this.optionValues[this.optionValues.length - 1];\n            this.removeOption(option);\n        }\n    }\n}\n","import { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport {\n    BulkAction,\n    currentChannelIsNotDefault,\n    DataService,\n    DeletionResult,\n    getChannelCodeFromUserStatus,\n    isMultiChannel,\n    ModalService,\n    NotificationService,\n    Permission,\n    SearchProducts,\n} from '@vendure/admin-ui/core';\nimport { unique } from '@vendure/common/lib/unique';\nimport { EMPTY, from, of } from 'rxjs';\nimport { mapTo, switchMap } from 'rxjs/operators';\n\nimport { AssignProductsToChannelDialogComponent } from '../assign-products-to-channel-dialog/assign-products-to-channel-dialog.component';\nimport { BulkAddFacetValuesDialogComponent } from '../bulk-add-facet-values-dialog/bulk-add-facet-values-dialog.component';\n\nimport { ProductListComponent } from './product-list.component';\n\nexport const deleteProductsBulkAction: BulkAction<SearchProducts.Items, ProductListComponent> = {\n    location: 'product-list',\n    label: _('common.delete'),\n    icon: 'trash',\n    iconClass: 'is-danger',\n    requiresPermission: userPermissions =>\n        userPermissions.includes(Permission.DeleteProduct) ||\n        userPermissions.includes(Permission.DeleteCatalog),\n    onClick: ({ injector, selection, hostComponent, clearSelection }) => {\n        const modalService = injector.get(ModalService);\n        const dataService = injector.get(DataService);\n        const notificationService = injector.get(NotificationService);\n        modalService\n            .dialog({\n                title: _('catalog.confirm-bulk-delete-products'),\n                translationVars: {\n                    count: selection.length,\n                },\n                buttons: [\n                    { type: 'secondary', label: _('common.cancel') },\n                    { type: 'danger', label: _('common.delete'), returnValue: true },\n                ],\n            })\n            .pipe(\n                switchMap(response =>\n                    response\n                        ? dataService.product.deleteProducts(unique(selection.map(p => p.productId)))\n                        : EMPTY,\n                ),\n            )\n            .subscribe(result => {\n                let deleted = 0;\n                const errors: string[] = [];\n                for (const item of result.deleteProducts) {\n                    if (item.result === DeletionResult.DELETED) {\n                        deleted++;\n                    } else if (item.message) {\n                        errors.push(item.message);\n                    }\n                }\n                if (0 < deleted) {\n                    notificationService.success(_('catalog.notify-bulk-delete-products-success'), {\n                        count: deleted,\n                    });\n                }\n                if (0 < errors.length) {\n                    notificationService.error(errors.join('\\n'));\n                }\n                hostComponent.refresh();\n                clearSelection();\n            });\n    },\n};\n\nexport const assignProductsToChannelBulkAction: BulkAction<SearchProducts.Items, ProductListComponent> = {\n    location: 'product-list',\n    label: _('catalog.assign-to-channel'),\n    icon: 'layers',\n    requiresPermission: userPermissions =>\n        userPermissions.includes(Permission.UpdateCatalog) ||\n        userPermissions.includes(Permission.UpdateProduct),\n    isVisible: ({ injector }) => isMultiChannel(injector.get(DataService)),\n    onClick: ({ injector, selection, hostComponent, clearSelection }) => {\n        const modalService = injector.get(ModalService);\n        const dataService = injector.get(DataService);\n        const notificationService = injector.get(NotificationService);\n        modalService\n            .fromComponent(AssignProductsToChannelDialogComponent, {\n                size: 'lg',\n                locals: {\n                    productIds: unique(selection.map(p => p.productId)),\n                    currentChannelIds: [],\n                },\n            })\n            .subscribe(result => {\n                if (result) {\n                    clearSelection();\n                }\n            });\n    },\n};\n\nexport const removeProductsFromChannelBulkAction: BulkAction<SearchProducts.Items, ProductListComponent> = {\n    location: 'product-list',\n    label: _('catalog.remove-from-channel'),\n    requiresPermission: userPermissions =>\n        userPermissions.includes(Permission.UpdateChannel) ||\n        userPermissions.includes(Permission.UpdateProduct),\n    getTranslationVars: ({ injector }) => getChannelCodeFromUserStatus(injector.get(DataService)),\n    icon: 'layers',\n    iconClass: 'is-warning',\n    isVisible: ({ injector }) => currentChannelIsNotDefault(injector.get(DataService)),\n    onClick: ({ injector, selection, hostComponent, clearSelection }) => {\n        const modalService = injector.get(ModalService);\n        const dataService = injector.get(DataService);\n        const notificationService = injector.get(NotificationService);\n        const activeChannelId$ = dataService.client\n            .userStatus()\n            .mapSingle(({ userStatus }) => userStatus.activeChannelId);\n\n        from(getChannelCodeFromUserStatus(injector.get(DataService)))\n            .pipe(\n                switchMap(({ channelCode }) =>\n                    modalService.dialog({\n                        title: _('catalog.remove-from-channel'),\n                        translationVars: {\n                            channelCode,\n                        },\n                        buttons: [\n                            { type: 'secondary', label: _('common.cancel') },\n                            {\n                                type: 'danger',\n                                label: _('common.remove'),\n                                returnValue: true,\n                            },\n                        ],\n                    }),\n                ),\n                switchMap(res =>\n                    res\n                        ? activeChannelId$.pipe(\n                              switchMap(activeChannelId =>\n                                  activeChannelId\n                                      ? dataService.product.removeProductsFromChannel({\n                                            channelId: activeChannelId,\n                                            productIds: selection.map(p => p.productId),\n                                        })\n                                      : EMPTY,\n                              ),\n                              mapTo(true),\n                          )\n                        : of(false),\n                ),\n            )\n            .subscribe(removed => {\n                if (removed) {\n                    clearSelection();\n                    notificationService.success(_('common.notify-remove-products-from-channel-success'), {\n                        count: selection.length,\n                    });\n                    setTimeout(() => hostComponent.refresh(), 1000);\n                }\n            });\n    },\n};\n\nexport const assignFacetValuesToProductsBulkAction: BulkAction<SearchProducts.Items, ProductListComponent> = {\n    location: 'product-list',\n    label: _('catalog.edit-facet-values'),\n    icon: 'tag',\n    requiresPermission: userPermissions =>\n        userPermissions.includes(Permission.UpdateCatalog) ||\n        userPermissions.includes(Permission.UpdateProduct),\n    onClick: ({ injector, selection, hostComponent, clearSelection }) => {\n        const modalService = injector.get(ModalService);\n        const dataService = injector.get(DataService);\n        const notificationService = injector.get(NotificationService);\n        const mode: 'product' | 'variant' = hostComponent.groupByProduct ? 'product' : 'variant';\n        const ids =\n            mode === 'product'\n                ? unique(selection.map(p => p.productId))\n                : unique(selection.map(p => p.productVariantId));\n        return dataService.facet\n            .getAllFacets()\n            .mapSingle(data => data.facets.items)\n            .pipe(\n                switchMap(facets =>\n                    modalService.fromComponent(BulkAddFacetValuesDialogComponent, {\n                        size: 'xl',\n                        locals: {\n                            facets,\n                            mode,\n                            ids,\n                        },\n                    }),\n                ),\n            )\n            .subscribe(result => {\n                if (result) {\n                    notificationService.success(_('common.notify-bulk-update-success'), {\n                        count: selection.length,\n                        entity: mode === 'product' ? 'Products' : 'ProductVariants',\n                    });\n                    clearSelection();\n                }\n            });\n    },\n};\n","import { ChangeDetectionStrategy, Component, OnInit } from '@angular/core';\nimport { FormControl, FormGroup } from '@angular/forms';\nimport {\n    CustomFieldConfig,\n    LanguageCode,\n    ProductVariant,\n    UpdateProductOptionInput,\n} from '@vendure/admin-ui/core';\nimport { createUpdatedTranslatable } from '@vendure/admin-ui/core';\nimport { Dialog } from '@vendure/admin-ui/core';\nimport { normalizeString } from '@vendure/common/lib/normalize-string';\n\n@Component({\n    selector: 'vdr-update-product-option-dialog',\n    templateUrl: './update-product-option-dialog.component.html',\n    styleUrls: ['./update-product-option-dialog.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class UpdateProductOptionDialogComponent\n    implements Dialog<UpdateProductOptionInput & { autoUpdate: boolean }>, OnInit {\n    resolveWith: (result?: UpdateProductOptionInput & { autoUpdate: boolean }) => void;\n    updateVariantName = true;\n    // Provided by caller\n    productOption: ProductVariant.Options;\n    activeLanguage: LanguageCode;\n    name: string;\n    code: string;\n    customFields: CustomFieldConfig[];\n    codeInputTouched = false;\n    customFieldsForm: FormGroup;\n\n    ngOnInit(): void {\n        const currentTranslation = this.productOption.translations.find(\n            t => t.languageCode === this.activeLanguage,\n        );\n        this.name = currentTranslation?.name ?? '';\n        this.code = this.productOption.code;\n        this.customFieldsForm = new FormGroup({});\n        if (this.customFields) {\n            const cfCurrentTranslation =\n                (currentTranslation && (currentTranslation as any).customFields) || {};\n\n            for (const fieldDef of this.customFields) {\n                const key = fieldDef.name;\n                const value =\n                    fieldDef.type === 'localeString'\n                        ? cfCurrentTranslation[key]\n                        : (this.productOption as any).customFields[key];\n                this.customFieldsForm.addControl(fieldDef.name, new FormControl(value));\n            }\n        }\n    }\n\n    update() {\n        const result = createUpdatedTranslatable({\n            translatable: this.productOption,\n            languageCode: this.activeLanguage,\n            updatedFields: {\n                code: this.code,\n                name: this.name,\n                customFields: this.customFieldsForm.value,\n            },\n            customFieldConfig: this.customFields,\n            defaultTranslation: {\n                languageCode: this.activeLanguage,\n                name: '',\n            },\n        });\n        this.resolveWith({ ...result, autoUpdate: this.updateVariantName });\n    }\n\n    cancel() {\n        this.resolveWith();\n    }\n\n    updateCode(nameValue: string) {\n        if (!this.codeInputTouched && !this.productOption.code) {\n            this.code = normalizeString(nameValue, '-');\n        }\n    }\n}\n","import {\n    ChangeDetectionStrategy,\n    ChangeDetectorRef,\n    Component,\n    EventEmitter,\n    Input,\n    OnChanges,\n    OnDestroy,\n    OnInit,\n    Output,\n    SimpleChanges,\n} from '@angular/core';\nimport { FormArray, FormGroup } from '@angular/forms';\nimport {\n    CustomFieldConfig,\n    DataService,\n    FacetValue,\n    FacetWithValues,\n    flattenFacetValues,\n    GlobalFlag,\n    LanguageCode,\n    ModalService,\n    Permission,\n    ProductDetail,\n    ProductOptionFragment,\n    ProductVariant,\n    TaxCategory,\n    UpdateProductOptionInput,\n} from '@vendure/admin-ui/core';\nimport { DEFAULT_CHANNEL_CODE } from '@vendure/common/lib/shared-constants';\nimport { notNullOrUndefined } from '@vendure/common/lib/shared-utils';\nimport { PaginationInstance } from 'ngx-pagination';\nimport { Subscription } from 'rxjs';\nimport { debounceTime, distinctUntilChanged, map } from 'rxjs/operators';\n\nimport { AssetChange } from '../assets/assets.component';\nimport {\n    PaginationConfig,\n    SelectedAssets,\n    VariantFormValue,\n} from '../product-detail/product-detail.component';\nimport { UpdateProductOptionDialogComponent } from '../update-product-option-dialog/update-product-option-dialog.component';\n\nexport interface VariantAssetChange extends AssetChange {\n    variantId: string;\n}\n\n@Component({\n    selector: 'vdr-product-variants-list',\n    templateUrl: './product-variants-list.component.html',\n    styleUrls: ['./product-variants-list.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ProductVariantsListComponent implements OnChanges, OnInit, OnDestroy {\n    @Input('productVariantsFormArray') formArray: FormArray;\n    @Input() variants: ProductVariant.Fragment[];\n    @Input() paginationConfig: PaginationConfig;\n    @Input() channelPriceIncludesTax: boolean;\n    @Input() taxCategories: TaxCategory[];\n    @Input() facets: FacetWithValues.Fragment[];\n    @Input() optionGroups: ProductDetail.OptionGroups[];\n    @Input() customFields: CustomFieldConfig[];\n    @Input() customOptionFields: CustomFieldConfig[];\n    @Input() activeLanguage: LanguageCode;\n    @Input() pendingAssetChanges: { [variantId: string]: SelectedAssets };\n    @Output() assignToChannel = new EventEmitter<ProductVariant.Fragment>();\n    @Output() removeFromChannel = new EventEmitter<{\n        channelId: string;\n        variant: ProductVariant.Fragment;\n    }>();\n    @Output() assetChange = new EventEmitter<VariantAssetChange>();\n    @Output() selectionChange = new EventEmitter<string[]>();\n    @Output() selectFacetValueClick = new EventEmitter<string[]>();\n    @Output() updateProductOption = new EventEmitter<UpdateProductOptionInput & { autoUpdate: boolean }>();\n    selectedVariantIds: string[] = [];\n    formGroupMap = new Map<string, FormGroup>();\n    GlobalFlag = GlobalFlag;\n    globalTrackInventory: boolean;\n    globalOutOfStockThreshold: number;\n    readonly updatePermission = [Permission.UpdateCatalog, Permission.UpdateProduct];\n    private facetValues: FacetValue.Fragment[];\n    private subscription: Subscription;\n\n    constructor(\n        private changeDetector: ChangeDetectorRef,\n        private modalService: ModalService,\n        private dataService: DataService,\n    ) {}\n\n    ngOnInit() {\n        this.dataService.settings.getGlobalSettings('cache-first').single$.subscribe(({ globalSettings }) => {\n            this.globalTrackInventory = globalSettings.trackInventory;\n            this.globalOutOfStockThreshold = globalSettings.outOfStockThreshold;\n            this.changeDetector.markForCheck();\n        });\n        this.subscription = this.formArray.valueChanges.subscribe(() => this.changeDetector.markForCheck());\n\n        this.subscription.add(\n            this.formArray.valueChanges\n                .pipe(\n                    map(value => value.length),\n                    debounceTime(1),\n                    distinctUntilChanged(),\n                )\n                .subscribe(() => {\n                    this.buildFormGroupMap();\n                }),\n        );\n\n        this.buildFormGroupMap();\n    }\n\n    ngOnChanges(changes: SimpleChanges) {\n        if ('facets' in changes && !!changes['facets'].currentValue) {\n            this.facetValues = flattenFacetValues(this.facets);\n        }\n    }\n\n    ngOnDestroy() {\n        if (this.subscription) {\n            this.subscription.unsubscribe();\n        }\n    }\n\n    isDefaultChannel(channelCode: string): boolean {\n        return channelCode === DEFAULT_CHANNEL_CODE;\n    }\n\n    trackById(index: number, item: ProductVariant.Fragment) {\n        return item.id;\n    }\n\n    inventoryIsNotTracked(formGroup: FormGroup): boolean {\n        const trackInventory = formGroup.get('trackInventory')?.value;\n        return (\n            trackInventory === GlobalFlag.FALSE ||\n            (trackInventory === GlobalFlag.INHERIT && this.globalTrackInventory === false)\n        );\n    }\n\n    getTaxCategoryName(group: FormGroup): string {\n        const control = group.get(['taxCategoryId']);\n        if (control && this.taxCategories) {\n            const match = this.taxCategories.find(t => t.id === control.value);\n            return match ? match.name : '';\n        }\n        return '';\n    }\n\n    getStockOnHandMinValue(variant: FormGroup) {\n        const effectiveOutOfStockThreshold = variant.get('useGlobalOutOfStockThreshold')?.value\n            ? this.globalOutOfStockThreshold\n            : variant.get('outOfStockThreshold')?.value;\n        return effectiveOutOfStockThreshold;\n    }\n\n    getSaleableStockLevel(variant: ProductVariant.Fragment) {\n        const effectiveOutOfStockThreshold = variant.useGlobalOutOfStockThreshold\n            ? this.globalOutOfStockThreshold\n            : variant.outOfStockThreshold;\n        return variant.stockOnHand - variant.stockAllocated - effectiveOutOfStockThreshold;\n    }\n\n    areAllSelected(): boolean {\n        return !!this.variants && this.selectedVariantIds.length === this.variants.length;\n    }\n\n    onAssetChange(variantId: string, event: AssetChange) {\n        this.assetChange.emit({\n            variantId,\n            ...event,\n        });\n        const index = this.variants.findIndex(v => v.id === variantId);\n        this.formArray.at(index).markAsDirty();\n    }\n\n    toggleSelectAll() {\n        if (this.areAllSelected()) {\n            this.selectedVariantIds = [];\n        } else {\n            this.selectedVariantIds = this.variants.map(v => v.id);\n        }\n        this.selectionChange.emit(this.selectedVariantIds);\n    }\n\n    toggleSelectVariant(variantId: string) {\n        const index = this.selectedVariantIds.indexOf(variantId);\n        if (-1 < index) {\n            this.selectedVariantIds.splice(index, 1);\n        } else {\n            this.selectedVariantIds.push(variantId);\n        }\n        this.selectionChange.emit(this.selectedVariantIds);\n    }\n\n    optionGroupName(optionGroupId: string): string | undefined {\n        const group = this.optionGroups.find(g => g.id === optionGroupId);\n        if (group) {\n            const translation =\n                group?.translations.find(t => t.languageCode === this.activeLanguage) ??\n                group.translations[0];\n            return translation.name;\n        }\n    }\n\n    optionName(option: ProductOptionFragment) {\n        const translation =\n            option.translations.find(t => t.languageCode === this.activeLanguage) ?? option.translations[0];\n        return translation.name;\n    }\n\n    pendingFacetValues(variant: ProductVariant.Fragment) {\n        if (this.facets) {\n            const formFacetValueIds = this.getFacetValueIds(variant.id);\n            const variantFacetValueIds = variant.facetValues.map(fv => fv.id);\n            return formFacetValueIds\n                .filter(x => !variantFacetValueIds.includes(x))\n                .map(id => this.facetValues.find(fv => fv.id === id))\n                .filter(notNullOrUndefined);\n        } else {\n            return [];\n        }\n    }\n\n    existingFacetValues(variant: ProductVariant.Fragment) {\n        const formFacetValueIds = this.getFacetValueIds(variant.id);\n        const intersection = [...formFacetValueIds].filter(x =>\n            variant.facetValues.map(fv => fv.id).includes(x),\n        );\n        return intersection\n            .map(id => variant.facetValues.find(fv => fv.id === id))\n            .filter(notNullOrUndefined);\n    }\n\n    removeFacetValue(variant: ProductVariant.Fragment, facetValueId: string) {\n        const formGroup = this.formGroupMap.get(variant.id);\n        if (formGroup) {\n            const newValue = (formGroup.value as VariantFormValue).facetValueIds.filter(\n                id => id !== facetValueId,\n            );\n            formGroup.patchValue({\n                facetValueIds: newValue,\n            });\n            formGroup.markAsDirty();\n        }\n    }\n\n    isVariantSelected(variantId: string): boolean {\n        return -1 < this.selectedVariantIds.indexOf(variantId);\n    }\n\n    editOption(option: ProductVariant.Options) {\n        this.modalService\n            .fromComponent(UpdateProductOptionDialogComponent, {\n                size: 'md',\n                locals: {\n                    productOption: option,\n                    activeLanguage: this.activeLanguage,\n                    customFields: this.customOptionFields,\n                },\n            })\n            .subscribe(result => {\n                if (result) {\n                    this.updateProductOption.emit(result);\n                }\n            });\n    }\n\n    private buildFormGroupMap() {\n        this.formGroupMap.clear();\n        for (const controlGroup of this.formArray.controls) {\n            this.formGroupMap.set(controlGroup.value.id, controlGroup as FormGroup);\n        }\n        this.changeDetector.markForCheck();\n    }\n\n    private getFacetValueIds(id: string): string[] {\n        const formValue: VariantFormValue = this.formGroupMap.get(id)?.value;\n        return formValue.facetValueIds;\n    }\n}\n","import {\n    ChangeDetectionStrategy,\n    ChangeDetectorRef,\n    Component,\n    Input,\n    OnDestroy,\n    OnInit,\n} from '@angular/core';\nimport { FormArray, FormGroup } from '@angular/forms';\nimport { Permission, ProductDetail, ProductVariant } from '@vendure/admin-ui/core';\nimport { Subscription } from 'rxjs';\nimport { debounceTime, distinctUntilChanged, map } from 'rxjs/operators';\n\nimport { PaginationConfig, SelectedAssets } from '../product-detail/product-detail.component';\n\n@Component({\n    selector: 'vdr-product-variants-table',\n    templateUrl: './product-variants-table.component.html',\n    styleUrls: ['./product-variants-table.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ProductVariantsTableComponent implements OnInit, OnDestroy {\n    @Input('productVariantsFormArray') formArray: FormArray;\n    @Input() variants: ProductVariant.Fragment[];\n    @Input() paginationConfig: PaginationConfig;\n    @Input() channelPriceIncludesTax: boolean;\n    @Input() optionGroups: ProductDetail.OptionGroups[];\n    @Input() pendingAssetChanges: { [variantId: string]: SelectedAssets };\n    formGroupMap = new Map<string, FormGroup>();\n    readonly updatePermission = [Permission.UpdateCatalog, Permission.UpdateProduct];\n    private subscription: Subscription;\n\n    constructor(private changeDetector: ChangeDetectorRef) {}\n\n    ngOnInit() {\n        this.subscription = this.formArray.valueChanges\n            .pipe(\n                map(value => value.length),\n                debounceTime(1),\n                distinctUntilChanged(),\n            )\n            .subscribe(() => {\n                this.buildFormGroupMap();\n            });\n\n        this.buildFormGroupMap();\n    }\n\n    ngOnDestroy() {\n        if (this.subscription) {\n            this.subscription.unsubscribe();\n        }\n    }\n\n    trackByFn(index: number, item: any) {\n        if ((item as any).id != null) {\n            return (item as any).id;\n        } else {\n            return index;\n        }\n    }\n\n    getFeaturedAsset(variant: ProductVariant.Fragment) {\n        return this.pendingAssetChanges[variant.id]?.featuredAsset || variant.featuredAsset;\n    }\n\n    optionGroupName(optionGroupId: string): string | undefined {\n        const group = this.optionGroups.find(g => g.id === optionGroupId);\n        return group && group.name;\n    }\n\n    private buildFormGroupMap() {\n        this.formGroupMap.clear();\n        for (const controlGroup of this.formArray.controls) {\n            this.formGroupMap.set(controlGroup.value.id, controlGroup as FormGroup);\n        }\n        this.changeDetector.markForCheck();\n    }\n}\n","import { ChangeDetectionStrategy, Component, Input, OnChanges, OnInit, SimpleChanges } from '@angular/core';\nimport { DataService } from '@vendure/admin-ui/core';\nimport { BehaviorSubject, combineLatest, Observable, Subject } from 'rxjs';\nimport { map } from 'rxjs/operators';\n\n@Component({\n    selector: 'vdr-variant-price-detail',\n    templateUrl: './variant-price-detail.component.html',\n    styleUrls: ['./variant-price-detail.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class VariantPriceDetailComponent implements OnInit, OnChanges {\n    @Input() priceIncludesTax: boolean;\n    @Input() price: number;\n    @Input() currencyCode: string;\n    @Input() taxCategoryId: string;\n\n    grossPrice$: Observable<number>;\n    taxRate$: Observable<number>;\n\n    private priceChange$ = new BehaviorSubject<number>(0);\n    private taxCategoryIdChange$ = new BehaviorSubject<string>('');\n\n    constructor(private dataService: DataService) {}\n\n    ngOnInit() {\n        const taxRates$ = this.dataService.settings\n            .getTaxRatesSimple(999, 0, 'cache-first')\n            .mapStream(data => data.taxRates.items);\n        const activeChannel$ = this.dataService.settings\n            .getActiveChannel('cache-first')\n            .refetchOnChannelChange()\n            .mapStream(data => data.activeChannel);\n\n        this.taxRate$ = combineLatest(activeChannel$, taxRates$, this.taxCategoryIdChange$).pipe(\n            map(([channel, taxRates, taxCategoryId]) => {\n                const defaultTaxZone = channel.defaultTaxZone;\n                if (!defaultTaxZone) {\n                    return 0;\n                }\n                const applicableRate = taxRates.find(\n                    taxRate => taxRate.zone.id === defaultTaxZone.id && taxRate.category.id === taxCategoryId,\n                );\n\n                if (!applicableRate) {\n                    return 0;\n                }\n                return applicableRate.value;\n            }),\n        );\n\n        this.grossPrice$ = combineLatest(this.taxRate$, this.priceChange$).pipe(\n            map(([taxRate, price]) => {\n                return Math.round(price * ((100 + taxRate) / 100));\n            }),\n        );\n    }\n\n    ngOnChanges(changes: SimpleChanges): void {\n        if ('price' in changes) {\n            this.priceChange$.next(changes.price.currentValue);\n        }\n        if ('taxCategoryId' in changes) {\n            this.taxCategoryIdChange$.next(changes.taxCategoryId.currentValue);\n        }\n    }\n}\n","import { NgModule } from '@angular/core';\nimport { RouterModule } from '@angular/router';\nimport { BulkActionRegistryService, SharedModule } from '@vendure/admin-ui/core';\n\nimport { catalogRoutes } from './catalog.routes';\nimport { ApplyFacetDialogComponent } from './components/apply-facet-dialog/apply-facet-dialog.component';\nimport { AssetDetailComponent } from './components/asset-detail/asset-detail.component';\nimport { AssetListComponent } from './components/asset-list/asset-list.component';\nimport { AssetsComponent } from './components/assets/assets.component';\nimport { AssignProductsToChannelDialogComponent } from './components/assign-products-to-channel-dialog/assign-products-to-channel-dialog.component';\nimport { AssignToChannelDialogComponent } from './components/assign-to-channel-dialog/assign-to-channel-dialog.component';\nimport { BulkAddFacetValuesDialogComponent } from './components/bulk-add-facet-values-dialog/bulk-add-facet-values-dialog.component';\nimport { CollectionContentsComponent } from './components/collection-contents/collection-contents.component';\nimport { CollectionDetailComponent } from './components/collection-detail/collection-detail.component';\nimport {\n    assignCollectionsToChannelBulkAction,\n    deleteCollectionsBulkAction,\n    removeCollectionsFromChannelBulkAction,\n} from './components/collection-list/collection-list-bulk-actions';\nimport { CollectionListComponent } from './components/collection-list/collection-list.component';\nimport { CollectionTreeNodeComponent } from './components/collection-tree/collection-tree-node.component';\nimport { CollectionTreeComponent } from './components/collection-tree/collection-tree.component';\nimport { ConfirmVariantDeletionDialogComponent } from './components/confirm-variant-deletion-dialog/confirm-variant-deletion-dialog.component';\nimport { FacetDetailComponent } from './components/facet-detail/facet-detail.component';\nimport {\n    assignFacetsToChannelBulkAction,\n    deleteFacetsBulkAction,\n    removeFacetsFromChannelBulkAction,\n} from './components/facet-list/facet-list-bulk-actions';\nimport { FacetListComponent } from './components/facet-list/facet-list.component';\nimport { GenerateProductVariantsComponent } from './components/generate-product-variants/generate-product-variants.component';\nimport { OptionValueInputComponent } from './components/option-value-input/option-value-input.component';\nimport { ProductDetailComponent } from './components/product-detail/product-detail.component';\nimport {\n    assignFacetValuesToProductsBulkAction,\n    assignProductsToChannelBulkAction,\n    deleteProductsBulkAction,\n    removeProductsFromChannelBulkAction,\n} from './components/product-list/product-list-bulk-actions';\nimport { ProductListComponent } from './components/product-list/product-list.component';\nimport { ProductOptionsEditorComponent } from './components/product-options-editor/product-options-editor.component';\nimport { ProductVariantsEditorComponent } from './components/product-variants-editor/product-variants-editor.component';\nimport { ProductVariantsListComponent } from './components/product-variants-list/product-variants-list.component';\nimport { ProductVariantsTableComponent } from './components/product-variants-table/product-variants-table.component';\nimport { UpdateProductOptionDialogComponent } from './components/update-product-option-dialog/update-product-option-dialog.component';\nimport { VariantPriceDetailComponent } from './components/variant-price-detail/variant-price-detail.component';\n\nconst CATALOG_COMPONENTS = [\n    ProductListComponent,\n    ProductDetailComponent,\n    FacetListComponent,\n    FacetDetailComponent,\n    GenerateProductVariantsComponent,\n    ProductVariantsListComponent,\n    ApplyFacetDialogComponent,\n    AssetListComponent,\n    AssetsComponent,\n    VariantPriceDetailComponent,\n    CollectionListComponent,\n    CollectionDetailComponent,\n    CollectionTreeComponent,\n    CollectionTreeNodeComponent,\n    CollectionContentsComponent,\n    ProductVariantsTableComponent,\n    OptionValueInputComponent,\n    UpdateProductOptionDialogComponent,\n    ProductVariantsEditorComponent,\n    AssignProductsToChannelDialogComponent,\n    AssetDetailComponent,\n    ConfirmVariantDeletionDialogComponent,\n    ProductOptionsEditorComponent,\n    BulkAddFacetValuesDialogComponent,\n    AssignToChannelDialogComponent,\n];\n\n@NgModule({\n    imports: [SharedModule, RouterModule.forChild(catalogRoutes)],\n    exports: [...CATALOG_COMPONENTS],\n    declarations: [...CATALOG_COMPONENTS],\n})\nexport class CatalogModule {\n    constructor(private bulkActionRegistryService: BulkActionRegistryService) {\n        bulkActionRegistryService.registerBulkAction(assignFacetValuesToProductsBulkAction);\n        bulkActionRegistryService.registerBulkAction(assignProductsToChannelBulkAction);\n        bulkActionRegistryService.registerBulkAction(removeProductsFromChannelBulkAction);\n        bulkActionRegistryService.registerBulkAction(deleteProductsBulkAction);\n\n        bulkActionRegistryService.registerBulkAction(assignFacetsToChannelBulkAction);\n        bulkActionRegistryService.registerBulkAction(removeFacetsFromChannelBulkAction);\n        bulkActionRegistryService.registerBulkAction(deleteFacetsBulkAction);\n\n        bulkActionRegistryService.registerBulkAction(assignCollectionsToChannelBulkAction);\n        bulkActionRegistryService.registerBulkAction(removeCollectionsFromChannelBulkAction);\n        bulkActionRegistryService.registerBulkAction(deleteCollectionsBulkAction);\n    }\n}\n","// This file was generated by the build-public-api.ts script\nexport * from './catalog.module';\nexport * from './catalog.routes';\nexport * from './components/apply-facet-dialog/apply-facet-dialog.component';\nexport * from './components/asset-detail/asset-detail.component';\nexport * from './components/asset-list/asset-list.component';\nexport * from './components/assets/assets.component';\nexport * from './components/assign-products-to-channel-dialog/assign-products-to-channel-dialog.component';\nexport * from './components/assign-to-channel-dialog/assign-to-channel-dialog.component';\nexport * from './components/bulk-add-facet-values-dialog/bulk-add-facet-values-dialog.component';\nexport * from './components/bulk-add-facet-values-dialog/bulk-add-facet-values-dialog.graphql';\nexport * from './components/collection-contents/collection-contents.component';\nexport * from './components/collection-detail/collection-detail.component';\nexport * from './components/collection-list/collection-list-bulk-actions';\nexport * from './components/collection-list/collection-list.component';\nexport * from './components/collection-tree/array-to-tree';\nexport * from './components/collection-tree/collection-tree-node.component';\nexport * from './components/collection-tree/collection-tree.component';\nexport * from './components/confirm-variant-deletion-dialog/confirm-variant-deletion-dialog.component';\nexport * from './components/facet-detail/facet-detail.component';\nexport * from './components/facet-list/facet-list-bulk-actions';\nexport * from './components/facet-list/facet-list.component';\nexport * from './components/generate-product-variants/generate-product-variants.component';\nexport * from './components/option-value-input/option-value-input.component';\nexport * from './components/product-detail/product-detail.component';\nexport * from './components/product-list/product-list-bulk-actions';\nexport * from './components/product-list/product-list.component';\nexport * from './components/product-options-editor/product-options-editor.component';\nexport * from './components/product-variants-editor/product-variants-editor.component';\nexport * from './components/product-variants-list/product-variants-list.component';\nexport * from './components/product-variants-table/product-variants-table.component';\nexport * from './components/update-product-option-dialog/update-product-option-dialog.component';\nexport * from './components/variant-price-detail/variant-price-detail.component';\nexport * from './providers/product-detail/product-detail.service';\nexport * from './providers/product-detail/replace-last';\nexport * from './providers/routing/asset-resolver';\nexport * from './providers/routing/collection-resolver';\nexport * from './providers/routing/facet-resolver';\nexport * from './providers/routing/product-resolver';\nexport * from './providers/routing/product-variants-resolver';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":["FormGroup","FormControl","_","BaseDetailComponent","Component","ChangeDetectionStrategy","Router","ActivatedRoute","ServerConfigService","NotificationService","DataService","FormBuilder","BehaviorSubject","SortOrder","LogicalOperator","combineLatest","map","debounceTime","takeUntil","finalize","switchMap","DeletionResult","EMPTY","BaseListComponent","ModalService","Permission","Subject","Validators","unicodePatternValidator","merge","filter","of","take","findTranslation","normalizeString","getConfigArgValue","mergeMap","createUpdatedTranslatable","encodeConfigArgValue","ChangeDetectorRef","LocalStorageService","ViewChild","SelectionManager","tap","shareReplay","distinctUntilChanged","mapTo","forkJoin","notNullOrUndefined","throwError","Injectable","FacetValueSelectorComponent","from","startWith","skipUntil","skip","flattenFacetValues","DEFAULT_CHANNEL_CODE","getChannelCodeFromUserStatus","unique","withLatestFrom","Location","delay","JobState","JobQueueService","FormArray","getDefaultUiLanguage","generateAllCombinations","pick","defaultIfEmpty","AssetType","BaseEntityResolver","createResolveData","CanDeactivateDetailGuard","detailBreadcrumb","EventEmitter","AssetPickerDialogComponent","AssetPreviewDialogComponent","moveItemInArray","Input","HostBinding","Output","gql","catchError","ContentChild","TemplateRef","isMultiChannel","currentChannelIsNotDefault","SkipSelf","Optional","ViewChildren","ElementRef","NG_VALUE_ACCESSOR","forwardRef","GlobalFlag","NgModule","SharedModule","RouterModule","BulkActionRegistryService"],"mappings":"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"}