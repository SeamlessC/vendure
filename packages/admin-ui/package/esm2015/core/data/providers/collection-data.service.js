import { pick } from '@vendure/common/lib/pick';
import { from } from 'rxjs';
import { bufferCount, concatMap } from 'rxjs/operators';
import { ASSIGN_COLLECTIONS_TO_CHANNEL, CREATE_COLLECTION, DELETE_COLLECTION, DELETE_COLLECTIONS, GET_COLLECTION, GET_COLLECTION_CONTENTS, GET_COLLECTION_FILTERS, GET_COLLECTION_LIST, MOVE_COLLECTION, PREVIEW_COLLECTION_CONTENTS, REMOVE_COLLECTIONS_FROM_CHANNEL, UPDATE_COLLECTION, } from '../definitions/collection-definitions';
export class CollectionDataService {
    constructor(baseDataService) {
        this.baseDataService = baseDataService;
    }
    getCollectionFilters() {
        return this.baseDataService.query(GET_COLLECTION_FILTERS);
    }
    getCollections(take = 10, skip = 0) {
        return this.baseDataService.query(GET_COLLECTION_LIST, {
            options: {
                take,
                skip,
            },
        });
    }
    getCollection(id) {
        return this.baseDataService.query(GET_COLLECTION, {
            id,
        });
    }
    createCollection(input) {
        return this.baseDataService.mutate(CREATE_COLLECTION, {
            input: pick(input, [
                'translations',
                'parentId',
                'assetIds',
                'featuredAssetId',
                'filters',
                'customFields',
            ]),
        });
    }
    updateCollection(input) {
        return this.baseDataService.mutate(UPDATE_COLLECTION, {
            input: pick(input, [
                'id',
                'isPrivate',
                'translations',
                'assetIds',
                'featuredAssetId',
                'filters',
                'customFields',
            ]),
        });
    }
    moveCollection(inputs) {
        return from(inputs).pipe(concatMap(input => this.baseDataService.mutate(MOVE_COLLECTION, { input })), bufferCount(inputs.length));
    }
    deleteCollection(id) {
        return this.baseDataService.mutate(DELETE_COLLECTION, {
            id,
        });
    }
    deleteCollections(ids) {
        return this.baseDataService.mutate(DELETE_COLLECTIONS, {
            ids,
        });
    }
    previewCollectionVariants(input, options) {
        return this.baseDataService.query(PREVIEW_COLLECTION_CONTENTS, { input, options });
    }
    getCollectionContents(id, take = 10, skip = 0, filterTerm) {
        const filter = filterTerm
            ? { name: { contains: filterTerm } }
            : undefined;
        return this.baseDataService.query(GET_COLLECTION_CONTENTS, {
            id,
            options: {
                skip,
                take,
                filter,
            },
        });
    }
    assignCollectionsToChannel(input) {
        return this.baseDataService.mutate(ASSIGN_COLLECTIONS_TO_CHANNEL, {
            input,
        });
    }
    removeCollectionsFromChannel(input) {
        return this.baseDataService.mutate(REMOVE_COLLECTIONS_FROM_CHANNEL, {
            input,
        });
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29sbGVjdGlvbi1kYXRhLnNlcnZpY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvbGliL2NvcmUvc3JjL2RhdGEvcHJvdmlkZXJzL2NvbGxlY3Rpb24tZGF0YS5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUNoRCxPQUFPLEVBQUUsSUFBSSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQzVCLE9BQU8sRUFBRSxXQUFXLEVBQUUsU0FBUyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUE0QnhELE9BQU8sRUFDSCw2QkFBNkIsRUFDN0IsaUJBQWlCLEVBQ2pCLGlCQUFpQixFQUNqQixrQkFBa0IsRUFDbEIsY0FBYyxFQUNkLHVCQUF1QixFQUN2QixzQkFBc0IsRUFDdEIsbUJBQW1CLEVBQ25CLGVBQWUsRUFDZiwyQkFBMkIsRUFDM0IsK0JBQStCLEVBQy9CLGlCQUFpQixHQUNwQixNQUFNLHVDQUF1QyxDQUFDO0FBSS9DLE1BQU0sT0FBTyxxQkFBcUI7SUFDOUIsWUFBb0IsZUFBZ0M7UUFBaEMsb0JBQWUsR0FBZixlQUFlLENBQWlCO0lBQUcsQ0FBQztJQUV4RCxvQkFBb0I7UUFDaEIsT0FBTyxJQUFJLENBQUMsZUFBZSxDQUFDLEtBQUssQ0FBNkIsc0JBQXNCLENBQUMsQ0FBQztJQUMxRixDQUFDO0lBRUQsY0FBYyxDQUFDLE9BQWUsRUFBRSxFQUFFLE9BQWUsQ0FBQztRQUM5QyxPQUFPLElBQUksQ0FBQyxlQUFlLENBQUMsS0FBSyxDQUM3QixtQkFBbUIsRUFDbkI7WUFDSSxPQUFPLEVBQUU7Z0JBQ0wsSUFBSTtnQkFDSixJQUFJO2FBQ1A7U0FDSixDQUNKLENBQUM7SUFDTixDQUFDO0lBRUQsYUFBYSxDQUFDLEVBQVU7UUFDcEIsT0FBTyxJQUFJLENBQUMsZUFBZSxDQUFDLEtBQUssQ0FBK0MsY0FBYyxFQUFFO1lBQzVGLEVBQUU7U0FDTCxDQUFDLENBQUM7SUFDUCxDQUFDO0lBRUQsZ0JBQWdCLENBQUMsS0FBNEI7UUFDekMsT0FBTyxJQUFJLENBQUMsZUFBZSxDQUFDLE1BQU0sQ0FDOUIsaUJBQWlCLEVBQ2pCO1lBQ0ksS0FBSyxFQUFFLElBQUksQ0FBQyxLQUFLLEVBQUU7Z0JBQ2YsY0FBYztnQkFDZCxVQUFVO2dCQUNWLFVBQVU7Z0JBQ1YsaUJBQWlCO2dCQUNqQixTQUFTO2dCQUNULGNBQWM7YUFDakIsQ0FBQztTQUNMLENBQ0osQ0FBQztJQUNOLENBQUM7SUFFRCxnQkFBZ0IsQ0FBQyxLQUE0QjtRQUN6QyxPQUFPLElBQUksQ0FBQyxlQUFlLENBQUMsTUFBTSxDQUM5QixpQkFBaUIsRUFDakI7WUFDSSxLQUFLLEVBQUUsSUFBSSxDQUFDLEtBQUssRUFBRTtnQkFDZixJQUFJO2dCQUNKLFdBQVc7Z0JBQ1gsY0FBYztnQkFDZCxVQUFVO2dCQUNWLGlCQUFpQjtnQkFDakIsU0FBUztnQkFDVCxjQUFjO2FBQ2pCLENBQUM7U0FDTCxDQUNKLENBQUM7SUFDTixDQUFDO0lBRUQsY0FBYyxDQUFDLE1BQTZCO1FBQ3hDLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FDcEIsU0FBUyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQ2QsSUFBSSxDQUFDLGVBQWUsQ0FBQyxNQUFNLENBQ3ZCLGVBQWUsRUFDZixFQUFFLEtBQUssRUFBRSxDQUNaLENBQ0osRUFDRCxXQUFXLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUM3QixDQUFDO0lBQ04sQ0FBQztJQUVELGdCQUFnQixDQUFDLEVBQVU7UUFDdkIsT0FBTyxJQUFJLENBQUMsZUFBZSxDQUFDLE1BQU0sQ0FDOUIsaUJBQWlCLEVBQ2pCO1lBQ0ksRUFBRTtTQUNMLENBQ0osQ0FBQztJQUNOLENBQUM7SUFFRCxpQkFBaUIsQ0FBQyxHQUFhO1FBQzNCLE9BQU8sSUFBSSxDQUFDLGVBQWUsQ0FBQyxNQUFNLENBQzlCLGtCQUFrQixFQUNsQjtZQUNJLEdBQUc7U0FDTixDQUNKLENBQUM7SUFDTixDQUFDO0lBRUQseUJBQXlCLENBQUMsS0FBcUMsRUFBRSxPQUFrQztRQUMvRixPQUFPLElBQUksQ0FBQyxlQUFlLENBQUMsS0FBSyxDQUcvQiwyQkFBMkIsRUFBRSxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUUsQ0FBQyxDQUFDO0lBQ3ZELENBQUM7SUFFRCxxQkFBcUIsQ0FBQyxFQUFVLEVBQUUsT0FBZSxFQUFFLEVBQUUsT0FBZSxDQUFDLEVBQUUsVUFBbUI7UUFDdEYsTUFBTSxNQUFNLEdBQUcsVUFBVTtZQUNyQixDQUFDLENBQUUsRUFBRSxJQUFJLEVBQUUsRUFBRSxRQUFRLEVBQUUsVUFBVSxFQUFFLEVBQWdDO1lBQ25FLENBQUMsQ0FBQyxTQUFTLENBQUM7UUFDaEIsT0FBTyxJQUFJLENBQUMsZUFBZSxDQUFDLEtBQUssQ0FDN0IsdUJBQXVCLEVBQ3ZCO1lBQ0ksRUFBRTtZQUNGLE9BQU8sRUFBRTtnQkFDTCxJQUFJO2dCQUNKLElBQUk7Z0JBQ0osTUFBTTthQUNUO1NBQ0osQ0FDSixDQUFDO0lBQ04sQ0FBQztJQUVELDBCQUEwQixDQUFDLEtBQXNDO1FBQzdELE9BQU8sSUFBSSxDQUFDLGVBQWUsQ0FBQyxNQUFNLENBR2hDLDZCQUE2QixFQUFFO1lBQzdCLEtBQUs7U0FDUixDQUFDLENBQUM7SUFDUCxDQUFDO0lBRUQsNEJBQTRCLENBQUMsS0FBd0M7UUFDakUsT0FBTyxJQUFJLENBQUMsZUFBZSxDQUFDLE1BQU0sQ0FHaEMsK0JBQStCLEVBQUU7WUFDL0IsS0FBSztTQUNSLENBQUMsQ0FBQztJQUNQLENBQUM7Q0FDSiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHBpY2sgfSBmcm9tICdAdmVuZHVyZS9jb21tb24vbGliL3BpY2snO1xuaW1wb3J0IHsgZnJvbSB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgYnVmZmVyQ291bnQsIGNvbmNhdE1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcblxuaW1wb3J0IHtcbiAgICBBc3NpZ25Db2xsZWN0aW9uc1RvQ2hhbm5lbElucHV0LFxuICAgIEFzc2lnbkNvbGxlY3Rpb25zVG9DaGFubmVsTXV0YXRpb24sXG4gICAgQXNzaWduQ29sbGVjdGlvbnNUb0NoYW5uZWxNdXRhdGlvblZhcmlhYmxlcyxcbiAgICBDb2xsZWN0aW9uRmlsdGVyUGFyYW1ldGVyLFxuICAgIENyZWF0ZUNvbGxlY3Rpb24sXG4gICAgQ3JlYXRlQ29sbGVjdGlvbklucHV0LFxuICAgIERlbGV0ZUNvbGxlY3Rpb24sXG4gICAgRGVsZXRlQ29sbGVjdGlvbnNNdXRhdGlvbixcbiAgICBEZWxldGVDb2xsZWN0aW9uc011dGF0aW9uVmFyaWFibGVzLFxuICAgIEdldENvbGxlY3Rpb24sXG4gICAgR2V0Q29sbGVjdGlvbkNvbnRlbnRzLFxuICAgIEdldENvbGxlY3Rpb25GaWx0ZXJzLFxuICAgIEdldENvbGxlY3Rpb25MaXN0LFxuICAgIE1vdmVDb2xsZWN0aW9uLFxuICAgIE1vdmVDb2xsZWN0aW9uSW5wdXQsXG4gICAgUHJldmlld0NvbGxlY3Rpb25Db250ZW50c1F1ZXJ5LFxuICAgIFByZXZpZXdDb2xsZWN0aW9uQ29udGVudHNRdWVyeVZhcmlhYmxlcyxcbiAgICBQcmV2aWV3Q29sbGVjdGlvblZhcmlhbnRzSW5wdXQsXG4gICAgUHJvZHVjdFZhcmlhbnRMaXN0T3B0aW9ucyxcbiAgICBSZW1vdmVDb2xsZWN0aW9uc0Zyb21DaGFubmVsSW5wdXQsXG4gICAgUmVtb3ZlQ29sbGVjdGlvbnNGcm9tQ2hhbm5lbE11dGF0aW9uLFxuICAgIFJlbW92ZUNvbGxlY3Rpb25zRnJvbUNoYW5uZWxNdXRhdGlvblZhcmlhYmxlcyxcbiAgICBVcGRhdGVDb2xsZWN0aW9uLFxuICAgIFVwZGF0ZUNvbGxlY3Rpb25JbnB1dCxcbn0gZnJvbSAnLi4vLi4vY29tbW9uL2dlbmVyYXRlZC10eXBlcyc7XG5pbXBvcnQge1xuICAgIEFTU0lHTl9DT0xMRUNUSU9OU19UT19DSEFOTkVMLFxuICAgIENSRUFURV9DT0xMRUNUSU9OLFxuICAgIERFTEVURV9DT0xMRUNUSU9OLFxuICAgIERFTEVURV9DT0xMRUNUSU9OUyxcbiAgICBHRVRfQ09MTEVDVElPTixcbiAgICBHRVRfQ09MTEVDVElPTl9DT05URU5UUyxcbiAgICBHRVRfQ09MTEVDVElPTl9GSUxURVJTLFxuICAgIEdFVF9DT0xMRUNUSU9OX0xJU1QsXG4gICAgTU9WRV9DT0xMRUNUSU9OLFxuICAgIFBSRVZJRVdfQ09MTEVDVElPTl9DT05URU5UUyxcbiAgICBSRU1PVkVfQ09MTEVDVElPTlNfRlJPTV9DSEFOTkVMLFxuICAgIFVQREFURV9DT0xMRUNUSU9OLFxufSBmcm9tICcuLi9kZWZpbml0aW9ucy9jb2xsZWN0aW9uLWRlZmluaXRpb25zJztcblxuaW1wb3J0IHsgQmFzZURhdGFTZXJ2aWNlIH0gZnJvbSAnLi9iYXNlLWRhdGEuc2VydmljZSc7XG5cbmV4cG9ydCBjbGFzcyBDb2xsZWN0aW9uRGF0YVNlcnZpY2Uge1xuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgYmFzZURhdGFTZXJ2aWNlOiBCYXNlRGF0YVNlcnZpY2UpIHt9XG5cbiAgICBnZXRDb2xsZWN0aW9uRmlsdGVycygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmFzZURhdGFTZXJ2aWNlLnF1ZXJ5PEdldENvbGxlY3Rpb25GaWx0ZXJzLlF1ZXJ5PihHRVRfQ09MTEVDVElPTl9GSUxURVJTKTtcbiAgICB9XG5cbiAgICBnZXRDb2xsZWN0aW9ucyh0YWtlOiBudW1iZXIgPSAxMCwgc2tpcDogbnVtYmVyID0gMCkge1xuICAgICAgICByZXR1cm4gdGhpcy5iYXNlRGF0YVNlcnZpY2UucXVlcnk8R2V0Q29sbGVjdGlvbkxpc3QuUXVlcnksIEdldENvbGxlY3Rpb25MaXN0LlZhcmlhYmxlcz4oXG4gICAgICAgICAgICBHRVRfQ09MTEVDVElPTl9MSVNULFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFrZSxcbiAgICAgICAgICAgICAgICAgICAgc2tpcCxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBnZXRDb2xsZWN0aW9uKGlkOiBzdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmFzZURhdGFTZXJ2aWNlLnF1ZXJ5PEdldENvbGxlY3Rpb24uUXVlcnksIEdldENvbGxlY3Rpb24uVmFyaWFibGVzPihHRVRfQ09MTEVDVElPTiwge1xuICAgICAgICAgICAgaWQsXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGNyZWF0ZUNvbGxlY3Rpb24oaW5wdXQ6IENyZWF0ZUNvbGxlY3Rpb25JbnB1dCkge1xuICAgICAgICByZXR1cm4gdGhpcy5iYXNlRGF0YVNlcnZpY2UubXV0YXRlPENyZWF0ZUNvbGxlY3Rpb24uTXV0YXRpb24sIENyZWF0ZUNvbGxlY3Rpb24uVmFyaWFibGVzPihcbiAgICAgICAgICAgIENSRUFURV9DT0xMRUNUSU9OLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlucHV0OiBwaWNrKGlucHV0LCBbXG4gICAgICAgICAgICAgICAgICAgICd0cmFuc2xhdGlvbnMnLFxuICAgICAgICAgICAgICAgICAgICAncGFyZW50SWQnLFxuICAgICAgICAgICAgICAgICAgICAnYXNzZXRJZHMnLFxuICAgICAgICAgICAgICAgICAgICAnZmVhdHVyZWRBc3NldElkJyxcbiAgICAgICAgICAgICAgICAgICAgJ2ZpbHRlcnMnLFxuICAgICAgICAgICAgICAgICAgICAnY3VzdG9tRmllbGRzJyxcbiAgICAgICAgICAgICAgICBdKSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgdXBkYXRlQ29sbGVjdGlvbihpbnB1dDogVXBkYXRlQ29sbGVjdGlvbklucHV0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJhc2VEYXRhU2VydmljZS5tdXRhdGU8VXBkYXRlQ29sbGVjdGlvbi5NdXRhdGlvbiwgVXBkYXRlQ29sbGVjdGlvbi5WYXJpYWJsZXM+KFxuICAgICAgICAgICAgVVBEQVRFX0NPTExFQ1RJT04sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaW5wdXQ6IHBpY2soaW5wdXQsIFtcbiAgICAgICAgICAgICAgICAgICAgJ2lkJyxcbiAgICAgICAgICAgICAgICAgICAgJ2lzUHJpdmF0ZScsXG4gICAgICAgICAgICAgICAgICAgICd0cmFuc2xhdGlvbnMnLFxuICAgICAgICAgICAgICAgICAgICAnYXNzZXRJZHMnLFxuICAgICAgICAgICAgICAgICAgICAnZmVhdHVyZWRBc3NldElkJyxcbiAgICAgICAgICAgICAgICAgICAgJ2ZpbHRlcnMnLFxuICAgICAgICAgICAgICAgICAgICAnY3VzdG9tRmllbGRzJyxcbiAgICAgICAgICAgICAgICBdKSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgbW92ZUNvbGxlY3Rpb24oaW5wdXRzOiBNb3ZlQ29sbGVjdGlvbklucHV0W10pIHtcbiAgICAgICAgcmV0dXJuIGZyb20oaW5wdXRzKS5waXBlKFxuICAgICAgICAgICAgY29uY2F0TWFwKGlucHV0ID0+XG4gICAgICAgICAgICAgICAgdGhpcy5iYXNlRGF0YVNlcnZpY2UubXV0YXRlPE1vdmVDb2xsZWN0aW9uLk11dGF0aW9uLCBNb3ZlQ29sbGVjdGlvbi5WYXJpYWJsZXM+KFxuICAgICAgICAgICAgICAgICAgICBNT1ZFX0NPTExFQ1RJT04sXG4gICAgICAgICAgICAgICAgICAgIHsgaW5wdXQgfSxcbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIGJ1ZmZlckNvdW50KGlucHV0cy5sZW5ndGgpLFxuICAgICAgICApO1xuICAgIH1cblxuICAgIGRlbGV0ZUNvbGxlY3Rpb24oaWQ6IHN0cmluZykge1xuICAgICAgICByZXR1cm4gdGhpcy5iYXNlRGF0YVNlcnZpY2UubXV0YXRlPERlbGV0ZUNvbGxlY3Rpb24uTXV0YXRpb24sIERlbGV0ZUNvbGxlY3Rpb24uVmFyaWFibGVzPihcbiAgICAgICAgICAgIERFTEVURV9DT0xMRUNUSU9OLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlkLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBkZWxldGVDb2xsZWN0aW9ucyhpZHM6IHN0cmluZ1tdKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJhc2VEYXRhU2VydmljZS5tdXRhdGU8RGVsZXRlQ29sbGVjdGlvbnNNdXRhdGlvbiwgRGVsZXRlQ29sbGVjdGlvbnNNdXRhdGlvblZhcmlhYmxlcz4oXG4gICAgICAgICAgICBERUxFVEVfQ09MTEVDVElPTlMsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWRzLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBwcmV2aWV3Q29sbGVjdGlvblZhcmlhbnRzKGlucHV0OiBQcmV2aWV3Q29sbGVjdGlvblZhcmlhbnRzSW5wdXQsIG9wdGlvbnM6IFByb2R1Y3RWYXJpYW50TGlzdE9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmFzZURhdGFTZXJ2aWNlLnF1ZXJ5PFxuICAgICAgICAgICAgUHJldmlld0NvbGxlY3Rpb25Db250ZW50c1F1ZXJ5LFxuICAgICAgICAgICAgUHJldmlld0NvbGxlY3Rpb25Db250ZW50c1F1ZXJ5VmFyaWFibGVzXG4gICAgICAgID4oUFJFVklFV19DT0xMRUNUSU9OX0NPTlRFTlRTLCB7IGlucHV0LCBvcHRpb25zIH0pO1xuICAgIH1cblxuICAgIGdldENvbGxlY3Rpb25Db250ZW50cyhpZDogc3RyaW5nLCB0YWtlOiBudW1iZXIgPSAxMCwgc2tpcDogbnVtYmVyID0gMCwgZmlsdGVyVGVybT86IHN0cmluZykge1xuICAgICAgICBjb25zdCBmaWx0ZXIgPSBmaWx0ZXJUZXJtXG4gICAgICAgICAgICA/ICh7IG5hbWU6IHsgY29udGFpbnM6IGZpbHRlclRlcm0gfSB9IGFzIENvbGxlY3Rpb25GaWx0ZXJQYXJhbWV0ZXIpXG4gICAgICAgICAgICA6IHVuZGVmaW5lZDtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmFzZURhdGFTZXJ2aWNlLnF1ZXJ5PEdldENvbGxlY3Rpb25Db250ZW50cy5RdWVyeSwgR2V0Q29sbGVjdGlvbkNvbnRlbnRzLlZhcmlhYmxlcz4oXG4gICAgICAgICAgICBHRVRfQ09MTEVDVElPTl9DT05URU5UUyxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZCxcbiAgICAgICAgICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgICAgICAgICAgIHNraXAsXG4gICAgICAgICAgICAgICAgICAgIHRha2UsXG4gICAgICAgICAgICAgICAgICAgIGZpbHRlcixcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBhc3NpZ25Db2xsZWN0aW9uc1RvQ2hhbm5lbChpbnB1dDogQXNzaWduQ29sbGVjdGlvbnNUb0NoYW5uZWxJbnB1dCkge1xuICAgICAgICByZXR1cm4gdGhpcy5iYXNlRGF0YVNlcnZpY2UubXV0YXRlPFxuICAgICAgICAgICAgQXNzaWduQ29sbGVjdGlvbnNUb0NoYW5uZWxNdXRhdGlvbixcbiAgICAgICAgICAgIEFzc2lnbkNvbGxlY3Rpb25zVG9DaGFubmVsTXV0YXRpb25WYXJpYWJsZXNcbiAgICAgICAgPihBU1NJR05fQ09MTEVDVElPTlNfVE9fQ0hBTk5FTCwge1xuICAgICAgICAgICAgaW5wdXQsXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHJlbW92ZUNvbGxlY3Rpb25zRnJvbUNoYW5uZWwoaW5wdXQ6IFJlbW92ZUNvbGxlY3Rpb25zRnJvbUNoYW5uZWxJbnB1dCkge1xuICAgICAgICByZXR1cm4gdGhpcy5iYXNlRGF0YVNlcnZpY2UubXV0YXRlPFxuICAgICAgICAgICAgUmVtb3ZlQ29sbGVjdGlvbnNGcm9tQ2hhbm5lbE11dGF0aW9uLFxuICAgICAgICAgICAgUmVtb3ZlQ29sbGVjdGlvbnNGcm9tQ2hhbm5lbE11dGF0aW9uVmFyaWFibGVzXG4gICAgICAgID4oUkVNT1ZFX0NPTExFQ1RJT05TX0ZST01fQ0hBTk5FTCwge1xuICAgICAgICAgICAgaW5wdXQsXG4gICAgICAgIH0pO1xuICAgIH1cbn1cbiJdfQ==