import { LogicalOperator, } from '../../common/generated-types';
import { ADD_CUSTOMERS_TO_GROUP, ADD_NOTE_TO_CUSTOMER, CREATE_CUSTOMER, CREATE_CUSTOMER_ADDRESS, CREATE_CUSTOMER_GROUP, DELETE_CUSTOMER, DELETE_CUSTOMER_ADDRESS, DELETE_CUSTOMER_GROUP, DELETE_CUSTOMER_NOTE, GET_CUSTOMER, GET_CUSTOMER_GROUP_WITH_CUSTOMERS, GET_CUSTOMER_GROUPS, GET_CUSTOMER_HISTORY, GET_CUSTOMER_LIST, REMOVE_CUSTOMERS_FROM_GROUP, UPDATE_CUSTOMER, UPDATE_CUSTOMER_ADDRESS, UPDATE_CUSTOMER_GROUP, UPDATE_CUSTOMER_NOTE, } from '../definitions/customer-definitions';
export class CustomerDataService {
    constructor(baseDataService) {
        this.baseDataService = baseDataService;
    }
    getCustomerList(take = 10, skip = 0, filterTerm) {
        const filter = filterTerm
            ? {
                filter: {
                    emailAddress: {
                        contains: filterTerm,
                    },
                    lastName: {
                        contains: filterTerm,
                    },
                },
            }
            : {};
        return this.baseDataService.query(GET_CUSTOMER_LIST, {
            options: Object.assign(Object.assign({ take,
                skip }, filter), { filterOperator: LogicalOperator.OR }),
        });
    }
    getCustomer(id, orderListOptions) {
        return this.baseDataService.query(GET_CUSTOMER, {
            id,
            orderListOptions,
        });
    }
    createCustomer(input, password) {
        return this.baseDataService.mutate(CREATE_CUSTOMER, {
            input,
            password,
        });
    }
    updateCustomer(input) {
        return this.baseDataService.mutate(UPDATE_CUSTOMER, {
            input,
        });
    }
    deleteCustomer(id) {
        return this.baseDataService.mutate(DELETE_CUSTOMER, { id });
    }
    createCustomerAddress(customerId, input) {
        return this.baseDataService.mutate(CREATE_CUSTOMER_ADDRESS, {
            customerId,
            input,
        });
    }
    updateCustomerAddress(input) {
        return this.baseDataService.mutate(UPDATE_CUSTOMER_ADDRESS, {
            input,
        });
    }
    deleteCustomerAddress(id) {
        return this.baseDataService.mutate(DELETE_CUSTOMER_ADDRESS, { id });
    }
    createCustomerGroup(input) {
        return this.baseDataService.mutate(CREATE_CUSTOMER_GROUP, {
            input,
        });
    }
    updateCustomerGroup(input) {
        return this.baseDataService.mutate(UPDATE_CUSTOMER_GROUP, {
            input,
        });
    }
    deleteCustomerGroup(id) {
        return this.baseDataService.mutate(DELETE_CUSTOMER_GROUP, { id });
    }
    getCustomerGroupList(options) {
        return this.baseDataService.query(GET_CUSTOMER_GROUPS, {
            options,
        });
    }
    getCustomerGroupWithCustomers(id, options) {
        return this.baseDataService.query(GET_CUSTOMER_GROUP_WITH_CUSTOMERS, {
            id,
            options,
        });
    }
    addCustomersToGroup(groupId, customerIds) {
        return this.baseDataService.mutate(ADD_CUSTOMERS_TO_GROUP, {
            groupId,
            customerIds,
        });
    }
    removeCustomersFromGroup(groupId, customerIds) {
        return this.baseDataService.mutate(REMOVE_CUSTOMERS_FROM_GROUP, {
            groupId,
            customerIds,
        });
    }
    getCustomerHistory(id, options) {
        return this.baseDataService.query(GET_CUSTOMER_HISTORY, {
            id,
            options,
        });
    }
    addNoteToCustomer(customerId, note) {
        return this.baseDataService.mutate(ADD_NOTE_TO_CUSTOMER, {
            input: {
                note,
                isPublic: false,
                id: customerId,
            },
        });
    }
    updateCustomerNote(input) {
        return this.baseDataService.mutate(UPDATE_CUSTOMER_NOTE, {
            input,
        });
    }
    deleteCustomerNote(id) {
        return this.baseDataService.mutate(DELETE_CUSTOMER_NOTE, {
            id,
        });
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3VzdG9tZXItZGF0YS5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc3JjL2xpYi9jb3JlL3NyYy9kYXRhL3Byb3ZpZGVycy9jdXN0b21lci1kYXRhLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQXFCSCxlQUFlLEdBV2xCLE1BQU0sOEJBQThCLENBQUM7QUFDdEMsT0FBTyxFQUNILHNCQUFzQixFQUN0QixvQkFBb0IsRUFDcEIsZUFBZSxFQUNmLHVCQUF1QixFQUN2QixxQkFBcUIsRUFDckIsZUFBZSxFQUNmLHVCQUF1QixFQUN2QixxQkFBcUIsRUFDckIsb0JBQW9CLEVBQ3BCLFlBQVksRUFDWixpQ0FBaUMsRUFDakMsbUJBQW1CLEVBQ25CLG9CQUFvQixFQUNwQixpQkFBaUIsRUFDakIsMkJBQTJCLEVBQzNCLGVBQWUsRUFDZix1QkFBdUIsRUFDdkIscUJBQXFCLEVBQ3JCLG9CQUFvQixHQUN2QixNQUFNLHFDQUFxQyxDQUFDO0FBSTdDLE1BQU0sT0FBTyxtQkFBbUI7SUFDNUIsWUFBb0IsZUFBZ0M7UUFBaEMsb0JBQWUsR0FBZixlQUFlLENBQWlCO0lBQUcsQ0FBQztJQUV4RCxlQUFlLENBQUMsT0FBZSxFQUFFLEVBQUUsT0FBZSxDQUFDLEVBQUUsVUFBbUI7UUFDcEUsTUFBTSxNQUFNLEdBQUcsVUFBVTtZQUNyQixDQUFDLENBQUM7Z0JBQ0ksTUFBTSxFQUFFO29CQUNKLFlBQVksRUFBRTt3QkFDVixRQUFRLEVBQUUsVUFBVTtxQkFDdkI7b0JBQ0QsUUFBUSxFQUFFO3dCQUNOLFFBQVEsRUFBRSxVQUFVO3FCQUN2QjtpQkFDSjthQUNKO1lBQ0gsQ0FBQyxDQUFDLEVBQUUsQ0FBQztRQUNULE9BQU8sSUFBSSxDQUFDLGVBQWUsQ0FBQyxLQUFLLENBQzdCLGlCQUFpQixFQUNqQjtZQUNJLE9BQU8sZ0NBQ0gsSUFBSTtnQkFDSixJQUFJLElBQ0QsTUFBTSxLQUNULGNB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QUFDLEtBQUssQ0FDN0Isb0JBQW9CLEVBQ3BCO1lBQ0ksRUFBRTtZQUNGLE9BQU87U0FDVixDQUNKLENBQUM7SUFDTixDQUFDO0lBRUQsaUJBQWlCLENBQUMsVUFBa0IsRUFBRSxJQUFZO1FBQzlDLE9BQU8sSUFBSSxDQUFDLGVBQWUsQ0FBQyxNQUFNLENBQzlCLG9CQUFvQixFQUNwQjtZQUNJLEtBQUssRUFBRTtnQkFDSCxJQUFJO2dCQUNKLFFBQVEsRUFBRSxLQUFLO2dCQUNmLEVBQUUsRUFBRSxVQUFVO2FBQ2pCO1NBQ0osQ0FDSixDQUFDO0lBQ04sQ0FBQztJQUVELGtCQUFrQixDQUFDLEtBQThCO1FBQzdDLE9BQU8sSUFBSSxDQUFDLGVBQWUsQ0FBQyxNQUFNLENBQzlCLG9CQUFvQixFQUNwQjtZQUNJLEtBQUs7U0FDUixDQUNKLENBQUM7SUFDTixDQUFDO0lBRUQsa0JBQWtCLENBQUMsRUFBVTtRQUN6QixPQUFPLElBQUksQ0FBQyxlQUFlLENBQUMsTUFBTSxDQUM5QixvQkFBb0IsRUFDcEI7WUFDSSxFQUFFO1NBQ0wsQ0FDSixDQUFDO0lBQ04sQ0FBQztDQUNKIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgICBBZGRDdXN0b21lcnNUb0dyb3VwLFxuICAgIEFkZE5vdGVUb0N1c3RvbWVyLFxuICAgIENyZWF0ZUFkZHJlc3NJbnB1dCxcbiAgICBDcmVhdGVDdXN0b21lcixcbiAgICBDcmVhdGVDdXN0b21lckFkZHJlc3MsXG4gICAgQ3JlYXRlQ3VzdG9tZXJHcm91cCxcbiAgICBDcmVhdGVDdXN0b21lckdyb3VwSW5wdXQsXG4gICAgQ3JlYXRlQ3VzdG9tZXJJbnB1dCxcbiAgICBDdXN0b21lckdyb3VwTGlzdE9wdGlvbnMsXG4gICAgQ3VzdG9tZXJMaXN0T3B0aW9ucyxcbiAgICBEZWxldGVDdXN0b21lcixcbiAgICBEZWxldGVDdXN0b21lckFkZHJlc3MsXG4gICAgRGVsZXRlQ3VzdG9tZXJHcm91cCxcbiAgICBEZWxldGVDdXN0b21lck5vdGUsXG4gICAgR2V0Q3VzdG9tZXIsXG4gICAgR2V0Q3VzdG9tZXJHcm91cHMsXG4gICAgR2V0Q3VzdG9tZXJHcm91cFdpdGhDdXN0b21lcnMsXG4gICAgR2V0Q3VzdG9tZXJIaXN0b3J5LFxuICAgIEdldEN1c3RvbWVyTGlzdCxcbiAgICBIaXN0b3J5RW50cnlMaXN0T3B0aW9ucyxcbiAgICBMb2dpY2FsT3BlcmF0b3IsXG4gICAgT3JkZXJMaXN0T3B0aW9ucyxcbiAgICBSZW1vdmVDdXN0b21lcnNGcm9tR3JvdXAsXG4gICAgVXBkYXRlQWRkcmVzc0lucHV0LFxuICAgIFVwZGF0ZUN1c3RvbWVyLFxuICAgIFVwZGF0ZUN1c3RvbWVyQWRkcmVzcyxcbiAgICBVcGRhdGVDdXN0b21lckdyb3VwLFxuICAgIFVwZGF0ZUN1c3RvbWVyR3JvdXBJbnB1dCxcbiAgICBVcGRhdGVDdXN0b21lcklucHV0LFxuICAgIFVwZGF0ZUN1c3RvbWVyTm90ZSxcbiAgICBVcGRhdGVDdXN0b21lck5vdGVJbnB1dCxcbn0gZnJvbSAnLi4vLi4vY29tbW9uL2dlbmVyYXRlZC10eXBlcyc7XG5pbXBvcnQge1xuICAgIEFERF9DVVNUT01FUlNfVE9fR1JPVVAsXG4gICAgQUREX05PVEVfVE9fQ1VTVE9NRVIsXG4gICAgQ1JFQVRFX0NVU1RPTUVSLFxuICAgIENSRUFURV9DVVNUT01FUl9BRERSRVNTLFxuICAgIENSRUFURV9DVVNUT01FUl9HUk9VUCxcbiAgICBERUxFVEVfQ1VTVE9NRVIsXG4gICAgREVMRVRFX0NVU1RPTUVSX0FERFJFU1MsXG4gICAgREVMRVRFX0NVU1RPTUVSX0dST1VQLFxuICAgIERFTEVURV9DVVNUT01FUl9OT1RFLFxuICAgIEdFVF9DVVNUT01FUixcbiAgICBHRVRfQ1VTVE9NRVJfR1JPVVBfV0lUSF9DVVNUT01FUlMsXG4gICAgR0VUX0NVU1RPTUVSX0dST1VQUyxcbiAgICBHRVRfQ1VTVE9NRVJfSElTVE9SWSxcbiAgICBHRVRfQ1VTVE9NRVJfTElTVCxcbiAgICBSRU1PVkVfQ1VTVE9NRVJTX0ZST01fR1JPVVAsXG4gICAgVVBEQVRFX0NVU1RPTUVSLFxuICAgIFVQREFURV9DVVNUT01FUl9BRERSRVNTLFxuICAgIFVQREFURV9DVVNUT01FUl9HUk9VUCxcbiAgICBVUERBVEVfQ1VTVE9NRVJfTk9URSxcbn0gZnJvbSAnLi4vZGVmaW5pdGlvbnMvY3VzdG9tZXItZGVmaW5pdGlvbnMnO1xuXG5pbXBvcnQgeyBCYXNlRGF0YVNlcnZpY2UgfSBmcm9tICcuL2Jhc2UtZGF0YS5zZXJ2aWNlJztcblxuZXhwb3J0IGNsYXNzIEN1c3RvbWVyRGF0YVNlcnZpY2Uge1xuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgYmFzZURhdGFTZXJ2aWNlOiBCYXNlRGF0YVNlcnZpY2UpIHt9XG5cbiAgICBnZXRDdXN0b21lckxpc3QodGFrZTogbnVtYmVyID0gMTAsIHNraXA6IG51bWJlciA9IDAsIGZpbHRlclRlcm0/OiBzdHJpbmcpIHtcbiAgICAgICAgY29uc3QgZmlsdGVyID0gZmlsdGVyVGVybVxuICAgICAgICAgICAgPyB7XG4gICAgICAgICAgICAgICAgICBmaWx0ZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICBlbWFpbEFkZHJlc3M6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbnM6IGZpbHRlclRlcm0sXG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICBsYXN0TmFtZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBjb250YWluczogZmlsdGVyVGVybSxcbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgOiB7fTtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmFzZURhdGFTZXJ2aWNlLnF1ZXJ5PEdldEN1c3RvbWVyTGlzdC5RdWVyeSwgR2V0Q3VzdG9tZXJMaXN0LlZhcmlhYmxlcz4oXG4gICAgICAgICAgICBHRVRfQ1VTVE9NRVJfTElTVCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgICAgICAgICAgIHRha2UsXG4gICAgICAgICAgICAgICAgICAgIHNraXAsXG4gICAgICAgICAgICAgICAgICAgIC4uLmZpbHRlcixcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyT3BlcmF0b3I6IExvZ2ljYWxPcGVyYXRvci5PUixcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBnZXRDdXN0b21lcihpZDogc3RyaW5nLCBvcmRlckxpc3RPcHRpb25zPzogT3JkZXJMaXN0T3B0aW9ucykge1xuICAgICAgICByZXR1cm4gdGhpcy5iYXNlRGF0YVNlcnZpY2UucXVlcnk8R2V0Q3VzdG9tZXIuUXVlcnksIEdldEN1c3RvbWVyLlZhcmlhYmxlcz4oR0VUX0NVU1RPTUVSLCB7XG4gICAgICAgICAgICBpZCxcbiAgICAgICAgICAgIG9yZGVyTGlzdE9wdGlvbnMsXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGNyZWF0ZUN1c3RvbWVyKGlucHV0OiBDcmVhdGVDdXN0b21lcklucHV0LCBwYXNzd29yZD86IHN0cmluZykge1xuICAgICAgICByZXR1cm4gdGhpcy5iYXNlRGF0YVNlcnZpY2UubXV0YXRlPENyZWF0ZUN1c3RvbWVyLk11dGF0aW9uLCBDcmVhdGVDdXN0b21lci5WYXJpYWJsZXM+KFxuICAgICAgICAgICAgQ1JFQVRFX0NVU1RPTUVSLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlucHV0LFxuICAgICAgICAgICAgICAgIHBhc3N3b3JkLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICB1cGRhdGVDdXN0b21lcihpbnB1dDogVXBkYXRlQ3VzdG9tZXJJbnB1dCkge1xuICAgICAgICByZXR1cm4gdGhpcy5iYXNlRGF0YVNlcnZpY2UubXV0YXRlPFVwZGF0ZUN1c3RvbWVyLk11dGF0aW9uLCBVcGRhdGVDdXN0b21lci5WYXJpYWJsZXM+KFxuICAgICAgICAgICAgVVBEQVRFX0NVU1RPTUVSLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlucHV0LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBkZWxldGVDdXN0b21lcihpZDogc3RyaW5nKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJhc2VEYXRhU2VydmljZS5tdXRhdGU8RGVsZXRlQ3VzdG9tZXIuTXV0YXRpb24sIERlbGV0ZUN1c3RvbWVyLlZhcmlhYmxlcz4oXG4gICAgICAgICAgICBERUxFVEVfQ1VTVE9NRVIsXG4gICAgICAgICAgICB7IGlkIH0sXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgY3JlYXRlQ3VzdG9tZXJBZGRyZXNzKGN1c3RvbWVySWQ6IHN0cmluZywgaW5wdXQ6IENyZWF0ZUFkZHJlc3NJbnB1dCkge1xuICAgICAgICByZXR1cm4gdGhpcy5iYXNlRGF0YVNlcnZpY2UubXV0YXRlPENyZWF0ZUN1c3RvbWVyQWRkcmVzcy5NdXRhdGlvbiwgQ3JlYXRlQ3VzdG9tZXJBZGRyZXNzLlZhcmlhYmxlcz4oXG4gICAgICAgICAgICBDUkVBVEVfQ1VTVE9NRVJfQUREUkVTUyxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjdXN0b21lcklkLFxuICAgICAgICAgICAgICAgIGlucHV0LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICB1cGRhdGVDdXN0b21lckFkZHJlc3MoaW5wdXQ6IFVwZGF0ZUFkZHJlc3NJbnB1dCkge1xuICAgICAgICByZXR1cm4gdGhpcy5iYXNlRGF0YVNlcnZpY2UubXV0YXRlPFVwZGF0ZUN1c3RvbWVyQWRkcmVzcy5NdXRhdGlvbiwgVXBkYXRlQ3VzdG9tZXJBZGRyZXNzLlZhcmlhYmxlcz4oXG4gICAgICAgICAgICBVUERBVEVfQ1VTVE9NRVJfQUREUkVTUyxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpbnB1dCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgZGVsZXRlQ3VzdG9tZXJBZGRyZXNzKGlkOiBzdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmFzZURhdGFTZXJ2aWNlLm11dGF0ZTxEZWxldGVDdXN0b21lckFkZHJlc3MuTXV0YXRpb24sIERlbGV0ZUN1c3RvbWVyQWRkcmVzcy5WYXJpYWJsZXM+KFxuICAgICAgICAgICAgREVMRVRFX0NVU1RPTUVSX0FERFJFU1MsXG4gICAgICAgICAgICB7IGlkIH0sXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgY3JlYXRlQ3VzdG9tZXJHcm91cChpbnB1dDogQ3JlYXRlQ3VzdG9tZXJHcm91cElucHV0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJhc2VEYXRhU2VydmljZS5tdXRhdGU8Q3JlYXRlQ3VzdG9tZXJHcm91cC5NdXRhdGlvbiwgQ3JlYXRlQ3VzdG9tZXJHcm91cC5WYXJpYWJsZXM+KFxuICAgICAgICAgICAgQ1JFQVRFX0NVU1RPTUVSX0dST1VQLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlucHV0LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICB1cGRhdGVDdXN0b21lckdyb3VwKGlucHV0OiBVcGRhdGVDdXN0b21lckdyb3VwSW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmFzZURhdGFTZXJ2aWNlLm11dGF0ZTxVcGRhdGVDdXN0b21lckdyb3VwLk11dGF0aW9uLCBVcGRhdGVDdXN0b21lckdyb3VwLlZhcmlhYmxlcz4oXG4gICAgICAgICAgICBVUERBVEVfQ1VTVE9NRVJfR1JPVVAsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaW5wdXQsXG4gICAgICAgICAgICB9LFxuICAgICAgICApO1xuICAgIH1cblxuICAgIGRlbGV0ZUN1c3RvbWVyR3JvdXAoaWQ6IHN0cmluZykge1xuICAgICAgICByZXR1cm4gdGhpcy5iYXNlRGF0YVNlcnZpY2UubXV0YXRlPERlbGV0ZUN1c3RvbWVyR3JvdXAuTXV0YXRpb24sIERlbGV0ZUN1c3RvbWVyR3JvdXAuVmFyaWFibGVzPihcbiAgICAgICAgICAgIERFTEVURV9DVVNUT01FUl9HUk9VUCxcbiAgICAgICAgICAgIHsgaWQgfSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBnZXRDdXN0b21lckdyb3VwTGlzdChvcHRpb25zPzogQ3VzdG9tZXJHcm91cExpc3RPcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJhc2VEYXRhU2VydmljZS5xdWVyeTxHZXRDdXN0b21lckdyb3Vwcy5RdWVyeSwgR2V0Q3VzdG9tZXJHcm91cHMuVmFyaWFibGVzPihcbiAgICAgICAgICAgIEdFVF9DVVNUT01FUl9HUk9VUFMsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgZ2V0Q3VzdG9tZXJHcm91cFdpdGhDdXN0b21lcnMoaWQ6IHN0cmluZywgb3B0aW9uczogQ3VzdG9tZXJMaXN0T3B0aW9ucykge1xuICAgICAgICByZXR1cm4gdGhpcy5iYXNlRGF0YVNlcnZpY2UucXVlcnk8XG4gICAgICAgICAgICBHZXRDdXN0b21lckdyb3VwV2l0aEN1c3RvbWVycy5RdWVyeSxcbiAgICAgICAgICAgIEdldEN1c3RvbWVyR3JvdXBXaXRoQ3VzdG9tZXJzLlZhcmlhYmxlc1xuICAgICAgICA+KEdFVF9DVVNUT01FUl9HUk9VUF9XSVRIX0NVU1RPTUVSUywge1xuICAgICAgICAgICAgaWQsXG4gICAgICAgICAgICBvcHRpb25zLFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBhZGRDdXN0b21lcnNUb0dyb3VwKGdyb3VwSWQ6IHN0cmluZywgY3VzdG9tZXJJZHM6IHN0cmluZ1tdKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJhc2VEYXRhU2VydmljZS5tdXRhdGU8QWRkQ3VzdG9tZXJzVG9Hcm91cC5NdXRhdGlvbiwgQWRkQ3VzdG9tZXJzVG9Hcm91cC5WYXJpYWJsZXM+KFxuICAgICAgICAgICAgQUREX0NVU1RPTUVSU19UT19HUk9VUCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBncm91cElkLFxuICAgICAgICAgICAgICAgIGN1c3RvbWVySWRzLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICByZW1vdmVDdXN0b21lcnNGcm9tR3JvdXAoZ3JvdXBJZDogc3RyaW5nLCBjdXN0b21lcklkczogc3RyaW5nW10pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmFzZURhdGFTZXJ2aWNlLm11dGF0ZTxcbiAgICAgICAgICAgIFJlbW92ZUN1c3RvbWVyc0Zyb21Hcm91cC5NdXRhdGlvbixcbiAgICAgICAgICAgIFJlbW92ZUN1c3RvbWVyc0Zyb21Hcm91cC5WYXJpYWJsZXNcbiAgICAgICAgPihSRU1PVkVfQ1VTVE9NRVJTX0ZST01fR1JPVVAsIHtcbiAgICAgICAgICAgIGdyb3VwSWQsXG4gICAgICAgICAgICBjdXN0b21lcklkcyxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZ2V0Q3VzdG9tZXJIaXN0b3J5KGlkOiBzdHJpbmcsIG9wdGlvbnM/OiBIaXN0b3J5RW50cnlMaXN0T3B0aW9ucykge1xuICAgICAgICByZXR1cm4gdGhpcy5iYXNlRGF0YVNlcnZpY2UucXVlcnk8R2V0Q3VzdG9tZXJIaXN0b3J5LlF1ZXJ5LCBHZXRDdXN0b21lckhpc3RvcnkuVmFyaWFibGVzPihcbiAgICAgICAgICAgIEdFVF9DVVNUT01FUl9ISVNUT1JZLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlkLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMsXG4gICAgICAgICAgICB9LFxuICAgICAgICApO1xuICAgIH1cblxuICAgIGFkZE5vdGVUb0N1c3RvbWVyKGN1c3RvbWVySWQ6IHN0cmluZywgbm90ZTogc3RyaW5nKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJhc2VEYXRhU2VydmljZS5tdXRhdGU8QWRkTm90ZVRvQ3VzdG9tZXIuTXV0YXRpb24sIEFkZE5vdGVUb0N1c3RvbWVyLlZhcmlhYmxlcz4oXG4gICAgICAgICAgICBBRERfTk9URV9UT19DVVNUT01FUixcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpbnB1dDoge1xuICAgICAgICAgICAgICAgICAgICBub3RlLFxuICAgICAgICAgICAgICAgICAgICBpc1B1YmxpYzogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGlkOiBjdXN0b21lcklkLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICApO1xuICAgIH1cblxuICAgIHVwZGF0ZUN1c3RvbWVyTm90ZShpbnB1dDogVXBkYXRlQ3VzdG9tZXJOb3RlSW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmFzZURhdGFTZXJ2aWNlLm11dGF0ZTxVcGRhdGVDdXN0b21lck5vdGUuTXV0YXRpb24sIFVwZGF0ZUN1c3RvbWVyTm90ZS5WYXJpYWJsZXM+KFxuICAgICAgICAgICAgVVBEQVRFX0NVU1RPTUVSX05PVEUsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaW5wdXQsXG4gICAgICAgICAgICB9LFxuICAgICAgICApO1xuICAgIH1cblxuICAgIGRlbGV0ZUN1c3RvbWVyTm90ZShpZDogc3RyaW5nKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJhc2VEYXRhU2VydmljZS5tdXRhdGU8RGVsZXRlQ3VzdG9tZXJOb3RlLk11dGF0aW9uLCBEZWxldGVDdXN0b21lck5vdGUuVmFyaWFibGVzPihcbiAgICAgICAgICAgIERFTEVURV9DVVNUT01FUl9OT1RFLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlkLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgKTtcbiAgICB9XG59XG4iXX0=