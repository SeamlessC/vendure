{"version":3,"mappings":"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","names":["constructor","n","Y","e","selectors","$","this","selectedMemberIds","indexOf","id","filteredMembers","filterTerm","toLocaleLowerCase","members","filter","t","name","includes","code","areAllSelected","length","toggleSelectAll","selectionChange","emit","map","toggleSelectMember","item","j","ngOnInit","currentMembers","availableCountries$","dataService","settings","getCountries","mapStream","countries","items","pipe","L","i","cancel","resolveWith","add","re","buildGrid","setPermission","readonly","permissionChange","permission","value","toggleAll","some","activePermissions","Map","r","l","permissionDefinitions","test","h","match","f","get","push","set","assignable","gridData","label","description","permissions","Array","from","entries","d","extractCrudDescription","replace","z","s","super","customFields","getCustomFieldConfig","detailForm","formBuilder","group","emailAddress","a","firstName","lastName","password","roles","reduce","y","Object","getAvailableChannels","values","selectedRolePermissions","init","administrator$","entity$","allRoles$","administrator","getRoles","se","client","userStatus","single$","subscribe","disable","serverConfigService","getPermissionDefinitions","ngOnDestroy","destroy","rolesChanged","buildPermissionsMap","getPermissionsForSelectedChannel","selectedChannelId","channelId","create","roleIds","createAdministrator","notificationService","success","entity","markAsPristine","changeDetector","markForCheck","router","navigate","relativeTo","route","error","save","F","updateAdministrator","setFormValues","patchValue","user","setCustomFieldFormValues","setValidators","channels","Set","forEach","keys","has","channelCode","ae","setQueryFn","getAdministrators","administrators","deleteAdministrator","modalService","dialog","title","c","body","buttons","type","returnValue","q","refresh","le","token","pricesIncludeTax","currencyCode","defaultShippingZoneId","defaultLanguageCode","defaultTaxZoneId","zones$","getZones","mapSingle","zones","availableLanguageCodes$","getAvailableLanguages","saveButtonEnabled","dirty","valid","createChannel","auth","currentUser","me","T","updateUserChannels","__typename","message","updateChannel","generateToken","defaultShippingZone","defaultTaxZone","Math","random","toString","substr","ce","Je","channels$","refresh$","b","getChannels","isDefaultChannel","deleteChannel","next","de","enabled","country$","w","languageCode$","translatable","updatedFields","customFieldConfig","languageCode","defaultTranslation","createCountry","updateCountry","contentLanguage$","uiState","contentLanguage","searchTerm","valueChanges","countriesWithZones$","find","availableLanguages$","destroy$","complete","setLanguage","setContentLanguage","deleteCountry","result","isZone","hasOwnProperty","ue","clear","call","availableLanguages","trackInventory","outOfStockThreshold","updateGlobalSettings","refreshGlobalSettings","globalSettings","pe","checker","handler","getPaymentMethodOperations","checkers","paymentMethodEligibilityCheckers","handlers","paymentMethodHandlers","selectedCheckerDefinition","selectedHandlerDefinition","updateCode","pristine","setValue","configArgsIsPopulated","controls","selectChecker","selectedChecker","clearValidators","updateValueAndValidity","onlySelf","markAsDirty","selectHandler","selectedHandler","removeChecker","removeHandler","createPaymentMethod","updatePaymentMethod","args","ge","getPaymentMethods","refetchOnChannelChange","paymentMethods","deletePaymentMethod","showModalAndDelete","_e","updateActiveAdministrator","he","channelIds","role$","kn","createRole","updateRole","detectChanges","fe","visibleRoles$","items$","toggleDisplayLimit","displayLimit","initialLimit","isDefaultRole","deleteRole","Ze","be","lines","unitPriceWithTax","quantity","loadFromLocalStorage","orderLinesChange","getActiveChannel","activeChannel","selectResult","addToLines","productVariantId","productVariantName","preview","productAsset","sku","priceWithTax","persistToLocalStorage","updateQuantity","removeLine","localStorageService","setForCurrentLocation","getForCurrentLocation","E","getAvailableCountries","city","countryCode","postalCode","province","addressChange","form","subscription","unsubscribe","H","ve","fulfillmentHandler","calculator","shippingMethod","getShippingMethodOperations","shippingEligibilityCheckers","calculators","shippingCalculators","fulfillmentHandlers","selectedCalculatorDefinition","activeChannel$","testResult$","fetchTestResult$","selectedCalculator","Ge","shippingAddress","streetLine1","testShippingMethod","eo","to","testDataUpdated","selectCalculator","getUpdatedShippingMethod","createShippingMethod","updateShippingMethod","console","setTestOrderLines","testOrderLines","setTestAddress","testAddress","allTestDataPresent","runTest","fulfillmentHandlerCode","Ce","getShippingMethods","shippingMethods","testEligibleShippingMethods","deleteShippingMethod","ye","isDefault","taxCategory$","createTaxCategory","updateTaxCategory","xe","queryResult","getTaxCategories","taxCategories$","taxCategories","deleteTaxCategory","ref","refetch","Te","taxCategoryId","zoneId","customerGroupId","categoryId","createTaxRate","updateTaxRate","category","zone","customerGroup","Ae","getTaxRates","taxRates","deleteTaxRate","Le","getCustomFieldsFor","G","data","paramMap","ui","activeZone$","fromComponent","locals","createZone","memberIds","delete","deleteZone","errorMessage","update","updateZone","closeMembers","snapshot","params","contents","queryParamsHandling","addToZone","zoneName","size","addMembersToZone","countryCount","removeFromZone","removeMembersFromZone","Fe","createdAt","updatedAt","getAdministrator","V","factory","getChannel","channel","B","translations","getCountry","country","K","getGlobalSettings","W","getPaymentMethod","paymentMethod","X","getActiveAdministrator","activeAdministrator","ee","getRole","role","te","getShippingMethod","ne","getTaxCategory","taxCategory","oe","getTaxRate","taxRate","ie","Ke","path","component","resolve","canDeactivate","breadcrumb","We","Xe","et","tt","nt","ot","it","rt","o","breadcrumbKey","getName","qe","g"],"sources":["webpack:///src/lib/settings/src/components/zone-member-list/zone-member-controls.directive.ts","webpack:///src/lib/settings/src/components/zone-member-list/zone-member-list-header.directive.ts","webpack:///src/lib/settings/src/components/zone-member-list/zone-member-list.component.html","webpack:///src/lib/settings/src/components/zone-member-list/zone-member-list.component.ts","webpack:///src/lib/settings/src/components/add-country-to-zone-dialog/add-country-to-zone-dialog.component.html","webpack:///src/lib/settings/src/components/add-country-to-zone-dialog/add-country-to-zone-dialog.component.ts","webpack:///src/lib/settings/src/components/permission-grid/permission-grid.component.html","webpack:///src/lib/settings/src/components/permission-grid/permission-grid.component.ts","webpack:///src/lib/settings/src/components/admin-detail/admin-detail.component.html","webpack:///src/lib/settings/src/components/admin-detail/admin-detail.component.ts","webpack:///src/lib/settings/src/components/administrator-list/administrator-list.component.html","webpack:///src/lib/settings/src/components/administrator-list/administrator-list.component.ts","webpack:///src/lib/settings/src/components/channel-detail/channel-detail.component.html","webpack:///src/lib/settings/src/components/channel-detail/channel-detail.component.ts","webpack:///src/lib/settings/src/components/channel-list/channel-list.component.html","webpack:///src/lib/settings/src/components/channel-list/channel-list.component.ts","webpack:///src/lib/settings/src/components/country-detail/country-detail.component.html","webpack:///src/lib/settings/src/components/country-detail/country-detail.component.ts","webpack:///src/lib/settings/src/components/country-list/country-list.component.html","webpack:///src/lib/settings/src/components/country-list/country-list.component.ts","webpack:///src/lib/settings/src/components/global-settings/global-settings.component.html","webpack:///src/lib/settings/src/components/global-settings/global-settings.component.ts","webpack:///src/lib/settings/src/components/payment-method-detail/payment-method-detail.component.html","webpack:///src/lib/settings/src/components/payment-method-detail/payment-method-detail.component.ts","webpack:///src/lib/settings/src/components/payment-method-list/payment-method-list.component.html","webpack:///src/lib/settings/src/components/payment-method-list/payment-method-list.component.ts","webpack:///src/lib/settings/src/components/profile/profile.component.html","webpack:///src/lib/settings/src/components/profile/profile.component.ts","webpack:///src/lib/settings/src/components/role-detail/role-detail.component.html","webpack:///src/lib/settings/src/components/role-detail/role-detail.component.ts","webpack:///src/lib/settings/src/components/role-list/role-list.component.html","webpack:///src/lib/settings/src/components/role-list/role-list.component.ts","webpack:///src/lib/settings/src/components/shipping-eligibility-test-result/shipping-eligibility-test-result.component.html","webpack:///src/lib/settings/src/components/shipping-eligibility-test-result/shipping-eligibility-test-result.component.ts","webpack:///src/lib/settings/src/components/test-order-builder/test-order-builder.component.html","webpack:///src/lib/settings/src/components/test-order-builder/test-order-builder.component.ts","webpack:///src/lib/settings/src/components/test-address-form/test-address-form.component.html","webpack:///src/lib/settings/src/components/test-address-form/test-address-form.component.ts","webpack:///src/lib/settings/src/components/shipping-method-test-result/shipping-method-test-result.component.html","webpack:///src/lib/settings/src/components/shipping-method-test-result/shipping-method-test-result.component.ts","webpack:///src/lib/settings/src/components/shipping-method-detail/shipping-method-detail.component.html","webpack:///src/lib/settings/src/components/shipping-method-detail/shipping-method-detail.component.ts","webpack:///src/lib/settings/src/components/shipping-method-list/shipping-method-list.component.html","webpack:///src/lib/settings/src/components/shipping-method-list/shipping-method-list.component.ts","webpack:///src/lib/settings/src/components/tax-category-detail/tax-category-detail.component.html","webpack:///src/lib/settings/src/components/tax-category-detail/tax-category-detail.component.ts","webpack:///src/lib/settings/src/components/tax-category-list/tax-category-list.component.html","webpack:///src/lib/settings/src/components/tax-category-list/tax-category-list.component.ts","webpack:///src/lib/settings/src/components/tax-rate-detail/tax-rate-detail.component.html","webpack:///src/lib/settings/src/components/tax-rate-detail/tax-rate-detail.component.ts","webpack:///src/lib/settings/src/components/tax-rate-list/tax-rate-list.component.html","webpack:///src/lib/settings/src/components/tax-rate-list/tax-rate-list.component.ts","webpack:///src/lib/settings/src/components/zone-detail-dialog/zone-detail-dialog.component.html","webpack:///src/lib/settings/src/components/zone-detail-dialog/zone-detail-dialog.component.ts","webpack:///src/lib/settings/src/components/zone-list/zone-list.component.html","webpack:///src/lib/settings/src/components/zone-list/zone-list.component.ts","webpack:///src/lib/settings/src/providers/routing/administrator-resolver.ts","webpack:///src/lib/settings/src/providers/routing/channel-resolver.ts","webpack:///src/lib/settings/src/providers/routing/country-resolver.ts","webpack:///src/lib/settings/src/providers/routing/global-settings-resolver.ts","webpack:///src/lib/settings/src/providers/routing/payment-method-resolver.ts","webpack:///src/lib/settings/src/providers/routing/profile-resolver.ts","webpack:///src/lib/settings/src/providers/routing/role-resolver.ts","webpack:///src/lib/settings/src/providers/routing/shipping-method-resolver.ts","webpack:///src/lib/settings/src/providers/routing/tax-category-resolver.ts","webpack:///src/lib/settings/src/providers/routing/tax-rate-resolver.ts","webpack:///src/lib/settings/src/settings.routes.ts","webpack:///src/lib/settings/src/settings.module.ts"],"sourcesContent":["import { Directive, TemplateRef } from '@angular/core';\n\n@Directive({\n    selector: '[vdrZoneMemberControls]',\n})\nexport class ZoneMemberControlsDirective {\n    constructor(public templateRef: TemplateRef<any>) {}\n}\n","import { Directive, TemplateRef } from '@angular/core';\n\n@Directive({\n    selector: '[vdrZoneMemberListHeader]',\n})\nexport class ZoneMemberListHeaderDirective {\n    constructor(public templateRef: TemplateRef<any>) {}\n}\n","<div class=\"members-header\">\n    <ng-container *ngIf=\"headerTemplate\">\n        <ng-container *ngTemplateOutlet=\"headerTemplate.templateRef\"></ng-container>\n    </ng-container>\n    <input\n        type=\"text\"\n        [placeholder]=\"'settings.filter-by-member-name' | translate\"\n        [(ngModel)]=\"filterTerm\"\n    />\n</div>\n<vdr-data-table\n    [items]=\"filteredMembers()\"\n    [allSelected]=\"areAllSelected()\"\n    [isRowSelectedFn]=\"(['UpdateSettings', 'UpdateZone'] | hasPermission) && isMemberSelected\"\n    (rowSelectChange)=\"toggleSelectMember($event)\"\n    (allSelectChange)=\"toggleSelectAll()\"\n>\n    <vdr-dt-column>{{ 'common.code' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ 'common.name' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ 'common.enabled' | translate }}</vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <ng-template let-member=\"item\">\n        <td class=\"left align-middle\">{{ member.code }}</td>\n        <td class=\"left align-middle\">{{ member.name }}</td>\n        <td class=\"left align-middle\">\n            <clr-icon\n                [class.is-success]=\"member.enabled\"\n                [attr.shape]=\"member.enabled ? 'check' : 'times'\"\n            ></clr-icon>\n        </td>\n        <td class=\"right align-middle\">\n            <ng-container *ngIf=\"controlsTemplate\">\n                <ng-container\n                    *ngTemplateOutlet=\"controlsTemplate.templateRef; context: { member: member }\"\n                ></ng-container>\n            </ng-container>\n        </td>\n    </ng-template>\n</vdr-data-table>\n","import { ChangeDetectionStrategy, Component, ContentChild, EventEmitter, Input, Output } from '@angular/core';\nimport { GetZones } from '@vendure/admin-ui/core';\n\nimport { ZoneMemberControlsDirective } from './zone-member-controls.directive';\nimport { ZoneMemberListHeaderDirective } from './zone-member-list-header.directive';\n\nexport type ZoneMember = { id: string; name: string; code: string };\n\n@Component({\n    selector: 'vdr-zone-member-list',\n    templateUrl: './zone-member-list.component.html',\n    styleUrls: ['./zone-member-list.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ZoneMemberListComponent {\n    @Input() members: ZoneMember[] = [];\n    @Input() selectedMemberIds: string[] = [];\n    @Output() selectionChange = new EventEmitter<string[]>();\n    @ContentChild(ZoneMemberListHeaderDirective) headerTemplate: ZoneMemberListHeaderDirective;\n    @ContentChild(ZoneMemberControlsDirective) controlsTemplate: ZoneMemberControlsDirective;\n    filterTerm = '';\n\n    filteredMembers(): ZoneMember[] {\n        if (this.filterTerm !== '') {\n            const term = this.filterTerm.toLocaleLowerCase();\n            return this.members.filter(\n                m => m.name.toLocaleLowerCase().includes(term) || m.code.toLocaleLowerCase().includes(term),\n            );\n        } else {\n            return this.members;\n        }\n    }\n\n    areAllSelected(): boolean {\n        if (this.members) {\n            return this.selectedMemberIds.length === this.members.length;\n        } else {\n            return false;\n        }\n    }\n\n    toggleSelectAll() {\n        if (this.areAllSelected()) {\n            this.selectionChange.emit([]);\n        } else {\n            this.selectionChange.emit(this.members.map(v => v.id));\n        }\n    }\n\n    toggleSelectMember({ item: member }: { item: ZoneMember }) {\n        if (this.selectedMemberIds.includes(member.id)) {\n            this.selectionChange.emit(this.selectedMemberIds.filter(id => id !== member.id));\n        } else {\n            this.selectionChange.emit([...this.selectedMemberIds, member.id]);\n        }\n    }\n\n    isMemberSelected = (member: ZoneMember): boolean => {\n        return -1 < this.selectedMemberIds.indexOf(member.id);\n    };\n}\n","<ng-template vdrDialogTitle>{{ 'settings.add-countries-to-zone' | translate: { zoneName: zoneName } }}</ng-template>\n\n<vdr-zone-member-list\n    [members]=\"availableCountries$ | async\"\n    [selectedMemberIds]=\"selectedMemberIds\"\n    (selectionChange)=\"selectedMemberIds = $event\"\n>\n</vdr-zone-member-list>\n\n<ng-template vdrDialogButtons>\n    <button type=\"button\" class=\"btn\" (click)=\"cancel()\">{{ 'common.cancel' | translate }}</button>\n    <button type=\"submit\" (click)=\"add()\" [disabled]=\"!selectedMemberIds.length\" class=\"btn btn-primary\">\n        {{ 'settings.add-countries-to-zone' | translate: { zoneName: zoneName } }}\n    </button>\n</ng-template>\n","import { ChangeDetectionStrategy, Component, OnInit } from '@angular/core';\nimport { DataService, Dialog, GetCountryList, GetZones } from '@vendure/admin-ui/core';\nimport { Observable } from 'rxjs';\nimport { filter, map } from 'rxjs/operators';\n\n@Component({\n    selector: 'vdr-add-country-to-zone-dialog',\n    templateUrl: './add-country-to-zone-dialog.component.html',\n    styleUrls: ['./add-country-to-zone-dialog.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class AddCountryToZoneDialogComponent implements Dialog<string[]>, OnInit {\n    resolveWith: (result?: string[]) => void;\n    zoneName: string;\n    currentMembers: GetZones.Members[] = [];\n    availableCountries$: Observable<GetCountryList.Items[]>;\n    selectedMemberIds: string[] = [];\n\n    constructor(private dataService: DataService) {}\n\n    ngOnInit(): void {\n        const currentMemberIds = this.currentMembers.map(m => m.id);\n        this.availableCountries$ = this.dataService.settings\n            .getCountries(999)\n            .mapStream(data => data.countries.items)\n            .pipe(map(countries => countries.filter(c => !currentMemberIds.includes(c.id))));\n    }\n\n    cancel() {\n        this.resolveWith();\n    }\n\n    add() {\n        this.resolveWith(this.selectedMemberIds);\n    }\n}\n","<table class=\"table\">\n    <tbody>\n        <tr *ngFor=\"let section of gridData\">\n            <td class=\"permission-group left\">\n                <div><strong>{{ section.label | translate }}</strong></div>\n                <small>{{ section.description | translate }}</small><br>\n                <button *ngIf=\"1 < section.permissions.length && !readonly\" class=\"btn btn-sm btn-link\" (click)=\"toggleAll(section.permissions)\">\n                    {{ 'common.toggle-all' | translate }}\n                </button>\n            </td>\n            <td *ngFor=\"let permission of section.permissions\" [attr.colspan]=\"section.permissions.length === 1 ? 4 : 1\">\n                <vdr-select-toggle\n                    size=\"small\"\n                    [title]=\"permission.description\"\n                    [label]=\"permission.name\"\n                    [disabled]=\"readonly\"\n                    [selected]=\"activePermissions?.includes(permission.name)\"\n                    (selectedChange)=\"setPermission(permission.name, $event)\"\n                ></vdr-select-toggle>\n            </td>\n        </tr>\n    </tbody>\n</table>\n","import { ChangeDetectionStrategy, Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport { PermissionDefinition } from '@vendure/admin-ui/core';\n\nexport interface PermissionGridRow {\n    label: string;\n    description: string;\n    permissions: PermissionDefinition[];\n}\n\n/**\n * A table showing and allowing the setting of all possible CRUD permissions.\n */\n@Component({\n    selector: 'vdr-permission-grid',\n    templateUrl: './permission-grid.component.html',\n    styleUrls: ['./permission-grid.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class PermissionGridComponent implements OnInit {\n    @Input() permissionDefinitions: PermissionDefinition[];\n    @Input() activePermissions: string[];\n    @Input() readonly = false;\n    @Output() permissionChange = new EventEmitter<{ permission: string; value: boolean }>();\n    gridData: PermissionGridRow[];\n\n    ngOnInit() {\n        this.buildGrid();\n    }\n\n    setPermission(permission: string, value: boolean) {\n        if (!this.readonly) {\n            this.permissionChange.emit({ permission, value });\n        }\n    }\n\n    toggleAll(defs: PermissionDefinition[]) {\n        const value = defs.some(d => !this.activePermissions.includes(d.name));\n        for (const def of defs) {\n            this.permissionChange.emit({ permission: def.name, value });\n        }\n    }\n\n    private buildGrid() {\n        const crudGroups = new Map<string, PermissionDefinition[]>();\n        const nonCrud: PermissionDefinition[] = [];\n        const crudRe = /^(Create|Read|Update|Delete)([a-zA-Z]+)$/;\n        for (const def of this.permissionDefinitions) {\n            const isCrud = crudRe.test(def.name);\n            if (isCrud) {\n                const groupName = def.name.match(crudRe)?.[2];\n                if (groupName) {\n                    const existing = crudGroups.get(groupName);\n                    if (existing) {\n                        existing.push(def);\n                    } else {\n                        crudGroups.set(groupName, [def]);\n                    }\n                }\n            } else if (def.assignable) {\n                nonCrud.push(def);\n            }\n        }\n        this.gridData = [\n            ...nonCrud.map(d => ({\n                label: d.name,\n                description: d.description,\n                permissions: [d],\n            })),\n            ...Array.from(crudGroups.entries()).map(([label, defs]) => {\n                return {\n                    label,\n                    description: this.extractCrudDescription(defs[0]),\n                    permissions: defs,\n                };\n            }),\n        ];\n    }\n\n    private extractCrudDescription(def: PermissionDefinition): string {\n        return def.description.replace(/Grants permission to [\\w]+/, 'Grants permissions on');\n    }\n}\n","<vdr-action-bar>\n    <vdr-ab-left>\n        <vdr-entity-info [entity]=\"entity$ | async\"></vdr-entity-info>\n    </vdr-ab-left>\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId=\"administrator-detail\"></vdr-action-bar-items>\n        <button\n            class=\"btn btn-primary\"\n            *ngIf=\"isNew$ | async; else updateButton\"\n            (click)=\"create()\"\n            [disabled]=\"detailForm.invalid || detailForm.pristine\"\n        >\n            {{ 'common.create' | translate }}\n        </button>\n        <ng-template #updateButton>\n            <button\n                class=\"btn btn-primary\"\n                (click)=\"save()\"\n                *vdrIfPermissions=\"'UpdateAdministrator'\"\n                [disabled]=\"detailForm.invalid || detailForm.pristine\"\n            >\n                {{ 'common.update' | translate }}\n            </button>\n        </ng-template>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<form class=\"form\" [formGroup]=\"detailForm\">\n    <vdr-form-field [label]=\"'settings.email-address' | translate\" for=\"emailAddress\">\n        <input\n            id=\"emailAddress\"\n            type=\"text\"\n            formControlName=\"emailAddress\"\n            [readonly]=\"!('UpdateAdministrator' | hasPermission)\"\n        />\n    </vdr-form-field>\n    <vdr-form-field [label]=\"'settings.first-name' | translate\" for=\"firstName\">\n        <input\n            id=\"firstName\"\n            type=\"text\"\n            formControlName=\"firstName\"\n            [readonly]=\"!('UpdateAdministrator' | hasPermission)\"\n        />\n    </vdr-form-field>\n    <vdr-form-field [label]=\"'settings.last-name' | translate\" for=\"lastName\">\n        <input\n            id=\"lastName\"\n            type=\"text\"\n            formControlName=\"lastName\"\n            [readonly]=\"!('UpdateAdministrator' | hasPermission)\"\n        />\n    </vdr-form-field>\n    <vdr-form-field *ngIf=\"isNew$ | async\" [label]=\"'settings.password' | translate\" for=\"password\">\n        <input id=\"password\" type=\"password\" formControlName=\"password\" />\n    </vdr-form-field>\n    <vdr-form-field\n        *ngIf=\"!(isNew$ | async) && ('UpdateAdministrator' | hasPermission)\"\n        [label]=\"'settings.password' | translate\"\n        for=\"password\"\n        [readOnlyToggle]=\"true\"\n    >\n        <input id=\"password\" type=\"password\" formControlName=\"password\" />\n    </vdr-form-field>\n    <section formGroupName=\"customFields\" *ngIf=\"customFields.length\">\n        <label>{{ 'common.custom-fields' | translate }}</label>\n        <vdr-tabbed-custom-fields\n            entityName=\"Administrator\"\n            [customFields]=\"customFields\"\n            [customFieldsFormGroup]=\"detailForm.get('customFields')\"\n            [readonly]=\"!('UpdateAdministrator' | hasPermission)\"\n        ></vdr-tabbed-custom-fields>\n    </section>\n    <vdr-custom-detail-component-host\n        locationId=\"administrator-detail\"\n        [entity$]=\"entity$\"\n        [detailForm]=\"detailForm\"\n    ></vdr-custom-detail-component-host>\n    <label class=\"clr-control-label\">{{ 'settings.roles' | translate }}</label>\n    <ng-select\n        [items]=\"allRoles$ | async\"\n        [multiple]=\"true\"\n        [hideSelected]=\"true\"\n        formControlName=\"roles\"\n        (change)=\"rolesChanged($event)\"\n        bindLabel=\"description\"\n    ></ng-select>\n\n    <ul class=\"nav\" role=\"tablist\">\n        <li role=\"presentation\" class=\"nav-item\" *ngFor=\"let channel of getAvailableChannels()\">\n            <button\n                [id]=\"channel.channelId\"\n                (click)=\"selectedChannelId = channel.channelId\"\n                class=\"btn btn-link nav-link\"\n                [class.active]=\"selectedChannelId === channel.channelId\"\n                [attr.aria-selected]=\"selectedChannelId === channel.channelId\"\n                type=\"button\"\n            >\n                {{ channel.channelCode | channelCodeToLabel | translate }}\n            </button>\n        </li>\n    </ul>\n    <vdr-permission-grid\n        [activePermissions]=\"getPermissionsForSelectedChannel()\"\n        [permissionDefinitions]=\"permissionDefinitions\"\n        [readonly]=\"true\"\n    ></vdr-permission-grid>\n</form>\n","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, OnDestroy, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport { BaseDetailComponent, CustomFieldConfig, PermissionDefinition } from '@vendure/admin-ui/core';\nimport {\n    Administrator,\n    CreateAdministratorInput,\n    GetAdministrator,\n    LanguageCode,\n    Permission,\n    Role,\n    RoleFragment,\n    UpdateAdministratorInput,\n} from '@vendure/admin-ui/core';\nimport { NotificationService } from '@vendure/admin-ui/core';\nimport { DataService } from '@vendure/admin-ui/core';\nimport { ServerConfigService } from '@vendure/admin-ui/core';\nimport { CUSTOMER_ROLE_CODE } from '@vendure/common/lib/shared-constants';\nimport { Observable } from 'rxjs';\nimport { mergeMap, take } from 'rxjs/operators';\n\nexport interface PermissionsByChannel {\n    channelId: string;\n    channelCode: string;\n    permissions: { [K in Permission]: boolean };\n}\n\n@Component({\n    selector: 'vdr-admin-detail',\n    templateUrl: './admin-detail.component.html',\n    styleUrls: ['./admin-detail.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class AdminDetailComponent\n    extends BaseDetailComponent<GetAdministrator.Administrator>\n    implements OnInit, OnDestroy\n{\n    customFields: CustomFieldConfig[];\n    administrator$: Observable<GetAdministrator.Administrator>;\n    permissionDefinitions: PermissionDefinition[];\n    allRoles$: Observable<Role.Fragment[]>;\n    selectedRoles: Role.Fragment[] = [];\n    detailForm: FormGroup;\n    selectedRolePermissions: { [channelId: string]: PermissionsByChannel } = {} as any;\n    selectedChannelId: string | null = null;\n\n    getAvailableChannels(): PermissionsByChannel[] {\n        return Object.values(this.selectedRolePermissions);\n    }\n\n    constructor(\n        router: Router,\n        route: ActivatedRoute,\n        serverConfigService: ServerConfigService,\n        private changeDetector: ChangeDetectorRef,\n        protected dataService: DataService,\n        private formBuilder: FormBuilder,\n        private notificationService: NotificationService,\n    ) {\n        super(route, router, serverConfigService, dataService);\n        this.customFields = this.getCustomFieldConfig('Administrator');\n        this.detailForm = this.formBuilder.group({\n            emailAddress: ['', Validators.required],\n            firstName: ['', Validators.required],\n            lastName: ['', Validators.required],\n            password: [''],\n            roles: [[]],\n            customFields: this.formBuilder.group(\n                this.customFields.reduce((hash, field) => ({ ...hash, [field.name]: '' }), {}),\n            ),\n        });\n    }\n\n    ngOnInit() {\n        this.init();\n        this.administrator$ = this.entity$;\n        this.allRoles$ = this.dataService.administrator\n            .getRoles(999)\n            .mapStream(item => item.roles.items.filter(i => i.code !== CUSTOMER_ROLE_CODE));\n        this.dataService.client.userStatus().single$.subscribe(({ userStatus }) => {\n            if (!userStatus.permissions.includes(Permission.UpdateAdministrator)) {\n                const rolesSelect = this.detailForm.get('roles');\n                if (rolesSelect) {\n                    rolesSelect.disable();\n                }\n            }\n        });\n        this.permissionDefinitions = this.serverConfigService.getPermissionDefinitions();\n    }\n\n    ngOnDestroy(): void {\n        this.destroy();\n    }\n\n    rolesChanged(roles: Role[]) {\n        this.buildPermissionsMap();\n    }\n\n    getPermissionsForSelectedChannel(): string[] {\n        function getActivePermissions(input: PermissionsByChannel['permissions']): string[] {\n            return Object.entries(input)\n                .filter(([permission, active]) => active)\n                .map(([permission, active]) => permission);\n        }\n        if (this.selectedChannelId) {\n            const selectedChannel = this.selectedRolePermissions[this.selectedChannelId];\n            if (selectedChannel) {\n                const permissionMap = this.selectedRolePermissions[this.selectedChannelId].permissions;\n                return getActivePermissions(permissionMap);\n            }\n        }\n        const channels = Object.values(this.selectedRolePermissions);\n        if (0 < channels.length) {\n            this.selectedChannelId = channels[0].channelId;\n            return getActivePermissions(channels[0].permissions);\n        }\n        return [];\n    }\n\n    create() {\n        const formValue = this.detailForm.value;\n        const administrator: CreateAdministratorInput = {\n            emailAddress: formValue.emailAddress,\n            firstName: formValue.firstName,\n            lastName: formValue.lastName,\n            password: formValue.password,\n            customFields: formValue.customFields,\n            roleIds: formValue.roles.map(role => role.id),\n        };\n        this.dataService.administrator.createAdministrator(administrator).subscribe(\n            data => {\n                this.notificationService.success(_('common.notify-create-success'), {\n                    entity: 'Administrator',\n                });\n                this.detailForm.markAsPristine();\n                this.changeDetector.markForCheck();\n                this.router.navigate(['../', data.createAdministrator.id], { relativeTo: this.route });\n            },\n            err => {\n                this.notificationService.error(_('common.notify-create-error'), {\n                    entity: 'Administrator',\n                });\n            },\n        );\n    }\n\n    save() {\n        this.administrator$\n            .pipe(\n                take(1),\n                mergeMap(({ id }) => {\n                    const formValue = this.detailForm.value;\n                    const administrator: UpdateAdministratorInput = {\n                        id,\n                        emailAddress: formValue.emailAddress,\n                        firstName: formValue.firstName,\n                        lastName: formValue.lastName,\n                        password: formValue.password,\n                        customFields: formValue.customFields,\n                        roleIds: formValue.roles.map(role => role.id),\n                    };\n                    return this.dataService.administrator.updateAdministrator(administrator);\n                }),\n            )\n            .subscribe(\n                data => {\n                    this.notificationService.success(_('common.notify-update-success'), {\n                        entity: 'Administrator',\n                    });\n                    this.detailForm.markAsPristine();\n                    this.changeDetector.markForCheck();\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-update-error'), {\n                        entity: 'Administrator',\n                    });\n                },\n            );\n    }\n\n    protected setFormValues(administrator: Administrator, languageCode: LanguageCode): void {\n        this.detailForm.patchValue({\n            emailAddress: administrator.emailAddress,\n            firstName: administrator.firstName,\n            lastName: administrator.lastName,\n            roles: administrator.user.roles,\n        });\n        if (this.customFields.length) {\n            this.setCustomFieldFormValues(\n                this.customFields,\n                this.detailForm.get(['customFields']),\n                administrator,\n            );\n        }\n        const passwordControl = this.detailForm.get('password');\n        if (passwordControl) {\n            if (!administrator.id) {\n                passwordControl.setValidators([Validators.required]);\n            } else {\n                passwordControl.setValidators([]);\n            }\n        }\n        this.buildPermissionsMap();\n    }\n\n    private buildPermissionsMap() {\n        const permissionsControl = this.detailForm.get('roles');\n        if (permissionsControl) {\n            const roles: RoleFragment[] = permissionsControl.value;\n            const channelIdPermissionsMap = new Map<string, Set<Permission>>();\n            const channelIdCodeMap = new Map<string, string>();\n\n            for (const role of roles) {\n                for (const channel of role.channels) {\n                    const channelPermissions = channelIdPermissionsMap.get(channel.id);\n                    const permissionSet = channelPermissions || new Set<Permission>();\n\n                    role.permissions.forEach(p => permissionSet.add(p));\n                    channelIdPermissionsMap.set(channel.id, permissionSet);\n                    channelIdCodeMap.set(channel.id, channel.code);\n                }\n            }\n\n            this.selectedRolePermissions = {} as any;\n            for (const channelId of Array.from(channelIdPermissionsMap.keys())) {\n                // tslint:disable-next-line:no-non-null-assertion\n                const permissionSet = channelIdPermissionsMap.get(channelId)!;\n                const permissionsHash: { [K in Permission]: boolean } = {} as any;\n                for (const def of this.serverConfigService.getPermissionDefinitions()) {\n                    permissionsHash[def.name] = permissionSet.has(def.name as Permission);\n                }\n                this.selectedRolePermissions[channelId] = {\n                    // tslint:disable:no-non-null-assertion\n                    channelId,\n                    channelCode: channelIdCodeMap.get(channelId)!,\n                    permissions: permissionsHash,\n                    // tslint:enable:no-non-null-assertion\n                };\n            }\n        }\n    }\n}\n","<vdr-action-bar>\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId=\"administrator-list\"></vdr-action-bar-items>\n        <a class=\"btn btn-primary\" [routerLink]=\"['./create']\" *vdrIfPermissions=\"'CreateAdministrator'\">\n            <clr-icon shape=\"plus\"></clr-icon>\n            {{ 'admin.create-new-administrator' | translate }}\n        </a>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<vdr-data-table\n    [items]=\"items$ | async\"\n    [itemsPerPage]=\"itemsPerPage$ | async\"\n    [totalItems]=\"totalItems$ | async\"\n    [currentPage]=\"currentPage$ | async\"\n    (pageChange)=\"setPageNumber($event)\"\n    (itemsPerPageChange)=\"setItemsPerPage($event)\"\n>\n    <vdr-dt-column>{{ 'settings.first-name' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ 'settings.last-name' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ 'settings.email-address' | translate }}</vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <ng-template let-administrator=\"item\">\n        <td class=\"left align-middle\">{{ administrator.firstName }}</td>\n        <td class=\"left align-middle\">{{ administrator.lastName }}</td>\n        <td class=\"left align-middle\">{{ administrator.emailAddress }}</td>\n        <td class=\"right align-middle\">\n            <vdr-table-row-action\n                iconShape=\"edit\"\n                [label]=\"'common.edit' | translate\"\n                [linkTo]=\"['./', administrator.id]\"\n            ></vdr-table-row-action>\n        </td>\n        <td>\n            <vdr-dropdown>\n                <button type=\"button\" class=\"btn btn-link btn-sm\" vdrDropdownTrigger>\n                    {{ 'common.actions' | translate }}\n                    <clr-icon shape=\"caret down\"></clr-icon>\n                </button>\n                <vdr-dropdown-menu vdrPosition=\"bottom-right\">\n                    <button\n                        type=\"button\"\n                        class=\"delete-button\"\n                        (click)=\"deleteAdministrator(administrator)\"\n                        [disabled]=\"!('DeleteAdministrator' | hasPermission)\"\n                        vdrDropdownItem\n                    >\n                        <clr-icon shape=\"trash\" class=\"is-danger\"></clr-icon>\n                        {{ 'common.delete' | translate }}\n                    </button>\n                </vdr-dropdown-menu>\n            </vdr-dropdown>\n        </td>\n    </ng-template>\n</vdr-data-table>\n","import { Component } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport {\n    BaseListComponent,\n    DataService,\n    GetAdministrators,\n    ModalService,\n    NotificationService,\n} from '@vendure/admin-ui/core';\nimport { EMPTY } from 'rxjs';\nimport { switchMap } from 'rxjs/operators';\n\n@Component({\n    selector: 'vdr-administrator-list',\n    templateUrl: './administrator-list.component.html',\n    styleUrls: ['./administrator-list.component.scss'],\n})\nexport class AdministratorListComponent extends BaseListComponent<\n    GetAdministrators.Query,\n    GetAdministrators.Items\n> {\n    constructor(\n        private dataService: DataService,\n        router: Router,\n        route: ActivatedRoute,\n        private modalService: ModalService,\n        private notificationService: NotificationService,\n    ) {\n        super(router, route);\n        super.setQueryFn(\n            (...args: any[]) => this.dataService.administrator.getAdministrators(...args),\n            (data) => data.administrators,\n        );\n    }\n\n    deleteAdministrator(administrator: GetAdministrators.Items) {\n        return this.modalService\n            .dialog({\n                title: _('catalog.confirm-delete-administrator'),\n                body: `${administrator.firstName} ${administrator.lastName}`,\n                buttons: [\n                    { type: 'secondary', label: _('common.cancel') },\n                    { type: 'danger', label: _('common.delete'), returnValue: true },\n                ],\n            })\n            .pipe(\n                switchMap((res) =>\n                    res ? this.dataService.administrator.deleteAdministrator(administrator.id) : EMPTY,\n                ),\n            )\n            .subscribe(\n                () => {\n                    this.notificationService.success(_('common.notify-delete-success'), {\n                        entity: 'Administrator',\n                    });\n                    this.refresh();\n                },\n                (err) => {\n                    this.notificationService.error(_('common.notify-delete-error'), {\n                        entity: 'Administrator',\n                    });\n                },\n            );\n    }\n}\n","<vdr-action-bar>\n    <vdr-ab-left>\n        <vdr-entity-info [entity]=\"entity$ | async\"></vdr-entity-info>\n    </vdr-ab-left>\n\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId=\"channel-detail\"></vdr-action-bar-items>\n        <button\n            class=\"btn btn-primary\"\n            *ngIf=\"isNew$ | async; else updateButton\"\n            (click)=\"create()\"\n            [disabled]=\"!saveButtonEnabled()\"\n        >\n            {{ 'common.create' | translate }}\n        </button>\n        <ng-template #updateButton>\n            <button\n                class=\"btn btn-primary\"\n                (click)=\"save()\"\n                *vdrIfPermissions=\"['SuperAdmin', 'UpdateChannel']\"\n                [disabled]=\"!saveButtonEnabled()\"\n            >\n                {{ 'common.update' | translate }}\n            </button>\n        </ng-template>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<form class=\"form\" [formGroup]=\"detailForm\">\n    <vdr-form-field [label]=\"'common.code' | translate\" for=\"code\">\n        <input\n            id=\"code\"\n            type=\"text\"\n            [readonly]=\"!(updatePermission | hasPermission)\"\n            formControlName=\"code\"\n        />\n    </vdr-form-field>\n    <vdr-form-field [label]=\"'settings.channel-token' | translate\" for=\"token\">\n        <input\n            id=\"token\"\n            type=\"text\"\n            [readonly]=\"!(updatePermission | hasPermission)\"\n            formControlName=\"token\"\n        />\n    </vdr-form-field>\n    <vdr-form-field [label]=\"'settings.currency' | translate\" for=\"defaultTaxZoneId\">\n        <select\n            clrSelect\n            name=\"currencyCode\"\n            formControlName=\"currencyCode\"\n            [vdrDisabled]=\"!(updatePermission | hasPermission)\"\n        >\n            <option *ngFor=\"let code of currencyCodes\" [value]=\"code\">{{ code | localeCurrencyName }}</option>\n        </select>\n    </vdr-form-field>\n    <vdr-form-field [label]=\"'common.default-language' | translate\" for=\"defaultLanguage\">\n        <select\n            clrSelect\n            name=\"defaultLanguageCode\"\n            formControlName=\"defaultLanguageCode\"\n            [vdrDisabled]=\"!(updatePermission | hasPermission)\"\n        >\n            <option *ngFor=\"let languageCode of availableLanguageCodes$ | async\" [value]=\"languageCode\">\n                {{ languageCode | localeLanguageName }} ({{ languageCode | uppercase }})\n            </option>\n        </select>\n    </vdr-form-field>\n    <vdr-form-field [label]=\"'settings.prices-include-tax' | translate\" for=\"pricesIncludeTax\">\n        <clr-toggle-wrapper>\n            <input\n                type=\"checkbox\"\n                clrToggle\n                id=\"pricesIncludeTax\"\n                formControlName=\"pricesIncludeTax\"\n                [vdrDisabled]=\"!(updatePermission | hasPermission)\"\n            />\n        </clr-toggle-wrapper>\n    </vdr-form-field>\n    <vdr-form-field [label]=\"'settings.default-tax-zone' | translate\" for=\"defaultTaxZoneId\">\n        <select\n            clrSelect\n            name=\"defaultTaxZoneId\"\n            formControlName=\"defaultTaxZoneId\"\n            [vdrDisabled]=\"!(updatePermission | hasPermission)\"\n        >\n            <option selected value style=\"display: none\"></option>\n            <option *ngFor=\"let zone of zones$ | async\" [value]=\"zone.id\">{{ zone.name }}</option>\n        </select>\n    </vdr-form-field>\n    <clr-alert\n        *ngIf=\"detailForm.value.code && !detailForm.value.defaultTaxZoneId\"\n        clrAlertType=\"danger\"\n        [clrAlertClosable]=\"false\"\n    >\n        <clr-alert-item>\n            <span class=\"alert-text\">\n                {{ 'error.no-default-tax-zone-set' | translate }}\n            </span>\n        </clr-alert-item>\n    </clr-alert>\n\n    <vdr-form-field [label]=\"'settings.default-shipping-zone' | translate\" for=\"defaultShippingZoneId\">\n        <select\n            clrSelect\n            name=\"defaultShippingZoneId\"\n            formControlName=\"defaultShippingZoneId\"\n            [vdrDisabled]=\"!(updatePermission | hasPermission)\"\n        >\n            <option selected value style=\"display: none\"></option>\n            <option *ngFor=\"let zone of zones$ | async\" [value]=\"zone.id\">{{ zone.name }}</option>\n        </select>\n    </vdr-form-field>\n    <clr-alert\n        *ngIf=\"detailForm.value.code && !detailForm.value.defaultShippingZoneId\"\n        clrAlertType=\"warning\"\n        [clrAlertClosable]=\"false\"\n    >\n        <clr-alert-item>\n            <span class=\"alert-text\">\n                {{ 'error.no-default-shipping-zone-set' | translate }}\n            </span>\n        </clr-alert-item>\n    </clr-alert>\n\n    <section formGroupName=\"customFields\" *ngIf=\"customFields.length\">\n        <label>{{ 'common.custom-fields' | translate }}</label>\n        <vdr-tabbed-custom-fields\n            entityName=\"Channel\"\n            [customFields]=\"customFields\"\n            [customFieldsFormGroup]=\"detailForm.get('customFields')\"\n            [readonly]=\"!(updatePermission | hasPermission)\"\n        ></vdr-tabbed-custom-fields>\n    </section>\n    <vdr-custom-detail-component-host\n        locationId=\"channel-detail\"\n        [entity$]=\"entity$\"\n        [detailForm]=\"detailForm\"\n    ></vdr-custom-detail-component-host>\n</form>\n","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, OnDestroy, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport { BaseDetailComponent, CustomFieldConfig, Permission } from '@vendure/admin-ui/core';\nimport {\n    Channel,\n    CreateChannelInput,\n    CurrencyCode,\n    GetZones,\n    LanguageCode,\n    UpdateChannelInput,\n} from '@vendure/admin-ui/core';\nimport { getDefaultUiLanguage } from '@vendure/admin-ui/core';\nimport { NotificationService } from '@vendure/admin-ui/core';\nimport { DataService } from '@vendure/admin-ui/core';\nimport { ServerConfigService } from '@vendure/admin-ui/core';\nimport { DEFAULT_CHANNEL_CODE } from '@vendure/common/lib/shared-constants';\nimport { Observable } from 'rxjs';\nimport { map, mergeMap, take } from 'rxjs/operators';\n@Component({\n    selector: 'vdr-channel-detail',\n    templateUrl: './channel-detail.component.html',\n    styleUrls: ['./channel-detail.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ChannelDetailComponent\n    extends BaseDetailComponent<Channel.Fragment>\n    implements OnInit, OnDestroy\n{\n    customFields: CustomFieldConfig[];\n    zones$: Observable<GetZones.Zones[]>;\n    detailForm: FormGroup;\n    currencyCodes = Object.values(CurrencyCode);\n    availableLanguageCodes$: Observable<LanguageCode[]>;\n    readonly updatePermission = [Permission.SuperAdmin, Permission.UpdateChannel, Permission.CreateChannel];\n\n    constructor(\n        router: Router,\n        route: ActivatedRoute,\n        protected serverConfigService: ServerConfigService,\n        private changeDetector: ChangeDetectorRef,\n        protected dataService: DataService,\n        private formBuilder: FormBuilder,\n        private notificationService: NotificationService,\n    ) {\n        super(route, router, serverConfigService, dataService);\n        this.customFields = this.getCustomFieldConfig('Channel');\n        this.detailForm = this.formBuilder.group({\n            code: ['', Validators.required],\n            token: ['', Validators.required],\n            pricesIncludeTax: [false],\n            currencyCode: [''],\n            defaultShippingZoneId: ['', Validators.required],\n            defaultLanguageCode: [],\n            defaultTaxZoneId: ['', Validators.required],\n            customFields: this.formBuilder.group(\n                this.customFields.reduce((hash, field) => ({ ...hash, [field.name]: '' }), {}),\n            ),\n        });\n    }\n\n    ngOnInit() {\n        this.init();\n        this.zones$ = this.dataService.settings.getZones().mapSingle(data => data.zones);\n        this.availableLanguageCodes$ = this.serverConfigService.getAvailableLanguages();\n    }\n\n    ngOnDestroy() {\n        this.destroy();\n    }\n\n    saveButtonEnabled(): boolean {\n        return this.detailForm.dirty && this.detailForm.valid;\n    }\n\n    create() {\n        if (!this.detailForm.dirty) {\n            return;\n        }\n        const formValue = this.detailForm.value;\n        const input: CreateChannelInput = {\n            code: formValue.code,\n            token: formValue.token,\n            defaultLanguageCode: formValue.defaultLanguageCode,\n            pricesIncludeTax: formValue.pricesIncludeTax,\n            currencyCode: formValue.currencyCode,\n            defaultShippingZoneId: formValue.defaultShippingZoneId,\n            defaultTaxZoneId: formValue.defaultTaxZoneId,\n            customFields: formValue.customFields,\n        };\n        this.dataService.settings\n            .createChannel(input)\n            .pipe(\n                mergeMap(({ createChannel }) =>\n                    this.dataService.auth.currentUser().single$.pipe(\n                        map(({ me }) => ({\n                            me,\n                            createChannel,\n                        })),\n                    ),\n                ),\n                mergeMap(({ me, createChannel }) =>\n                    // tslint:disable-next-line:no-non-null-assertion\n                    this.dataService.client.updateUserChannels(me!.channels).pipe(map(() => createChannel)),\n                ),\n            )\n            .subscribe(data => {\n                switch (data.__typename) {\n                    case 'Channel':\n                        this.notificationService.success(_('common.notify-create-success'), {\n                            entity: 'Channel',\n                        });\n                        this.detailForm.markAsPristine();\n                        this.changeDetector.markForCheck();\n                        this.router.navigate(['../', data.id], { relativeTo: this.route });\n                        break;\n                    case 'LanguageNotAvailableError':\n                        this.notificationService.error(data.message);\n                        break;\n                }\n            });\n    }\n\n    save() {\n        if (!this.detailForm.dirty) {\n            return;\n        }\n        const formValue = this.detailForm.value;\n        this.entity$\n            .pipe(\n                take(1),\n                mergeMap(channel => {\n                    const input = {\n                        id: channel.id,\n                        code: formValue.code,\n                        token: formValue.token,\n                        pricesIncludeTax: formValue.pricesIncludeTax,\n                        currencyCode: formValue.currencyCode,\n                        defaultShippingZoneId: formValue.defaultShippingZoneId,\n                        defaultLanguageCode: formValue.defaultLanguageCode,\n                        defaultTaxZoneId: formValue.defaultTaxZoneId,\n                        customFields: formValue.customFields,\n                    } as UpdateChannelInput;\n                    return this.dataService.settings.updateChannel(input);\n                }),\n            )\n            .subscribe(({ updateChannel }) => {\n                switch (updateChannel.__typename) {\n                    case 'Channel':\n                        this.notificationService.success(_('common.notify-update-success'), {\n                            entity: 'Channel',\n                        });\n                        this.detailForm.markAsPristine();\n                        this.changeDetector.markForCheck();\n                        break;\n                    case 'LanguageNotAvailableError':\n                        this.notificationService.error(updateChannel.message);\n                }\n            });\n    }\n\n    /**\n     * Update the form values when the entity changes.\n     */\n    protected setFormValues(entity: Channel.Fragment, languageCode: LanguageCode): void {\n        this.detailForm.patchValue({\n            code: entity.code,\n            token: entity.token || this.generateToken(),\n            pricesIncludeTax: entity.pricesIncludeTax,\n            currencyCode: entity.currencyCode,\n            defaultShippingZoneId: entity.defaultShippingZone ? entity.defaultShippingZone.id : '',\n            defaultLanguageCode: entity.defaultLanguageCode,\n            defaultTaxZoneId: entity.defaultTaxZone ? entity.defaultTaxZone.id : '',\n        });\n        if (this.customFields.length) {\n            this.setCustomFieldFormValues(this.customFields, this.detailForm.get(['customFields']), entity);\n        }\n        if (entity.code === DEFAULT_CHANNEL_CODE) {\n            const codeControl = this.detailForm.get('code');\n            if (codeControl) {\n                codeControl.disable();\n            }\n        }\n    }\n\n    private generateToken(): string {\n        const randomString = () => Math.random().toString(36).substr(3, 10);\n        return `${randomString()}${randomString()}`;\n    }\n}\n","<vdr-action-bar>\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId=\"channel-list\"></vdr-action-bar-items>\n        <a class=\"btn btn-primary\" [routerLink]=\"['./create']\" *vdrIfPermissions=\"['SuperAdmin', 'CreateChannel']\">\n            <clr-icon shape=\"plus\"></clr-icon>\n            {{ 'settings.create-new-channel' | translate }}\n        </a>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<vdr-data-table [items]=\"channels$ | async\">\n    <vdr-dt-column>{{ 'common.code' | translate }}</vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <ng-template let-channel=\"item\">\n        <td class=\"left align-middle\">\n            <vdr-channel-badge [channelCode]=\"channel.code\"></vdr-channel-badge>\n            {{ channel.code | channelCodeToLabel | translate }}\n        </td>\n        <td class=\"right align-middle\">\n            <vdr-table-row-action\n                iconShape=\"edit\"\n                [label]=\"'common.edit' | translate\"\n                [linkTo]=\"['./', channel.id]\"\n            ></vdr-table-row-action>\n        </td>\n        <td class=\"right align-middle\">\n            <vdr-dropdown>\n                <button type=\"button\" class=\"btn btn-link btn-sm\" vdrDropdownTrigger [disabled]=\"isDefaultChannel(channel.code)\">\n                    {{ 'common.actions' | translate }}\n                    <clr-icon shape=\"caret down\"></clr-icon>\n                </button>\n                <vdr-dropdown-menu vdrPosition=\"bottom-right\">\n                    <button\n                        type=\"button\"\n                        class=\"delete-button\"\n                        (click)=\"deleteChannel(channel.id)\"\n                        [disabled]=\"!(['SuperAdmin', 'DeleteChannel'] | hasPermission)\"\n                        vdrDropdownItem\n                    >\n                        <clr-icon shape=\"trash\" class=\"is-danger\"></clr-icon>\n                        {{ 'common.delete' | translate }}\n                    </button>\n                </vdr-dropdown-menu>\n            </vdr-dropdown>\n        </td>\n    </ng-template>\n</vdr-data-table>\n","import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport { DEFAULT_CHANNEL_CODE } from '@vendure/common/lib/shared-constants';\nimport { EMPTY, Observable, Subject } from 'rxjs';\nimport { mergeMap, startWith, switchMap } from 'rxjs/operators';\n\nimport { Channel } from '@vendure/admin-ui/core';\nimport { NotificationService } from '@vendure/admin-ui/core';\nimport { DataService } from '@vendure/admin-ui/core';\nimport { ModalService } from '@vendure/admin-ui/core';\n\n@Component({\n    selector: 'vdr-channel-list',\n    templateUrl: './channel-list.component.html',\n    styleUrls: ['./channel-list.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ChannelListComponent {\n    channels$: Observable<Channel.Fragment[]>;\n    private refresh$ = new Subject();\n\n    constructor(\n        private dataService: DataService,\n        private modalService: ModalService,\n        private notificationService: NotificationService,\n    ) {\n        this.channels$ = this.refresh$.pipe(\n            startWith(1),\n            switchMap(() => this.dataService.settings.getChannels().mapStream(data => data.channels)),\n        );\n    }\n\n    isDefaultChannel(channelCode: string): boolean {\n        return channelCode === DEFAULT_CHANNEL_CODE;\n    }\n\n    deleteChannel(id: string) {\n        this.modalService\n            .dialog({\n                title: _('catalog.confirm-delete-channel'),\n                buttons: [\n                    { type: 'secondary', label: _('common.cancel') },\n                    { type: 'danger', label: _('common.delete'), returnValue: true },\n                ],\n            })\n            .pipe(\n                switchMap(response => (response ? this.dataService.settings.deleteChannel(id) : EMPTY)),\n                mergeMap(() => this.dataService.auth.currentUser().single$),\n                // tslint:disable-next-line:no-non-null-assertion\n                mergeMap(data => this.dataService.client.updateUserChannels(data.me!.channels)),\n            )\n            .subscribe(\n                () => {\n                    this.notificationService.success(_('common.notify-delete-success'), {\n                        entity: 'Channel',\n                    });\n                    this.refresh$.next(1);\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-delete-error'), {\n                        entity: 'Channel',\n                    });\n                },\n            );\n    }\n}\n","<vdr-action-bar>\n    <vdr-ab-left>\n        <vdr-entity-info [entity]=\"entity$ | async\"></vdr-entity-info>\n        <vdr-language-selector\n            [disabled]=\"isNew$ | async\"\n            [availableLanguageCodes]=\"availableLanguages$ | async\"\n            [currentLanguageCode]=\"languageCode$ | async\"\n            (languageCodeChange)=\"setLanguage($event)\"\n        ></vdr-language-selector>\n    </vdr-ab-left>\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId=\"country-detail\"></vdr-action-bar-items>\n        <button\n            class=\"btn btn-primary\"\n            *ngIf=\"isNew$ | async; else updateButton\"\n            (click)=\"create()\"\n            [disabled]=\"detailForm.invalid || detailForm.pristine\"\n        >\n            {{ 'common.create' | translate }}\n        </button>\n        <ng-template #updateButton>\n            <button\n                class=\"btn btn-primary\"\n                *vdrIfPermissions=\"updatePermission\"\n                (click)=\"save()\"\n                [disabled]=\"detailForm.invalid || detailForm.pristine\"\n            >\n                {{ 'common.update' | translate }}\n            </button>\n        </ng-template>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<form class=\"form\" [formGroup]=\"detailForm\">\n    <vdr-form-field [label]=\"'common.code' | translate\" for=\"code\">\n        <input\n            id=\"code\"\n            type=\"text\"\n            formControlName=\"code\"\n            [readonly]=\"!(updatePermission | hasPermission)\"\n        />\n    </vdr-form-field>\n    <vdr-form-field [label]=\"'common.name' | translate\" for=\"name\">\n        <input\n            id=\"name\"\n            type=\"text\"\n            formControlName=\"name\"\n            [readonly]=\"!(updatePermission | hasPermission)\"\n        />\n    </vdr-form-field>\n    <vdr-form-field [label]=\"'common.enabled' | translate\" for=\"enabled\">\n        <clr-toggle-wrapper>\n            <input\n                type=\"checkbox\"\n                clrToggle\n                id=\"enabled\"\n                formControlName=\"enabled\"\n                [vdrDisabled]=\"!(updatePermission | hasPermission)\"\n            />\n        </clr-toggle-wrapper>\n    </vdr-form-field>\n    <section formGroupName=\"customFields\" *ngIf=\"customFields.length\">\n        <label>{{ 'common.custom-fields' | translate }}</label>\n        <vdr-tabbed-custom-fields\n            entityName=\"Country\"\n            [customFields]=\"customFields\"\n            [customFieldsFormGroup]=\"detailForm.get('customFields')\"\n            [readonly]=\"!(updatePermission | hasPermission)\"\n        ></vdr-tabbed-custom-fields>\n    </section>\n    <vdr-custom-detail-component-host\n        locationId=\"country-detail\"\n        [entity$]=\"entity$\"\n        [detailForm]=\"detailForm\"\n    ></vdr-custom-detail-component-host>\n</form>\n","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, OnDestroy, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport {\n    BaseDetailComponent,\n    Country,\n    CreateCountryInput,\n    createUpdatedTranslatable,\n    CustomFieldConfig,\n    DataService,\n    findTranslation,\n    LanguageCode,\n    NotificationService,\n    Permission,\n    ServerConfigService,\n    UpdateCountryInput,\n} from '@vendure/admin-ui/core';\nimport { combineLatest, Observable } from 'rxjs';\nimport { mergeMap, take } from 'rxjs/operators';\n\n@Component({\n    selector: 'vdr-country-detail',\n    templateUrl: './country-detail.component.html',\n    styleUrls: ['./country-detail.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class CountryDetailComponent\n    extends BaseDetailComponent<Country.Fragment>\n    implements OnInit, OnDestroy\n{\n    country$: Observable<Country.Fragment>;\n    detailForm: FormGroup;\n    customFields: CustomFieldConfig[];\n    readonly updatePermission = [Permission.UpdateSettings, Permission.UpdateCountry];\n\n    constructor(\n        router: Router,\n        route: ActivatedRoute,\n        serverConfigService: ServerConfigService,\n        private changeDetector: ChangeDetectorRef,\n        protected dataService: DataService,\n        private formBuilder: FormBuilder,\n        private notificationService: NotificationService,\n    ) {\n        super(route, router, serverConfigService, dataService);\n        this.customFields = this.getCustomFieldConfig('Country');\n        this.detailForm = this.formBuilder.group({\n            code: ['', Validators.required],\n            name: ['', Validators.required],\n            enabled: [true],\n            customFields: this.formBuilder.group(\n                this.customFields.reduce((hash, field) => ({ ...hash, [field.name]: '' }), {}),\n            ),\n        });\n    }\n\n    ngOnInit() {\n        this.init();\n        this.country$ = this.entity$;\n    }\n\n    ngOnDestroy(): void {\n        this.destroy();\n    }\n\n    create() {\n        if (!this.detailForm.dirty) {\n            return;\n        }\n        combineLatest(this.country$, this.languageCode$)\n            .pipe(\n                take(1),\n                mergeMap(([country, languageCode]) => {\n                    const formValue = this.detailForm.value;\n                    const input: CreateCountryInput = createUpdatedTranslatable({\n                        translatable: country,\n                        updatedFields: formValue,\n                        customFieldConfig: this.customFields,\n                        languageCode,\n                        defaultTranslation: {\n                            name: formValue.name,\n                            languageCode,\n                        },\n                    });\n                    return this.dataService.settings.createCountry(input);\n                }),\n            )\n            .subscribe(\n                data => {\n                    this.notificationService.success(_('common.notify-create-success'), {\n                        entity: 'Country',\n                    });\n                    this.detailForm.markAsPristine();\n                    this.changeDetector.markForCheck();\n                    this.router.navigate(['../', data.createCountry.id], { relativeTo: this.route });\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-create-error'), {\n                        entity: 'Country',\n                    });\n                },\n            );\n    }\n\n    save() {\n        combineLatest(this.country$, this.languageCode$)\n            .pipe(\n                take(1),\n                mergeMap(([country, languageCode]) => {\n                    const formValue = this.detailForm.value;\n                    const input: UpdateCountryInput = createUpdatedTranslatable({\n                        translatable: country,\n                        updatedFields: formValue,\n                        customFieldConfig: this.customFields,\n                        languageCode,\n                        defaultTranslation: {\n                            name: formValue.name,\n                            languageCode,\n                        },\n                    });\n                    return this.dataService.settings.updateCountry(input);\n                }),\n            )\n            .subscribe(\n                data => {\n                    this.notificationService.success(_('common.notify-update-success'), {\n                        entity: 'Country',\n                    });\n                    this.detailForm.markAsPristine();\n                    this.changeDetector.markForCheck();\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-update-error'), {\n                        entity: 'Country',\n                    });\n                },\n            );\n    }\n\n    protected setFormValues(country: Country, languageCode: LanguageCode): void {\n        const currentTranslation = findTranslation(country, languageCode);\n\n        this.detailForm.patchValue({\n            code: country.code,\n            name: currentTranslation ? currentTranslation.name : '',\n            enabled: country.enabled,\n        });\n\n        if (this.customFields.length) {\n            this.setCustomFieldFormValues(\n                this.customFields,\n                this.detailForm.get(['customFields']),\n                country,\n                currentTranslation,\n            );\n        }\n    }\n}\n","<vdr-action-bar>\n    <vdr-ab-left>\n        <input\n            type=\"text\"\n            name=\"searchTerm\"\n            [formControl]=\"searchTerm\"\n            [placeholder]=\"'settings.search-country-by-name' | translate\"\n            class=\"search-input\"\n        />\n        <div>\n            <vdr-language-selector\n                [availableLanguageCodes]=\"availableLanguages$ | async\"\n                [currentLanguageCode]=\"contentLanguage$ | async\"\n                (languageCodeChange)=\"setLanguage($event)\"\n            ></vdr-language-selector>\n        </div>\n    </vdr-ab-left>\n\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId=\"country-list\"></vdr-action-bar-items>\n        <a\n            class=\"btn btn-primary\"\n            [routerLink]=\"['./create']\"\n            *vdrIfPermissions=\"['CreateSettings', 'CreateCountry']\"\n        >\n            <clr-icon shape=\"plus\"></clr-icon>\n            {{ 'settings.create-new-country' | translate }}\n        </a>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<vdr-data-table [items]=\"countriesWithZones$ | async\">\n    <vdr-dt-column>{{ 'common.code' | translate }}</vdr-dt-column>\n    <vdr-dt-column [expand]=\"true\">{{ 'common.name' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ 'settings.zone' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ 'common.enabled' | translate }}</vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <ng-template let-country=\"item\">\n        <td class=\"left align-middle\">{{ country.code }}</td>\n        <td class=\"left align-middle\">{{ country.name }}</td>\n        <td class=\"left align-middle\">\n            <a\n                [routerLink]=\"['/settings', 'zones', { contents: zone.id }]\"\n                *ngFor=\"let zone of country.zones\"\n            >\n                <vdr-chip [colorFrom]=\"zone.name\">{{ zone.name }}</vdr-chip>\n            </a>\n        </td>\n        <td class=\"left align-middle\">\n            <clr-icon\n                [class.is-success]=\"country.enabled\"\n                [attr.shape]=\"country.enabled ? 'check' : 'times'\"\n            ></clr-icon>\n        </td>\n        <td class=\"right align-middle\">\n            <vdr-table-row-action\n                iconShape=\"edit\"\n                [label]=\"'common.edit' | translate\"\n                [linkTo]=\"['./', country.id]\"\n            ></vdr-table-row-action>\n        </td>\n        <td class=\"right align-middle\">\n            <vdr-dropdown>\n                <button type=\"button\" class=\"btn btn-link btn-sm\" vdrDropdownTrigger>\n                    {{ 'common.actions' | translate }}\n                    <clr-icon shape=\"caret down\"></clr-icon>\n                </button>\n                <vdr-dropdown-menu vdrPosition=\"bottom-right\">\n                    <button\n                        type=\"button\"\n                        class=\"delete-button\"\n                        (click)=\"deleteCountry(country.id)\"\n                        vdrDropdownItem\n                        [disabled]=\"!(['DeleteSettings', 'DeleteCountry'] | hasPermission)\"\n                    >\n                        <clr-icon shape=\"trash\" class=\"is-danger\"></clr-icon>\n                        {{ 'common.delete' | translate }}\n                    </button>\n                </vdr-dropdown-menu>\n            </vdr-dropdown>\n        </td>\n    </ng-template>\n</vdr-data-table>\n","import { ChangeDetectionStrategy, Component, OnDestroy, OnInit } from '@angular/core';\nimport { FormControl } from '@angular/forms';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport {\n    DataService,\n    DeletionResult,\n    GetCountryList,\n    GetZones,\n    LanguageCode,\n    ModalService,\n    NotificationService,\n    ServerConfigService,\n    Zone,\n} from '@vendure/admin-ui/core';\nimport { combineLatest, EMPTY, Observable, Subject } from 'rxjs';\nimport { map, startWith, switchMap, tap } from 'rxjs/operators';\n\n@Component({\n    selector: 'vdr-country-list',\n    templateUrl: './country-list.component.html',\n    styleUrls: ['./country-list.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class CountryListComponent implements OnInit, OnDestroy {\n    searchTerm = new FormControl('');\n    countriesWithZones$: Observable<Array<GetCountryList.Items & { zones: GetZones.Zones[] }>>;\n    zones$: Observable<GetZones.Zones[]>;\n    availableLanguages$: Observable<LanguageCode[]>;\n    contentLanguage$: Observable<LanguageCode>;\n\n    private countries: GetCountryList.Items[] = [];\n    private destroy$ = new Subject<void>();\n    private refresh$ = new Subject<void>();\n\n    constructor(\n        private dataService: DataService,\n        private notificationService: NotificationService,\n        private modalService: ModalService,\n        private serverConfigService: ServerConfigService,\n    ) {}\n\n    ngOnInit() {\n        this.contentLanguage$ = this.dataService.client\n            .uiState()\n            .mapStream(({ uiState }) => uiState.contentLanguage);\n\n        const countries$ = combineLatest(\n            this.contentLanguage$,\n            this.searchTerm.valueChanges.pipe(startWith(null)),\n        ).pipe(\n            map(([__, term]) => term),\n            switchMap(term => this.dataService.settings.getCountries(999, 0, term).single$),\n            tap(data => {\n                this.countries = data.countries.items;\n            }),\n            map(data => data.countries.items),\n        );\n\n        this.zones$ = this.dataService.settings.getZones().mapStream(data => data.zones);\n\n        this.countriesWithZones$ = combineLatest(countries$, this.zones$).pipe(\n            map(([countries, zones]) => {\n                return countries.map(country => ({\n                    ...country,\n                    zones: zones.filter(z => !!z.members.find(c => c.id === country.id)),\n                }));\n            }),\n        );\n\n        this.availableLanguages$ = this.serverConfigService.getAvailableLanguages();\n    }\n\n    ngOnDestroy() {\n        this.destroy$.next(undefined);\n        this.destroy$.complete();\n    }\n\n    setLanguage(code: LanguageCode) {\n        this.dataService.client.setContentLanguage(code).subscribe();\n    }\n\n    deleteCountry(countryId: string) {\n        this.modalService\n            .dialog({\n                title: _('catalog.confirm-delete-country'),\n                buttons: [\n                    { type: 'secondary', label: _('common.cancel') },\n                    { type: 'danger', label: _('common.delete'), returnValue: true },\n                ],\n            })\n            .pipe(\n                switchMap(response =>\n                    response ? this.dataService.settings.deleteCountry(countryId) : EMPTY,\n                ),\n            )\n            .subscribe(\n                response => {\n                    if (response.deleteCountry.result === DeletionResult.DELETED) {\n                        this.notificationService.success(_('common.notify-delete-success'), {\n                            entity: 'Country',\n                        });\n                        this.dataService.settings.getCountries(999, 0).single$.subscribe();\n                    } else {\n                        this.notificationService.error(response.deleteCountry.message || '');\n                    }\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-delete-error'), {\n                        entity: 'Country',\n                    });\n                },\n            );\n    }\n\n    private isZone(input: Zone.Fragment | { name: string } | string): input is Zone.Fragment {\n        return input.hasOwnProperty('id');\n    }\n}\n","<vdr-action-bar>\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId=\"global-settings-detail\"></vdr-action-bar-items>\n        <button\n            class=\"btn btn-primary\"\n            (click)=\"save()\"\n            *vdrIfPermissions=\"updatePermission\"\n            [disabled]=\"detailForm.invalid || detailForm.pristine\"\n        >\n            {{ 'common.update' | translate }}\n        </button>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<form class=\"form\" [formGroup]=\"detailForm\">\n    <vdr-form-field [label]=\"'common.available-languages' | translate\" for=\"availableLanguages\">\n        <ng-select\n            [items]=\"languageCodes\"\n            [addTag]=\"false\"\n            [hideSelected]=\"true\"\n            multiple=\"true\"\n            appendTo=\"body\"\n            formControlName=\"availableLanguages\"\n        >\n            <ng-template ng-label-tmp let-item=\"item\" let-clear=\"clear\">\n                <span class=\"ng-value-icon left\" (click)=\"clear.call(null, item)\" aria-hidden=\"true\">\n                    ×\n                </span>\n                <span class=\"ng-value-label\">{{ item | localeLanguageName }} ({{ item }})</span>\n            </ng-template>\n            <ng-template ng-option-tmp let-item=\"item\">\n                {{ item | localeLanguageName }} ({{ item }})\n            </ng-template>\n        </ng-select>\n    </vdr-form-field>\n    <vdr-form-field\n        [label]=\"'settings.global-out-of-stock-threshold' | translate\"\n        for=\"outOfStockThreshold\"\n        [tooltip]=\"'settings.global-out-of-stock-threshold-tooltip' | translate\"\n    >\n        <input\n            id=\"outOfStockThreshold\"\n            type=\"number\"\n            formControlName=\"outOfStockThreshold\"\n            [readonly]=\"!(updatePermission | hasPermission)\"\n        />\n    </vdr-form-field>\n    <vdr-form-field\n        [label]=\"'settings.track-inventory-default' | translate\"\n        for=\"enabled\"\n        [tooltip]=\"'catalog.track-inventory-tooltip' | translate\"\n    >\n        <clr-toggle-wrapper>\n            <input\n                type=\"checkbox\"\n                clrToggle\n                name=\"enabled\"\n                formControlName=\"trackInventory\"\n                [vdrDisabled]=\"!(updatePermission | hasPermission)\"\n            />\n        </clr-toggle-wrapper>\n    </vdr-form-field>\n    <section formGroupName=\"customFields\" *ngIf=\"customFields.length\">\n        <label>{{ 'common.custom-fields' | translate }}</label>\n        <vdr-tabbed-custom-fields\n            entityName=\"GlobalSettings\"\n            [customFields]=\"customFields\"\n            [customFieldsFormGroup]=\"detailForm.get('customFields')\"\n            [readonly]=\"!(updatePermission | hasPermission)\"\n        ></vdr-tabbed-custom-fields>\n    </section>\n    <vdr-custom-detail-component-host\n        locationId=\"global-settings-detail\"\n        [entity$]=\"entity$\"\n        [detailForm]=\"detailForm\"\n    ></vdr-custom-detail-component-host>\n</form>\n","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport {\n    BaseDetailComponent,\n    CustomFieldConfig,\n    DataService,\n    GlobalSettings,\n    LanguageCode,\n    NotificationService,\n    Permission,\n    ServerConfigService,\n} from '@vendure/admin-ui/core';\nimport { switchMap, tap, withLatestFrom } from 'rxjs/operators';\n\n@Component({\n    selector: 'vdr-global-settings',\n    templateUrl: './global-settings.component.html',\n    styleUrls: ['./global-settings.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class GlobalSettingsComponent extends BaseDetailComponent<GlobalSettings> implements OnInit {\n    detailForm: FormGroup;\n    customFields: CustomFieldConfig[];\n    languageCodes = Object.values(LanguageCode);\n    readonly updatePermission = [Permission.UpdateSettings, Permission.UpdateGlobalSettings];\n\n    constructor(\n        router: Router,\n        route: ActivatedRoute,\n        serverConfigService: ServerConfigService,\n        private changeDetector: ChangeDetectorRef,\n        protected dataService: DataService,\n        private formBuilder: FormBuilder,\n        private notificationService: NotificationService,\n    ) {\n        super(route, router, serverConfigService, dataService);\n        this.customFields = this.getCustomFieldConfig('GlobalSettings');\n        this.detailForm = this.formBuilder.group({\n            availableLanguages: [''],\n            trackInventory: false,\n            outOfStockThreshold: [0, Validators.required],\n            customFields: this.formBuilder.group(\n                this.customFields.reduce((hash, field) => ({ ...hash, [field.name]: '' }), {}),\n            ),\n        });\n    }\n\n    ngOnInit(): void {\n        this.init();\n        this.dataService.client.userStatus().single$.subscribe(({ userStatus }) => {\n            if (!userStatus.permissions.includes(Permission.UpdateSettings)) {\n                const languagesSelect = this.detailForm.get('availableLanguages');\n                if (languagesSelect) {\n                    languagesSelect.disable();\n                }\n            }\n        });\n    }\n\n    save() {\n        if (!this.detailForm.dirty) {\n            return;\n        }\n\n        this.dataService.settings\n            .updateGlobalSettings(this.detailForm.value)\n            .pipe(\n                tap(({ updateGlobalSettings }) => {\n                    switch (updateGlobalSettings.__typename) {\n                        case 'GlobalSettings':\n                            this.detailForm.markAsPristine();\n                            this.changeDetector.markForCheck();\n                            this.notificationService.success(_('common.notify-update-success'), {\n                                entity: 'Settings',\n                            });\n                            break;\n                        case 'ChannelDefaultLanguageError':\n                            this.notificationService.error(updateGlobalSettings.message);\n                    }\n                }),\n                switchMap(() => this.serverConfigService.refreshGlobalSettings()),\n                withLatestFrom(this.dataService.client.uiState().single$),\n            )\n            .subscribe(([{ globalSettings }, { uiState }]) => {\n                const availableLangs = globalSettings.availableLanguages;\n                if (availableLangs.length && !availableLangs.includes(uiState.contentLanguage)) {\n                    this.dataService.client.setContentLanguage(availableLangs[0]).subscribe();\n                }\n            });\n    }\n\n    protected setFormValues(entity: GlobalSettings, languageCode: LanguageCode): void {\n        this.detailForm.patchValue({\n            availableLanguages: entity.availableLanguages,\n            trackInventory: entity.trackInventory,\n            outOfStockThreshold: entity.outOfStockThreshold,\n        });\n        if (this.customFields.length) {\n            this.setCustomFieldFormValues(this.customFields, this.detailForm.get('customFields'), entity);\n        }\n    }\n}\n","<vdr-action-bar>\n    <vdr-ab-left>\n        <vdr-entity-info [entity]=\"entity$ | async\"></vdr-entity-info>\n    </vdr-ab-left>\n\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId=\"payment-method-detail\"></vdr-action-bar-items>\n        <button\n            class=\"btn btn-primary\"\n            *ngIf=\"isNew$ | async; else updateButton\"\n            [disabled]=\"detailForm.pristine || detailForm.invalid\"\n            (click)=\"create()\"\n        >\n            {{ 'common.create' | translate }}\n        </button>\n        <ng-template #updateButton>\n            <button\n                *vdrIfPermissions=\"updatePermission\"\n                class=\"btn btn-primary\"\n                (click)=\"save()\"\n                [disabled]=\"detailForm.pristine || detailForm.invalid || !selectedHandler\"\n            >\n                {{ 'common.update' | translate }}\n            </button>\n        </ng-template>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<form class=\"form\" [formGroup]=\"detailForm\" *ngIf=\"entity$ | async as paymentMethod\">\n    <vdr-form-field [label]=\"'common.name' | translate\" for=\"name\">\n        <input\n            id=\"name\"\n            type=\"text\"\n            formControlName=\"name\"\n            [readonly]=\"!(updatePermission | hasPermission)\"\n            (input)=\"updateCode(paymentMethod.code, $event.target.value)\"\n        />\n    </vdr-form-field>\n    <vdr-form-field\n        [label]=\"'common.code' | translate\"\n        for=\"code\"\n        [readOnlyToggle]=\"updatePermission | hasPermission\"\n    >\n        <input\n            id=\"code\"\n            type=\"text\"\n            formControlName=\"code\"\n            [readonly]=\"!(updatePermission | hasPermission)\"\n        />\n    </vdr-form-field>\n    <vdr-rich-text-editor\n        formControlName=\"description\"\n        [readonly]=\"!(updatePermission | hasPermission)\"\n        [label]=\"'common.description' | translate\"\n    ></vdr-rich-text-editor>\n    <vdr-form-field [label]=\"'common.enabled' | translate\" for=\"description\">\n        <clr-toggle-wrapper>\n            <input\n                type=\"checkbox\"\n                clrToggle\n                id=\"enabled\"\n                [vdrDisabled]=\"!(updatePermission | hasPermission)\"\n                formControlName=\"enabled\"\n            />\n        </clr-toggle-wrapper>\n    </vdr-form-field>\n    <section formGroupName=\"customFields\" *ngIf=\"customFields.length\">\n        <label>{{ 'common.custom-fields' | translate }}</label>\n        <vdr-tabbed-custom-fields\n            entityName=\"PaymentMethod\"\n            [customFields]=\"customFields\"\n            [customFieldsFormGroup]=\"detailForm.get('customFields')\"\n            [readonly]=\"!(updatePermission | hasPermission)\"\n        ></vdr-tabbed-custom-fields>\n    </section>\n\n    <vdr-custom-detail-component-host\n        locationId=\"payment-method-detail\"\n        [entity$]=\"entity$\"\n        [detailForm]=\"detailForm\"\n    ></vdr-custom-detail-component-host>\n\n    <div class=\"clr-row mt4\">\n        <div class=\"clr-col\">\n            <label class=\"clr-control-label\">{{ 'settings.payment-eligibility-checker' | translate }}</label>\n            <vdr-configurable-input\n                *ngIf=\"selectedChecker && selectedCheckerDefinition\"\n                [operation]=\"selectedChecker\"\n                [operationDefinition]=\"selectedCheckerDefinition\"\n                [readonly]=\"!(updatePermission | hasPermission)\"\n                (remove)=\"removeChecker()\"\n                formControlName=\"checker\"\n            ></vdr-configurable-input>\n            <div *ngIf=\"!selectedChecker || !selectedCheckerDefinition\">\n                <vdr-dropdown>\n                    <button class=\"btn btn-outline\" vdrDropdownTrigger>\n                        <clr-icon shape=\"plus\"></clr-icon>\n                        {{ 'common.select' | translate }}\n                    </button>\n                    <vdr-dropdown-menu vdrPosition=\"bottom-left\">\n                        <button\n                            *ngFor=\"let checker of checkers\"\n                            type=\"button\"\n                            vdrDropdownItem\n                            (click)=\"selectChecker(checker)\"\n                        >\n                            {{ checker.description }}\n                        </button>\n                    </vdr-dropdown-menu>\n                </vdr-dropdown>\n            </div>\n        </div>\n        <div class=\"clr-col\">\n            <label class=\"clr-control-label\">{{ 'settings.payment-handler' | translate }}</label>\n            <vdr-configurable-input\n                *ngIf=\"selectedHandler && selectedHandlerDefinition\"\n                [operation]=\"selectedHandler\"\n                [operationDefinition]=\"selectedHandlerDefinition\"\n                [readonly]=\"!(updatePermission | hasPermission)\"\n                (remove)=\"removeHandler()\"\n                formControlName=\"handler\"\n            ></vdr-configurable-input>\n            <div *ngIf=\"!selectedHandler || !selectedHandlerDefinition\">\n                <vdr-dropdown>\n                    <button class=\"btn btn-outline\" vdrDropdownTrigger>\n                        <clr-icon shape=\"plus\"></clr-icon>\n                        {{ 'common.select' | translate }}\n                    </button>\n                    <vdr-dropdown-menu vdrPosition=\"bottom-left\">\n                        <button\n                            *ngFor=\"let handler of handlers\"\n                            type=\"button\"\n                            vdrDropdownItem\n                            (click)=\"selectHandler(handler)\"\n                        >\n                            {{ handler.description }}\n                        </button>\n                    </vdr-dropdown-menu>\n                </vdr-dropdown>\n            </div>\n        </div>\n    </div>\n</form>\n","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, OnDestroy, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport {\n    BaseDetailComponent,\n    ConfigArgDefinition,\n    configurableDefinitionToInstance,\n    ConfigurableOperation,\n    ConfigurableOperationDefinition,\n    CreatePaymentMethodInput,\n    CustomFieldConfig,\n    DataService,\n    encodeConfigArgValue,\n    getConfigArgValue,\n    NotificationService,\n    PaymentMethod,\n    Permission,\n    ServerConfigService,\n    toConfigurableOperationInput,\n    UpdatePaymentMethodInput,\n} from '@vendure/admin-ui/core';\nimport { normalizeString } from '@vendure/common/lib/normalize-string';\nimport { combineLatest } from 'rxjs';\nimport { mergeMap, take } from 'rxjs/operators';\n\n@Component({\n    selector: 'vdr-payment-method-detail',\n    templateUrl: './payment-method-detail.component.html',\n    styleUrls: ['./payment-method-detail.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class PaymentMethodDetailComponent\n    extends BaseDetailComponent<PaymentMethod.Fragment>\n    implements OnInit, OnDestroy\n{\n    detailForm: FormGroup;\n    customFields: CustomFieldConfig[];\n    checkers: ConfigurableOperationDefinition[] = [];\n    handlers: ConfigurableOperationDefinition[] = [];\n    selectedChecker?: ConfigurableOperation | null;\n    selectedCheckerDefinition?: ConfigurableOperationDefinition;\n    selectedHandler?: ConfigurableOperation | null;\n    selectedHandlerDefinition?: ConfigurableOperationDefinition;\n    readonly updatePermission = [Permission.UpdateSettings, Permission.UpdatePaymentMethod];\n\n    constructor(\n        router: Router,\n        route: ActivatedRoute,\n        serverConfigService: ServerConfigService,\n        private changeDetector: ChangeDetectorRef,\n        protected dataService: DataService,\n        private formBuilder: FormBuilder,\n        private notificationService: NotificationService,\n    ) {\n        super(route, router, serverConfigService, dataService);\n        this.customFields = this.getCustomFieldConfig('PaymentMethod');\n        this.detailForm = this.formBuilder.group({\n            code: ['', Validators.required],\n            name: ['', Validators.required],\n            description: '',\n            enabled: [true, Validators.required],\n            checker: {},\n            handler: {},\n            customFields: this.formBuilder.group(\n                this.customFields.reduce((hash, field) => ({ ...hash, [field.name]: '' }), {}),\n            ),\n        });\n    }\n\n    ngOnInit() {\n        this.init();\n        combineLatest([\n            this.dataService.settings.getPaymentMethodOperations().single$,\n            this.entity$.pipe(take(1)),\n        ]).subscribe(([data, entity]) => {\n            this.checkers = data.paymentMethodEligibilityCheckers;\n            this.handlers = data.paymentMethodHandlers;\n            this.changeDetector.markForCheck();\n            this.selectedCheckerDefinition = data.paymentMethodEligibilityCheckers.find(\n                c => c.code === (entity.checker && entity.checker.code),\n            );\n            this.selectedHandlerDefinition = data.paymentMethodHandlers.find(\n                c => c.code === (entity.handler && entity.handler.code),\n            );\n        });\n    }\n\n    ngOnDestroy(): void {\n        this.destroy();\n    }\n\n    updateCode(currentCode: string, nameValue: string) {\n        if (!currentCode) {\n            const codeControl = this.detailForm.get(['code']);\n            if (codeControl && codeControl.pristine) {\n                codeControl.setValue(normalizeString(nameValue, '-'));\n            }\n        }\n    }\n\n    configArgsIsPopulated(): boolean {\n        const configArgsGroup = this.detailForm.get('configArgs') as FormGroup | undefined;\n        if (!configArgsGroup) {\n            return false;\n        }\n        return 0 < Object.keys(configArgsGroup.controls).length;\n    }\n\n    selectChecker(checker: ConfigurableOperationDefinition) {\n        this.selectedCheckerDefinition = checker;\n        this.selectedChecker = configurableDefinitionToInstance(checker);\n        const formControl = this.detailForm.get('checker');\n        if (formControl) {\n            formControl.clearValidators();\n            formControl.updateValueAndValidity({ onlySelf: true });\n            formControl.patchValue(this.selectedChecker);\n        }\n        this.detailForm.markAsDirty();\n    }\n\n    selectHandler(handler: ConfigurableOperationDefinition) {\n        this.selectedHandlerDefinition = handler;\n        this.selectedHandler = configurableDefinitionToInstance(handler);\n        const formControl = this.detailForm.get('handler');\n        if (formControl) {\n            formControl.clearValidators();\n            formControl.updateValueAndValidity({ onlySelf: true });\n            formControl.patchValue(this.selectedHandler);\n        }\n        this.detailForm.markAsDirty();\n    }\n\n    removeChecker() {\n        this.selectedChecker = null;\n        this.detailForm.markAsDirty();\n    }\n\n    removeHandler() {\n        this.selectedHandler = null;\n        this.detailForm.markAsDirty();\n    }\n\n    create() {\n        const selectedChecker = this.selectedChecker;\n        const selectedHandler = this.selectedHandler;\n        if (!selectedHandler) {\n            return;\n        }\n        this.entity$\n            .pipe(\n                take(1),\n                mergeMap(({ id }) => {\n                    const formValue = this.detailForm.value;\n                    const input: CreatePaymentMethodInput = {\n                        name: formValue.name,\n                        code: formValue.code,\n                        description: formValue.description,\n                        enabled: formValue.enabled,\n                        checker: selectedChecker\n                            ? toConfigurableOperationInput(selectedChecker, formValue.checker)\n                            : null,\n                        handler: toConfigurableOperationInput(selectedHandler, formValue.handler),\n                        customFields: formValue.customFields,\n                    };\n                    return this.dataService.settings.createPaymentMethod(input);\n                }),\n            )\n            .subscribe(\n                data => {\n                    this.notificationService.success(_('common.notify-create-success'), {\n                        entity: 'PaymentMethod',\n                    });\n                    this.detailForm.markAsPristine();\n                    this.changeDetector.markForCheck();\n                    this.router.navigate(['../', data.createPaymentMethod.id], { relativeTo: this.route });\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-create-error'), {\n                        entity: 'PaymentMethod',\n                    });\n                },\n            );\n    }\n\n    save() {\n        const selectedChecker = this.selectedChecker;\n        const selectedHandler = this.selectedHandler;\n        if (!selectedHandler) {\n            return;\n        }\n        this.entity$\n            .pipe(\n                take(1),\n                mergeMap(({ id }) => {\n                    const formValue = this.detailForm.value;\n                    const input: UpdatePaymentMethodInput = {\n                        id,\n                        name: formValue.name,\n                        code: formValue.code,\n                        description: formValue.description,\n                        enabled: formValue.enabled,\n                        checker: selectedChecker\n                            ? toConfigurableOperationInput(selectedChecker, formValue.checker)\n                            : null,\n                        handler: toConfigurableOperationInput(selectedHandler, formValue.handler),\n                        customFields: formValue.customFields,\n                    };\n                    return this.dataService.settings.updatePaymentMethod(input);\n                }),\n            )\n            .subscribe(\n                data => {\n                    this.notificationService.success(_('common.notify-update-success'), {\n                        entity: 'PaymentMethod',\n                    });\n                    this.detailForm.markAsPristine();\n                    this.changeDetector.markForCheck();\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-update-error'), {\n                        entity: 'PaymentMethod',\n                    });\n                },\n            );\n    }\n\n    protected setFormValues(paymentMethod: PaymentMethod.Fragment): void {\n        this.detailForm.patchValue({\n            name: paymentMethod.name,\n            code: paymentMethod.code,\n            description: paymentMethod.description,\n            enabled: paymentMethod.enabled,\n            checker: paymentMethod.checker || {},\n            handler: paymentMethod.handler || {},\n        });\n        if (!this.selectedChecker) {\n            this.selectedChecker = paymentMethod.checker && {\n                code: paymentMethod.checker.code,\n                args: paymentMethod.checker.args.map(a => ({ ...a, value: getConfigArgValue(a.value) })),\n            };\n        }\n        if (!this.selectedHandler) {\n            this.selectedHandler = paymentMethod.handler && {\n                code: paymentMethod.handler.code,\n                args: paymentMethod.handler.args.map(a => ({ ...a, value: getConfigArgValue(a.value) })),\n            };\n        }\n        if (this.customFields.length) {\n            this.setCustomFieldFormValues(\n                this.customFields,\n                this.detailForm.get('customFields'),\n                paymentMethod,\n            );\n        }\n    }\n}\n","<vdr-action-bar>\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId=\"payment-method-list\"></vdr-action-bar-items>\n        <a class=\"btn btn-primary\" [routerLink]=\"['./create']\" *vdrIfPermissions=\"['CreateSettings', 'CreatePaymentMethod']\">\n            <clr-icon shape=\"plus\"></clr-icon>\n            {{ 'settings.create-new-payment-method' | translate }}\n        </a>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<vdr-data-table\n    [items]=\"items$ | async\"\n    [itemsPerPage]=\"itemsPerPage$ | async\"\n    [totalItems]=\"totalItems$ | async\"\n    [currentPage]=\"currentPage$ | async\"\n    (pageChange)=\"setPageNumber($event)\"\n    (itemsPerPageChange)=\"setItemsPerPage($event)\"\n>\n    <vdr-dt-column>{{ 'common.code' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ 'common.enabled' | translate }}</vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <ng-template let-paymentMethod=\"item\">\n        <td class=\"left align-middle\">{{ paymentMethod.code }}</td>\n        <td class=\"left align-middle\">{{ paymentMethod.enabled }}</td>\n        <td class=\"right align-middle\">\n            <vdr-table-row-action\n                iconShape=\"edit\"\n                [label]=\"'common.edit' | translate\"\n                [linkTo]=\"['./', paymentMethod.id]\"\n            ></vdr-table-row-action>\n        </td>\n        <td class=\"right align-middle\">\n            <vdr-dropdown>\n                <button type=\"button\" class=\"btn btn-link btn-sm\" vdrDropdownTrigger>\n                    {{ 'common.actions' | translate }}\n                    <clr-icon shape=\"caret down\"></clr-icon>\n                </button>\n                <vdr-dropdown-menu vdrPosition=\"bottom-right\">\n                    <button\n                        type=\"button\"\n                        class=\"delete-button\"\n                        (click)=\"deletePaymentMethod(paymentMethod.id)\"\n                        [disabled]=\"!(['DeleteSettings', 'DeletePaymentMethod'] | hasPermission)\"\n                        vdrDropdownItem\n                    >\n                        <clr-icon shape=\"trash\" class=\"is-danger\"></clr-icon>\n                        {{ 'common.delete' | translate }}\n                    </button>\n                </vdr-dropdown-menu>\n            </vdr-dropdown>\n        </td>\n    </ng-template>\n</vdr-data-table>\n","import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport {\n    BaseListComponent,\n    DataService,\n    DeletionResult,\n    GetPaymentMethodList,\n    ModalService,\n    NotificationService,\n} from '@vendure/admin-ui/core';\nimport { EMPTY } from 'rxjs';\nimport { map, switchMap } from 'rxjs/operators';\n\n@Component({\n    selector: 'vdr-payment-method-list',\n    templateUrl: './payment-method-list.component.html',\n    styleUrls: ['./payment-method-list.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class PaymentMethodListComponent extends BaseListComponent<\n    GetPaymentMethodList.Query,\n    GetPaymentMethodList.Items\n> {\n    constructor(\n        private dataService: DataService,\n        router: Router,\n        route: ActivatedRoute,\n        private modalService: ModalService,\n        private notificationService: NotificationService,\n    ) {\n        super(router, route);\n        super.setQueryFn(\n            (...args: any[]) => this.dataService.settings.getPaymentMethods(...args).refetchOnChannelChange(),\n            data => data.paymentMethods,\n        );\n    }\n\n    deletePaymentMethod(paymentMethodId: string) {\n        this.showModalAndDelete(paymentMethodId)\n            .pipe(\n                switchMap(response => {\n                    if (response.result === DeletionResult.DELETED) {\n                        return [true];\n                    } else {\n                        return this.showModalAndDelete(paymentMethodId, response.message || '').pipe(\n                            map(r => r.result === DeletionResult.DELETED),\n                        );\n                    }\n                }),\n                // Refresh the cached facets to reflect the changes\n                switchMap(() => this.dataService.settings.getPaymentMethods(100).single$),\n            )\n            .subscribe(\n                () => {\n                    this.notificationService.success(_('common.notify-delete-success'), {\n                        entity: 'PaymentMethod',\n                    });\n                    this.refresh();\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-delete-error'), {\n                        entity: 'PaymentMethod',\n                    });\n                },\n            );\n    }\n\n    private showModalAndDelete(paymentMethodId: string, message?: string) {\n        return this.modalService\n            .dialog({\n                title: _('settings.confirm-delete-payment-method'),\n                body: message,\n                buttons: [\n                    { type: 'secondary', label: _('common.cancel') },\n                    { type: 'danger', label: _('common.delete'), returnValue: true },\n                ],\n            })\n            .pipe(\n                switchMap(res =>\n                    res ? this.dataService.settings.deletePaymentMethod(paymentMethodId, !!message) : EMPTY,\n                ),\n                map(res => res.deletePaymentMethod),\n            );\n    }\n}\n","<vdr-action-bar>\n    <vdr-ab-left>\n        <vdr-entity-info [entity]=\"entity$ | async\"></vdr-entity-info>\n    </vdr-ab-left>\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId=\"administrator-detail\"></vdr-action-bar-items>\n        <button\n            class=\"btn btn-primary\"\n            (click)=\"save()\"\n            [disabled]=\"detailForm.invalid || detailForm.pristine\"\n        >\n            {{ 'common.update' | translate }}\n        </button>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<form class=\"form\" [formGroup]=\"detailForm\">\n    <vdr-form-field [label]=\"'settings.email-address' | translate\" for=\"emailAddress\">\n        <input id=\"emailAddress\" type=\"text\" formControlName=\"emailAddress\"/>\n    </vdr-form-field>\n    <vdr-form-field [label]=\"'settings.first-name' | translate\" for=\"firstName\">\n        <input id=\"firstName\" type=\"text\" formControlName=\"firstName\"/>\n    </vdr-form-field>\n    <vdr-form-field [label]=\"'settings.last-name' | translate\" for=\"lastName\">\n        <input id=\"lastName\" type=\"text\" formControlName=\"lastName\"/>\n    </vdr-form-field>\n    <vdr-form-field *ngIf=\"isNew$ | async\" [label]=\"'settings.password' | translate\" for=\"password\">\n        <input id=\"password\" type=\"password\" formControlName=\"password\"/>\n    </vdr-form-field>\n    <vdr-form-field [label]=\"'settings.password' | translate\" for=\"password\" [readOnlyToggle]=\"true\">\n        <input id=\"password\" type=\"password\" formControlName=\"password\"/>\n    </vdr-form-field>\n    <section formGroupName=\"customFields\" *ngIf=\"customFields.length\">\n        <label>{{ 'common.custom-fields' | translate }}</label>\n        <vdr-tabbed-custom-fields\n            entityName=\"Administrator\"\n            [customFields]=\"customFields\"\n            [customFieldsFormGroup]=\"detailForm.get('customFields')\"\n        ></vdr-tabbed-custom-fields>\n    </section>\n    <vdr-custom-detail-component-host\n        locationId=\"administrator-profile\"\n        [entity$]=\"entity$\"\n        [detailForm]=\"detailForm\"\n    ></vdr-custom-detail-component-host>\n</form>\n","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, OnDestroy, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport {\n    Administrator,\n    BaseDetailComponent,\n    CustomFieldConfig,\n    DataService,\n    GetActiveAdministrator,\n    LanguageCode,\n    NotificationService,\n    ServerConfigService,\n    UpdateActiveAdministratorInput,\n} from '@vendure/admin-ui/core';\nimport { mergeMap, take } from 'rxjs/operators';\n\n@Component({\n    selector: 'vdr-profile',\n    templateUrl: './profile.component.html',\n    styleUrls: ['./profile.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ProfileComponent\n    extends BaseDetailComponent<GetActiveAdministrator.ActiveAdministrator>\n    implements OnInit, OnDestroy\n{\n    customFields: CustomFieldConfig[];\n    detailForm: FormGroup;\n\n    constructor(\n        router: Router,\n        route: ActivatedRoute,\n        serverConfigService: ServerConfigService,\n        private changeDetector: ChangeDetectorRef,\n        protected dataService: DataService,\n        private formBuilder: FormBuilder,\n        private notificationService: NotificationService,\n    ) {\n        super(route, router, serverConfigService, dataService);\n        this.customFields = this.getCustomFieldConfig('Administrator');\n        this.detailForm = this.formBuilder.group({\n            emailAddress: ['', Validators.required],\n            firstName: ['', Validators.required],\n            lastName: ['', Validators.required],\n            password: [''],\n            customFields: this.formBuilder.group(\n                this.customFields.reduce((hash, field) => ({ ...hash, [field.name]: '' }), {}),\n            ),\n        });\n    }\n\n    ngOnInit() {\n        this.init();\n    }\n\n    ngOnDestroy(): void {\n        this.destroy();\n    }\n\n    save() {\n        this.entity$\n            .pipe(\n                take(1),\n                mergeMap(({ id }) => {\n                    const formValue = this.detailForm.value;\n                    const administrator: UpdateActiveAdministratorInput = {\n                        emailAddress: formValue.emailAddress,\n                        firstName: formValue.firstName,\n                        lastName: formValue.lastName,\n                        password: formValue.password,\n                        customFields: formValue.customFields,\n                    };\n                    return this.dataService.administrator.updateActiveAdministrator(administrator);\n                }),\n            )\n            .subscribe(\n                data => {\n                    this.notificationService.success(_('common.notify-update-success'), {\n                        entity: 'Administrator',\n                    });\n                    this.detailForm.markAsPristine();\n                    this.changeDetector.markForCheck();\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-update-error'), {\n                        entity: 'Administrator',\n                    });\n                },\n            );\n    }\n\n    protected setFormValues(administrator: Administrator, languageCode: LanguageCode): void {\n        this.detailForm.patchValue({\n            emailAddress: administrator.emailAddress,\n            firstName: administrator.firstName,\n            lastName: administrator.lastName,\n        });\n        if (this.customFields.length) {\n            this.setCustomFieldFormValues(\n                this.customFields,\n                this.detailForm.get('customFields'),\n                administrator,\n            );\n        }\n    }\n}\n","<vdr-action-bar>\n    <vdr-ab-left>\n        <vdr-entity-info [entity]=\"entity$ | async\"></vdr-entity-info>\n    </vdr-ab-left>\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId=\"role-detail\"></vdr-action-bar-items>\n        <button\n            class=\"btn btn-primary\"\n            *ngIf=\"isNew$ | async; else updateButton\"\n            (click)=\"create()\"\n            [disabled]=\"detailForm.invalid || detailForm.pristine\"\n        >\n            {{ 'common.create' | translate }}\n        </button>\n        <ng-template #updateButton>\n            <button\n                class=\"btn btn-primary\"\n                (click)=\"save()\"\n                *vdrIfPermissions=\"'UpdateAdministrator'\"\n                [disabled]=\"detailForm.invalid || detailForm.pristine\"\n            >\n                {{ 'common.update' | translate }}\n            </button>\n        </ng-template>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<form class=\"form\" [formGroup]=\"detailForm\">\n    <vdr-form-field [label]=\"'common.description' | translate\" for=\"description\">\n        <input\n            id=\"description\"\n            type=\"text\"\n            formControlName=\"description\"\n            [readonly]=\"!('UpdateAdministrator' | hasPermission)\"\n            (input)=\"updateCode($event.target.value)\"\n        />\n    </vdr-form-field>\n    <vdr-form-field\n        [label]=\"'common.code' | translate\"\n        for=\"code\"\n        [readOnlyToggle]=\"'UpdateAdministrator' | hasPermission\"\n    >\n        <input\n            id=\"code\"\n            type=\"text\"\n            formControlName=\"code\"\n            [readonly]=\"!('UpdateAdministrator' | hasPermission)\"\n        />\n    </vdr-form-field>\n    <vdr-form-field [label]=\"'settings.channel' | translate\">\n        <vdr-channel-assignment-control\n            formControlName=\"channelIds\"\n            [vdrDisabled]=\"!('UpdateAdministrator' | hasPermission)\"\n        ></vdr-channel-assignment-control>\n    </vdr-form-field>\n    <label>{{ 'settings.permissions' | translate }}</label>\n    <vdr-permission-grid\n        [permissionDefinitions]=\"permissionDefinitions\"\n        [activePermissions]=\"detailForm.get('permissions')?.value\"\n        (permissionChange)=\"setPermission($event)\"\n        [readonly]=\"!('UpdateAdministrator' | hasPermission)\"\n    ></vdr-permission-grid>\n</form>\n","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, OnDestroy, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport {\n    BaseDetailComponent,\n    CreateRoleInput,\n    DataService,\n    LanguageCode,\n    NotificationService,\n    Permission,\n    PermissionDefinition,\n    Role,\n    ServerConfigService,\n    UpdateRoleInput,\n} from '@vendure/admin-ui/core';\nimport { normalizeString } from '@vendure/common/lib/normalize-string';\nimport { unique } from '@vendure/common/lib/unique';\nimport { Observable } from 'rxjs';\nimport { mergeMap, take } from 'rxjs/operators';\n\n@Component({\n    selector: 'vdr-role-detail',\n    templateUrl: './role-detail.component.html',\n    styleUrls: ['./role-detail.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class RoleDetailComponent extends BaseDetailComponent<Role> implements OnInit, OnDestroy {\n    role$: Observable<Role>;\n    detailForm: FormGroup;\n    permissionDefinitions: PermissionDefinition[];\n    constructor(\n        router: Router,\n        route: ActivatedRoute,\n        serverConfigService: ServerConfigService,\n        private changeDetector: ChangeDetectorRef,\n        protected dataService: DataService,\n        private formBuilder: FormBuilder,\n        private notificationService: NotificationService,\n    ) {\n        super(route, router, serverConfigService, dataService);\n        this.detailForm = this.formBuilder.group({\n            code: ['', Validators.required],\n            description: ['', Validators.required],\n            channelIds: [],\n            permissions: [],\n        });\n    }\n\n    ngOnInit() {\n        this.init();\n        this.role$ = this.entity$;\n        this.permissionDefinitions = this.serverConfigService.getPermissionDefinitions();\n    }\n\n    ngOnDestroy(): void {\n        this.destroy();\n    }\n\n    updateCode(nameValue: string) {\n        const codeControl = this.detailForm.get(['code']);\n        if (codeControl && codeControl.pristine) {\n            codeControl.setValue(normalizeString(nameValue, '-'));\n        }\n    }\n\n    setPermission(change: { permission: string; value: boolean }) {\n        const permissionsControl = this.detailForm.get('permissions');\n        if (permissionsControl) {\n            const currentPermissions = permissionsControl.value as string[];\n            const newValue =\n                change.value === true\n                    ? unique([...currentPermissions, change.permission])\n                    : currentPermissions.filter(p => p !== change.permission);\n            permissionsControl.setValue(newValue);\n            permissionsControl.markAsDirty();\n        }\n    }\n\n    create() {\n        const formValue = this.detailForm.value;\n        const role: CreateRoleInput = formValue;\n        this.dataService.administrator.createRole(role).subscribe(\n            data => {\n                this.notificationService.success(_('common.notify-create-success'), { entity: 'Role' });\n                this.detailForm.markAsPristine();\n                this.changeDetector.markForCheck();\n                this.router.navigate(['../', data.createRole.id], { relativeTo: this.route });\n            },\n            err => {\n                this.notificationService.error(_('common.notify-create-error'), {\n                    entity: 'Role',\n                });\n            },\n        );\n    }\n\n    save() {\n        this.role$\n            .pipe(\n                take(1),\n                mergeMap(({ id }) => {\n                    const formValue = this.detailForm.value;\n                    const role: UpdateRoleInput = { id, ...formValue };\n                    return this.dataService.administrator.updateRole(role);\n                }),\n            )\n            .subscribe(\n                data => {\n                    this.notificationService.success(_('common.notify-update-success'), { entity: 'Role' });\n                    this.detailForm.markAsPristine();\n                    this.changeDetector.markForCheck();\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-update-error'), {\n                        entity: 'Role',\n                    });\n                },\n            );\n    }\n\n    protected setFormValues(role: Role, languageCode: LanguageCode): void {\n        this.detailForm.patchValue({\n            description: role.description,\n            code: role.code,\n            channelIds: role.channels.map(c => c.id),\n            permissions: role.permissions,\n        });\n        // This was required to get the channel selector component to\n        // correctly display its contents. A while spent debugging the root\n        // cause did not yield a solution, therefore this next line.\n        this.changeDetector.detectChanges();\n    }\n}\n","<vdr-action-bar>\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId=\"role-list\"></vdr-action-bar-items>\n        <a class=\"btn btn-primary\" [routerLink]=\"['./create']\" *vdrIfPermissions=\"'CreateAdministrator'\">\n            <clr-icon shape=\"plus\"></clr-icon>\n            {{ 'settings.create-new-role' | translate }}\n        </a>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<vdr-data-table\n    [items]=\"visibleRoles$ | async\"\n    [itemsPerPage]=\"itemsPerPage$ | async\"\n    [totalItems]=\"totalItems$ | async\"\n    [currentPage]=\"currentPage$ | async\"\n    (pageChange)=\"setPageNumber($event)\"\n    (itemsPerPageChange)=\"setItemsPerPage($event)\"\n>\n    <vdr-dt-column>{{ 'common.description' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ 'common.code' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ 'settings.channel' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ 'settings.permissions' | translate }}</vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <ng-template let-role=\"item\">\n        <td class=\"left align-middle\">{{ role.description }}</td>\n        <td class=\"left align-middle\"><span *ngIf=\"!isDefaultRole(role)\">{{ role.code }}</span></td>\n        <td class=\"left align-middle\">\n            <ng-container *ngIf=\"!isDefaultRole(role)\">\n                <vdr-chip *ngFor=\"let channel of role.channels\">\n                    <vdr-channel-badge [channelCode]=\"channel.code\"></vdr-channel-badge>\n                    {{ channel.code | channelCodeToLabel | translate }}\n                </vdr-chip>\n            </ng-container>\n        </td>\n        <td class=\"left align-middle\">\n            <ng-container *ngIf=\"!isDefaultRole(role); else defaultRole\">\n                <vdr-chip *ngFor=\"let permission of role.permissions |  slice: 0:displayLimit[role.id] || 3\">{{ permission }}</vdr-chip>\n                <button\n                    class=\"btn btn-sm btn-secondary btn-icon\"\n                    *ngIf=\"role.permissions.length > initialLimit\"\n                    (click)=\"toggleDisplayLimit(role)\"\n                >\n                    <ng-container *ngIf=\"(displayLimit[role.id] || 0) < role.permissions.length; else collapse\">\n                        <clr-icon shape=\"plus\"></clr-icon>\n                        {{ role.permissions.length - initialLimit }}\n                    </ng-container>\n                    <ng-template #collapse>\n                        <clr-icon shape=\"minus\"></clr-icon>\n                    </ng-template>\n                </button>\n            </ng-container>\n            <ng-template #defaultRole>\n                <span class=\"default-role-label\">{{ 'settings.default-role-label' | translate }}</span>\n            </ng-template>\n        </td>\n        <td class=\"right align-middle\">\n            <vdr-table-row-action\n                *ngIf=\"!isDefaultRole(role)\"\n                iconShape=\"edit\"\n                [label]=\"'common.edit' | translate\"\n                [linkTo]=\"['./', role.id]\"\n            ></vdr-table-row-action>\n        </td>\n        <td class=\"right align-middle\">\n            <vdr-dropdown>\n                <button type=\"button\" class=\"btn btn-link btn-sm\" vdrDropdownTrigger [disabled]=\"isDefaultRole(role)\">\n                    {{ 'common.actions' | translate }}\n                    <clr-icon shape=\"caret down\"></clr-icon>\n                </button>\n                <vdr-dropdown-menu vdrPosition=\"bottom-right\">\n                    <button\n                        type=\"button\"\n                        class=\"delete-button\"\n                        (click)=\"deleteRole(role.id)\"\n                        [disabled]=\"!('SuperAdmin' | hasPermission)\"\n                        vdrDropdownItem\n                    >\n                        <clr-icon shape=\"trash\" class=\"is-danger\"></clr-icon>\n                        {{ 'common.delete' | translate }}\n                    </button>\n                </vdr-dropdown-menu>\n            </vdr-dropdown>\n        </td>\n    </ng-template>\n</vdr-data-table>\n","import { ChangeDetectionStrategy, Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport { BaseListComponent } from '@vendure/admin-ui/core';\nimport { GetRoles, Role } from '@vendure/admin-ui/core';\nimport { NotificationService } from '@vendure/admin-ui/core';\nimport { DataService } from '@vendure/admin-ui/core';\nimport { ModalService } from '@vendure/admin-ui/core';\nimport { CUSTOMER_ROLE_CODE, SUPER_ADMIN_ROLE_CODE } from '@vendure/common/lib/shared-constants';\nimport { EMPTY, Observable } from 'rxjs';\nimport { map, switchMap } from 'rxjs/operators';\n\n@Component({\n    selector: 'vdr-role-list',\n    templateUrl: './role-list.component.html',\n    styleUrls: ['./role-list.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class RoleListComponent extends BaseListComponent<GetRoles.Query, GetRoles.Items> implements OnInit {\n    readonly initialLimit = 3;\n    displayLimit: { [id: string]: number } = {};\n    visibleRoles$: Observable<GetRoles.Items[]>;\n\n    constructor(\n        private modalService: ModalService,\n        private notificationService: NotificationService,\n        private dataService: DataService,\n        router: Router,\n        route: ActivatedRoute,\n    ) {\n        super(router, route);\n        super.setQueryFn(\n            (...args: any[]) => this.dataService.administrator.getRoles(...args),\n            data => data.roles,\n        );\n    }\n\n    ngOnInit() {\n        super.ngOnInit();\n        this.visibleRoles$ = this.items$.pipe(\n            map(roles => roles.filter(role => role.code !== CUSTOMER_ROLE_CODE)),\n        );\n    }\n\n    toggleDisplayLimit(role: GetRoles.Items) {\n        if (this.displayLimit[role.id] === role.permissions.length) {\n            this.displayLimit[role.id] = this.initialLimit;\n        } else {\n            this.displayLimit[role.id] = role.permissions.length;\n        }\n    }\n\n    isDefaultRole(role: Role): boolean {\n        return role.code === SUPER_ADMIN_ROLE_CODE || role.code === CUSTOMER_ROLE_CODE;\n    }\n\n    deleteRole(id: string) {\n        this.modalService\n            .dialog({\n                title: _('settings.confirm-delete-role'),\n                buttons: [\n                    { type: 'secondary', label: _('common.cancel') },\n                    { type: 'danger', label: _('common.delete'), returnValue: true },\n                ],\n            })\n            .pipe(switchMap(response => (response ? this.dataService.administrator.deleteRole(id) : EMPTY)))\n            .subscribe(\n                () => {\n                    this.notificationService.success(_('common.notify-delete-success'), {\n                        entity: 'Role',\n                    });\n                    this.refresh();\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-delete-error'), {\n                        entity: 'Role',\n                    });\n                },\n            );\n    }\n}\n","<div class=\"test-result card\">\n    <div class=\"card-header\">\n        {{ 'settings.test-result' | translate }}\n    </div>\n    <div class=\"card-block\" *ngFor=\"let quote of testResult\">\n        <div class=\"result-details\" [class.stale]=\"testDataUpdated\">\n            <vdr-labeled-data [label]=\"'settings.shipping-method' | translate\">\n                {{ quote.name }}\n            </vdr-labeled-data>\n            <div class=\"price-row\">\n                <vdr-labeled-data [label]=\"'common.price' | translate\">\n                    {{ quote.price | localeCurrency: currencyCode }}\n                </vdr-labeled-data>\n                <vdr-labeled-data [label]=\"'common.price-with-tax' | translate\">\n                    {{ quote.priceWithTax | localeCurrency: currencyCode }}\n                </vdr-labeled-data>\n            </div>\n            <vdr-object-tree *ngIf=\"quote.metadata\" [value]=\"quote.metadata\"></vdr-object-tree>\n        </div>\n    </div>\n    <div class=\"card-block\" *ngIf=\"testResult?.length === 0\">\n        <clr-icon shape=\"ban\" class=\"is-solid error\"></clr-icon>\n        {{ 'settings.no-eligible-shipping-methods' | translate }}\n    </div>\n    <div class=\"card-footer\">\n        <button class=\"btn btn-secondary\" (click)=\"runTest.emit()\" [disabled]=\"!okToRun\">\n            {{ 'settings.test-shipping-methods' | translate }}\n        </button>\n    </div>\n</div>\n","import { ChangeDetectionStrategy, Component, EventEmitter, Input, Output } from '@angular/core';\n\nimport { CurrencyCode, ShippingMethodQuote } from '@vendure/admin-ui/core';\n\n@Component({\n    selector: 'vdr-shipping-eligibility-test-result',\n    templateUrl: './shipping-eligibility-test-result.component.html',\n    styleUrls: ['./shipping-eligibility-test-result.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ShippingEligibilityTestResultComponent {\n    @Input() testResult: ShippingMethodQuote[];\n    @Input() okToRun = false;\n    @Input() testDataUpdated = false;\n    @Input() currencyCode: CurrencyCode;\n    @Output() runTest = new EventEmitter<void>();\n}\n","<div class=\"card\">\n    <div class=\"card-header\">\n        {{ 'settings.test-order' | translate }}\n    </div>\n    <table class=\"order-table table\" *ngIf=\"lines.length; else emptyPlaceholder\">\n        <thead>\n            <tr>\n                <th></th>\n                <th>{{ 'order.product-name' | translate }}</th>\n                <th>{{ 'order.product-sku' | translate }}</th>\n                <th>{{ 'order.unit-price' | translate }}</th>\n                <th>{{ 'order.quantity' | translate }}</th>\n                <th>{{ 'order.total' | translate }}</th>\n            </tr>\n        </thead>\n        <tr *ngFor=\"let line of lines\" class=\"order-line\">\n            <td class=\"align-middle thumb\">\n                <img [src]=\"line.preview + '?preset=tiny'\" />\n            </td>\n            <td class=\"align-middle name\">{{ line.name }}</td>\n            <td class=\"align-middle sku\">{{ line.sku }}</td>\n            <td class=\"align-middle unit-price\">\n                {{ line.unitPriceWithTax | localeCurrency: currencyCode }}\n            </td>\n            <td class=\"align-middle quantity\">\n                <input\n                    [(ngModel)]=\"line.quantity\"\n                    (change)=\"updateQuantity()\"\n                    type=\"number\"\n                    max=\"9999\"\n                    min=\"1\"\n                />\n                <button class=\"icon-button\" (click)=\"removeLine(line)\">\n                    <clr-icon shape=\"trash\"></clr-icon>\n                </button>\n            </td>\n            <td class=\"align-middle total\">\n                {{ (line.unitPriceWithTax * line.quantity) | localeCurrency: currencyCode }}\n            </td>\n        </tr>\n        <tr class=\"sub-total\">\n            <td class=\"left\">{{ 'order.sub-total' | translate }}</td>\n            <td></td>\n            <td></td>\n            <td></td>\n            <td></td>\n            <td>{{ subTotal | localeCurrency: currencyCode }}</td>\n        </tr>\n    </table>\n\n    <ng-template #emptyPlaceholder>\n        <div class=\"card-block empty-placeholder\">\n            <div class=\"empty-text\">{{ 'settings.add-products-to-test-order' | translate }}</div>\n            <clr-icon shape=\"arrow\" dir=\"down\" size=\"96\"></clr-icon>\n        </div>\n    </ng-template>\n    <div class=\"card-block\">\n        <vdr-product-selector (productSelected)=\"selectResult($event)\"> </vdr-product-selector>\n    </div>\n</div>\n","import { ChangeDetectionStrategy, Component, EventEmitter, OnInit, Output } from '@angular/core';\nimport {\n    CurrencyCode,\n    DataService,\n    LocalStorageService,\n    ProductSelectorSearch,\n} from '@vendure/admin-ui/core';\n\nexport interface TestOrderLine {\n    id: string;\n    name: string;\n    preview: string;\n    sku: string;\n    unitPriceWithTax: number;\n    quantity: number;\n}\n\n@Component({\n    selector: 'vdr-test-order-builder',\n    templateUrl: './test-order-builder.component.html',\n    styleUrls: ['./test-order-builder.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class TestOrderBuilderComponent implements OnInit {\n    @Output() orderLinesChange = new EventEmitter<TestOrderLine[]>();\n    lines: TestOrderLine[] = [];\n    currencyCode: CurrencyCode;\n    get subTotal(): number {\n        return this.lines.reduce((sum, l) => sum + l.unitPriceWithTax * l.quantity, 0);\n    }\n\n    constructor(private dataService: DataService, private localStorageService: LocalStorageService) {}\n\n    ngOnInit() {\n        this.lines = this.loadFromLocalStorage();\n        if (this.lines) {\n            this.orderLinesChange.emit(this.lines);\n        }\n        this.dataService.settings.getActiveChannel('cache-first').single$.subscribe(result => {\n            this.currencyCode = result.activeChannel.currencyCode;\n        });\n    }\n\n    selectResult(result: ProductSelectorSearch.Items) {\n        if (result) {\n            this.addToLines(result);\n        }\n    }\n\n    private addToLines(result: ProductSelectorSearch.Items) {\n        if (!this.lines.find(l => l.id === result.productVariantId)) {\n            this.lines.push({\n                id: result.productVariantId,\n                name: result.productVariantName,\n                preview: result.productAsset?.preview ?? '',\n                quantity: 1,\n                sku: result.sku,\n                unitPriceWithTax:\n                    (result.priceWithTax.__typename === 'SinglePrice' && result.priceWithTax.value) || 0,\n            });\n            this.persistToLocalStorage();\n            this.orderLinesChange.emit(this.lines);\n        }\n    }\n\n    updateQuantity() {\n        this.persistToLocalStorage();\n        this.orderLinesChange.emit(this.lines);\n    }\n\n    removeLine(line: TestOrderLine) {\n        this.lines = this.lines.filter(l => l.id !== line.id);\n        this.persistToLocalStorage();\n        this.orderLinesChange.emit(this.lines);\n    }\n\n    private persistToLocalStorage() {\n        this.localStorageService.setForCurrentLocation('shippingTestOrder', this.lines);\n    }\n\n    private loadFromLocalStorage(): TestOrderLine[] {\n        return this.localStorageService.getForCurrentLocation('shippingTestOrder') || [];\n    }\n}\n","<div class=\"card\">\n    <div class=\"card-header\">\n        {{ 'settings.test-address' | translate }}\n    </div>\n    <div class=\"card-block\">\n        <form [formGroup]=\"form\">\n            <clr-input-container>\n                <label>{{ 'customer.city' | translate }}</label>\n                <input formControlName=\"city\" type=\"text\" clrInput />\n            </clr-input-container>\n            <clr-input-container>\n                <label>{{ 'customer.province' | translate }}</label>\n                <input formControlName=\"province\" type=\"text\" clrInput />\n            </clr-input-container>\n            <clr-input-container>\n                <label>{{ 'customer.postal-code' | translate }}</label>\n                <input formControlName=\"postalCode\" type=\"text\" clrInput />\n            </clr-input-container>\n            <clr-input-container>\n                <label>{{ 'customer.country' | translate }}</label>\n                <select name=\"countryCode\" formControlName=\"countryCode\" clrInput clrSelect>\n                    <option *ngFor=\"let country of availableCountries$ | async\" [value]=\"country.code\">\n                        {{ country.name }}\n                    </option>\n                </select>\n            </clr-input-container>\n        </form>\n    </div>\n</div>\n","import { ChangeDetectionStrategy, Component, EventEmitter, OnDestroy, OnInit, Output } from '@angular/core';\nimport { FormBuilder, FormGroup } from '@angular/forms';\nimport { DataService, GetAvailableCountries, LocalStorageService } from '@vendure/admin-ui/core';\nimport { Observable, Subscription } from 'rxjs';\n\nexport interface TestAddress {\n    city: string;\n    province: string;\n    postalCode: string;\n    countryCode: string;\n}\n\n@Component({\n    selector: 'vdr-test-address-form',\n    templateUrl: './test-address-form.component.html',\n    styleUrls: ['./test-address-form.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class TestAddressFormComponent implements OnInit, OnDestroy {\n    @Output() addressChange = new EventEmitter<TestAddress>();\n    availableCountries$: Observable<GetAvailableCountries.Items[]>;\n    form: FormGroup;\n    private subscription: Subscription;\n\n    constructor(\n        private formBuilder: FormBuilder,\n        private dataService: DataService,\n        private localStorageService: LocalStorageService,\n    ) {}\n\n    ngOnInit() {\n        this.availableCountries$ = this.dataService.settings\n            .getAvailableCountries()\n            .mapSingle(result => result.countries.items);\n        const storedValue = this.localStorageService.getForCurrentLocation('shippingTestAddress');\n        const initialValue: TestAddress = storedValue\n            ? storedValue\n            : {\n                  city: '',\n                  countryCode: '',\n                  postalCode: '',\n                  province: '',\n              };\n        this.addressChange.emit(initialValue);\n\n        this.form = this.formBuilder.group(initialValue);\n        this.subscription = this.form.valueChanges.subscribe(value => {\n            this.localStorageService.setForCurrentLocation('shippingTestAddress', value);\n            this.addressChange.emit(value);\n        });\n    }\n\n    ngOnDestroy() {\n        if (this.subscription) {\n            this.subscription.unsubscribe();\n        }\n    }\n}\n","<div\n    class=\"test-result card\"\n    [ngClass]=\"{\n        success: testResult?.eligible === true,\n        error: testResult?.eligible === false,\n        unknown: !testResult\n    }\"\n>\n    <div class=\"card-header\">\n        {{ 'settings.test-result' | translate }}\n    </div>\n    <div class=\"card-block\">\n        <div class=\"result-details\" [class.stale]=\"testDataUpdated\">\n            <vdr-labeled-data [label]=\"'settings.eligible' | translate\">\n                <div class=\"eligible-icon\">\n                    <clr-icon\n                        shape=\"success-standard\"\n                        class=\"is-solid success\"\n                        *ngIf=\"testResult?.eligible\"\n                    ></clr-icon>\n                    <clr-icon\n                        shape=\"ban\"\n                        class=\"is-solid error\"\n                        *ngIf=\"testResult?.eligible === false\"\n                    ></clr-icon>\n                    <clr-icon shape=\"unknown-status\" *ngIf=\"!testResult\"></clr-icon>\n                </div>\n                {{ testResult?.eligible }}\n            </vdr-labeled-data>\n            <div class=\"price-row\">\n                <vdr-labeled-data\n                    [label]=\"'common.price' | translate\"\n                    *ngIf=\"testResult?.quote?.price != null\"\n                >\n                    {{ testResult.quote?.price | localeCurrency: currencyCode }}\n                </vdr-labeled-data>\n                <vdr-labeled-data\n                    [label]=\"'common.price-with-tax' | translate\"\n                    *ngIf=\"testResult?.quote?.priceWithTax != null\"\n                >\n                    {{ testResult.quote?.priceWithTax | localeCurrency: currencyCode }}\n                </vdr-labeled-data>\n            </div>\n            <vdr-object-tree\n                *ngIf=\"testResult?.quote?.metadata\"\n                [value]=\"testResult?.quote?.metadata\"\n            ></vdr-object-tree>\n        </div>\n    </div>\n    <div class=\"card-footer\">\n        <button class=\"btn btn-secondary\" (click)=\"runTest.emit()\" [disabled]=\"!okToRun\">\n            {{ 'settings.test-shipping-method' | translate }}\n        </button>\n    </div>\n</div>\n","import { ChangeDetectionStrategy, Component, EventEmitter, Input, Output } from '@angular/core';\n\nimport { CurrencyCode, TestShippingMethodResult } from '@vendure/admin-ui/core';\n\n@Component({\n    selector: 'vdr-shipping-method-test-result',\n    templateUrl: './shipping-method-test-result.component.html',\n    styleUrls: ['./shipping-method-test-result.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ShippingMethodTestResultComponent {\n    @Input() testResult: TestShippingMethodResult;\n    @Input() okToRun = false;\n    @Input() testDataUpdated = false;\n    @Input() currencyCode: CurrencyCode;\n    @Output() runTest = new EventEmitter<void>();\n}\n","<vdr-action-bar>\n    <vdr-ab-left>\n        <vdr-entity-info [entity]=\"entity$ | async\"></vdr-entity-info>\n        <vdr-language-selector\n            [disabled]=\"isNew$ | async\"\n            [availableLanguageCodes]=\"availableLanguages$ | async\"\n            [currentLanguageCode]=\"languageCode$ | async\"\n            (languageCodeChange)=\"setLanguage($event)\"\n        ></vdr-language-selector>\n    </vdr-ab-left>\n\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId=\"shipping-method-detail\"></vdr-action-bar-items>\n        <button\n            class=\"btn btn-primary\"\n            *ngIf=\"isNew$ | async; else updateButton\"\n            (click)=\"create()\"\n            [disabled]=\"detailForm.pristine || detailForm.invalid || !selectedChecker || !selectedCalculator\"\n        >\n            {{ 'common.create' | translate }}\n        </button>\n        <ng-template #updateButton>\n            <button\n                class=\"btn btn-primary\"\n                (click)=\"save()\"\n                *vdrIfPermissions=\"updatePermission\"\n                [disabled]=\"\n                    detailForm.pristine || detailForm.invalid || !selectedChecker || !selectedCalculator\n                \"\n            >\n                {{ 'common.update' | translate }}\n            </button>\n        </ng-template>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<form class=\"form\" [formGroup]=\"detailForm\" *ngIf=\"entity$ | async as shippingMethod\">\n    <vdr-form-field [label]=\"'common.name' | translate\" for=\"name\">\n        <input\n            id=\"name\"\n            type=\"text\"\n            formControlName=\"name\"\n            [readonly]=\"!(updatePermission | hasPermission)\"\n            (input)=\"updateCode(shippingMethod.code, $event.target.value)\"\n        />\n    </vdr-form-field>\n    <vdr-form-field\n        [label]=\"'common.code' | translate\"\n        for=\"code\"\n        [readOnlyToggle]=\"updatePermission | hasPermission\"\n    >\n        <input\n            id=\"code\"\n            type=\"text\"\n            formControlName=\"code\"\n            [readonly]=\"!(updatePermission | hasPermission)\"\n        />\n    </vdr-form-field>\n    <vdr-rich-text-editor\n        formControlName=\"description\"\n        [readonly]=\"!(updatePermission | hasPermission)\"\n        [label]=\"'common.description' | translate\"\n    ></vdr-rich-text-editor>\n    <vdr-form-field [label]=\"'settings.fulfillment-handler' | translate\" for=\"fulfillmentHandler\" class=\"mb2\">\n        <select\n            name=\"fulfillmentHandler\"\n            formControlName=\"fulfillmentHandler\"\n            [vdrDisabled]=\"!(updatePermission | hasPermission)\"\n        >\n            <option *ngFor=\"let handler of fulfillmentHandlers\" [value]=\"handler.code\">\n                {{ handler.code }}: {{ handler.description }}\n            </option>\n        </select>\n    </vdr-form-field>\n\n    <section formGroupName=\"customFields\" *ngIf=\"customFields.length\">\n        <label>{{ 'common.custom-fields' | translate }}</label>\n        <vdr-tabbed-custom-fields\n            entityName=\"ShippingMethod\"\n            [customFields]=\"customFields\"\n            [customFieldsFormGroup]=\"detailForm.get('customFields')\"\n            [readonly]=\"!(updatePermission | hasPermission)\"\n        ></vdr-tabbed-custom-fields>\n    </section>\n\n    <vdr-custom-detail-component-host\n        locationId=\"shipping-method-detail\"\n        [entity$]=\"entity$\"\n        [detailForm]=\"detailForm\"\n    ></vdr-custom-detail-component-host>\n\n    <div class=\"clr-row mt4\">\n        <div class=\"clr-col\">\n            <label class=\"clr-control-label\">{{ 'settings.shipping-eligibility-checker' | translate }}</label>\n            <vdr-configurable-input\n                *ngIf=\"selectedChecker && selectedCheckerDefinition\"\n                [operation]=\"selectedChecker\"\n                [operationDefinition]=\"selectedCheckerDefinition\"\n                [readonly]=\"!(updatePermission | hasPermission)\"\n                (remove)=\"selectedChecker = null\"\n                formControlName=\"checker\"\n            ></vdr-configurable-input>\n            <div *ngIf=\"!selectedChecker || !selectedCheckerDefinition\">\n                <vdr-dropdown>\n                    <button class=\"btn btn-outline\" vdrDropdownTrigger>\n                        <clr-icon shape=\"plus\"></clr-icon>\n                        {{ 'common.select' | translate }}\n                    </button>\n                    <vdr-dropdown-menu vdrPosition=\"bottom-left\">\n                        <button\n                            *ngFor=\"let checker of checkers\"\n                            type=\"button\"\n                            vdrDropdownItem\n                            (click)=\"selectChecker(checker)\"\n                        >\n                            {{ checker.description }}\n                        </button>\n                    </vdr-dropdown-menu>\n                </vdr-dropdown>\n            </div>\n        </div>\n        <div class=\"clr-col\">\n            <label class=\"clr-control-label\">{{ 'settings.shipping-calculator' | translate }}</label>\n            <vdr-configurable-input\n                *ngIf=\"selectedCalculator && selectedCalculatorDefinition\"\n                [operation]=\"selectedCalculator\"\n                [operationDefinition]=\"selectedCalculatorDefinition\"\n                [readonly]=\"!(updatePermission | hasPermission)\"\n                (remove)=\"selectedCalculator = null\"\n                formControlName=\"calculator\"\n            ></vdr-configurable-input>\n            <div *ngIf=\"!selectedCalculator || !selectedCalculatorDefinition\">\n                <vdr-dropdown>\n                    <button class=\"btn btn-outline\" vdrDropdownTrigger>\n                        <clr-icon shape=\"plus\"></clr-icon>\n                        {{ 'common.select' | translate }}\n                    </button>\n                    <vdr-dropdown-menu vdrPosition=\"bottom-left\">\n                        <button\n                            *ngFor=\"let calculator of calculators\"\n                            type=\"button\"\n                            vdrDropdownItem\n                            (click)=\"selectCalculator(calculator)\"\n                        >\n                            {{ calculator.description }}\n                        </button>\n                    </vdr-dropdown-menu>\n                </vdr-dropdown>\n            </div>\n        </div>\n    </div>\n</form>\n<div class=\"testing-tool\">\n    <clr-accordion>\n        <clr-accordion-panel>\n            <clr-accordion-title>{{ 'settings.test-shipping-method' | translate }}</clr-accordion-title>\n            <clr-accordion-content *clrIfExpanded>\n                <div class=\"clr-row\">\n                    <div class=\"clr-col\">\n                        <vdr-test-order-builder\n                            (orderLinesChange)=\"setTestOrderLines($event)\"\n                        ></vdr-test-order-builder>\n                    </div>\n                    <div class=\"clr-col\">\n                        <vdr-test-address-form\n                            (addressChange)=\"setTestAddress($event)\"\n                        ></vdr-test-address-form>\n                        <vdr-shipping-method-test-result\n                            [currencyCode]=\"(activeChannel$ | async)?.currencyCode\"\n                            [okToRun]=\"allTestDataPresent() && testDataUpdated && detailForm.valid\"\n                            [testDataUpdated]=\"testDataUpdated\"\n                            [testResult]=\"testResult$ | async\"\n                            (runTest)=\"runTest()\"\n                        ></vdr-shipping-method-test-result>\n                    </div>\n                </div>\n            </clr-accordion-content>\n        </clr-accordion-panel>\n    </clr-accordion>\n</div>\n","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, OnDestroy, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport {\n    BaseDetailComponent,\n    configurableDefinitionToInstance,\n    ConfigurableOperation,\n    ConfigurableOperationDefinition,\n    CreateShippingMethodInput,\n    createUpdatedTranslatable,\n    CustomFieldConfig,\n    DataService,\n    findTranslation,\n    GetActiveChannel,\n    getConfigArgValue,\n    LanguageCode,\n    NotificationService,\n    Permission,\n    ServerConfigService,\n    ShippingMethod,\n    TestShippingMethodInput,\n    TestShippingMethodResult,\n    toConfigurableOperationInput,\n    UpdateShippingMethodInput,\n} from '@vendure/admin-ui/core';\nimport { normalizeString } from '@vendure/common/lib/normalize-string';\nimport { combineLatest, merge, Observable, of, Subject } from 'rxjs';\nimport { mergeMap, switchMap, take, takeUntil } from 'rxjs/operators';\n\nimport { TestAddress } from '../test-address-form/test-address-form.component';\nimport { TestOrderLine } from '../test-order-builder/test-order-builder.component';\n\n@Component({\n    selector: 'vdr-shipping-method-detail',\n    templateUrl: './shipping-method-detail.component.html',\n    styleUrls: ['./shipping-method-detail.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ShippingMethodDetailComponent\n    extends BaseDetailComponent<ShippingMethod.Fragment>\n    implements OnInit, OnDestroy\n{\n    detailForm: FormGroup;\n    checkers: ConfigurableOperationDefinition[] = [];\n    calculators: ConfigurableOperationDefinition[] = [];\n    fulfillmentHandlers: ConfigurableOperationDefinition[] = [];\n    selectedChecker?: ConfigurableOperation | null;\n    selectedCheckerDefinition?: ConfigurableOperationDefinition;\n    selectedCalculator?: ConfigurableOperation | null;\n    selectedCalculatorDefinition?: ConfigurableOperationDefinition;\n    activeChannel$: Observable<GetActiveChannel.ActiveChannel>;\n    testAddress: TestAddress;\n    testOrderLines: TestOrderLine[];\n    testDataUpdated = false;\n    testResult$: Observable<TestShippingMethodResult | undefined>;\n    customFields: CustomFieldConfig[];\n    readonly updatePermission = [Permission.UpdateSettings, Permission.UpdateShippingMethod];\n    private fetchTestResult$ = new Subject<[TestAddress, TestOrderLine[]]>();\n\n    constructor(\n        router: Router,\n        route: ActivatedRoute,\n        serverConfigService: ServerConfigService,\n        private changeDetector: ChangeDetectorRef,\n        protected dataService: DataService,\n        private formBuilder: FormBuilder,\n        private notificationService: NotificationService,\n    ) {\n        super(route, router, serverConfigService, dataService);\n        this.customFields = this.getCustomFieldConfig('ShippingMethod');\n        this.detailForm = this.formBuilder.group({\n            code: ['', Validators.required],\n            name: ['', Validators.required],\n            description: '',\n            fulfillmentHandler: ['', Validators.required],\n            checker: {},\n            calculator: {},\n            customFields: this.formBuilder.group(\n                this.customFields.reduce((hash, field) => ({ ...hash, [field.name]: '' }), {}),\n            ),\n        });\n    }\n\n    ngOnInit() {\n        this.init();\n        combineLatest([\n            this.dataService.shippingMethod.getShippingMethodOperations().single$,\n            this.entity$.pipe(take(1)),\n        ]).subscribe(([data, entity]) => {\n            this.checkers = data.shippingEligibilityCheckers;\n            this.calculators = data.shippingCalculators;\n            this.fulfillmentHandlers = data.fulfillmentHandlers;\n            this.changeDetector.markForCheck();\n            this.selectedCheckerDefinition = data.shippingEligibilityCheckers.find(\n                c => c.code === (entity.checker && entity.checker.code),\n            );\n            this.selectedCalculatorDefinition = data.shippingCalculators.find(\n                c => c.code === (entity.calculator && entity.calculator.code),\n            );\n        });\n\n        this.activeChannel$ = this.dataService.settings\n            .getActiveChannel()\n            .mapStream(data => data.activeChannel);\n\n        this.testResult$ = this.fetchTestResult$.pipe(\n            switchMap(([address, lines]) => {\n                if (!this.selectedChecker || !this.selectedCalculator) {\n                    return of(undefined);\n                }\n                const formValue = this.detailForm.value;\n                const input: TestShippingMethodInput = {\n                    shippingAddress: { ...address, streetLine1: 'test' },\n                    lines: lines.map(l => ({ productVariantId: l.id, quantity: l.quantity })),\n                    checker: toConfigurableOperationInput(this.selectedChecker, formValue.checker),\n                    calculator: toConfigurableOperationInput(this.selectedCalculator, formValue.calculator),\n                };\n                return this.dataService.shippingMethod\n                    .testShippingMethod(input)\n                    .mapSingle(result => result.testShippingMethod);\n            }),\n        );\n\n        // tslint:disable:no-non-null-assertion\n        merge(\n            this.detailForm.get(['checker'])!.valueChanges,\n            this.detailForm.get(['calculator'])!.valueChanges,\n        )\n            .pipe(takeUntil(this.destroy$))\n            .subscribe(() => (this.testDataUpdated = true));\n        // tslint:enable:no-non-null-assertion\n    }\n\n    ngOnDestroy(): void {\n        this.destroy();\n    }\n\n    updateCode(currentCode: string, nameValue: string) {\n        if (!currentCode) {\n            const codeControl = this.detailForm.get(['code']);\n            if (codeControl && codeControl.pristine) {\n                codeControl.setValue(normalizeString(nameValue, '-'));\n            }\n        }\n    }\n\n    selectChecker(checker: ConfigurableOperationDefinition) {\n        this.selectedCheckerDefinition = checker;\n        this.selectedChecker = configurableDefinitionToInstance(checker);\n        const formControl = this.detailForm.get('checker');\n        if (formControl) {\n            formControl.clearValidators();\n            formControl.updateValueAndValidity({ onlySelf: true });\n            formControl.patchValue(this.selectedChecker);\n        }\n        this.detailForm.markAsDirty();\n    }\n\n    selectCalculator(calculator: ConfigurableOperationDefinition) {\n        this.selectedCalculatorDefinition = calculator;\n        this.selectedCalculator = configurableDefinitionToInstance(calculator);\n        const formControl = this.detailForm.get('calculator');\n        if (formControl) {\n            formControl.clearValidators();\n            formControl.updateValueAndValidity({ onlySelf: true });\n            formControl.patchValue(this.selectedCalculator);\n        }\n        this.detailForm.markAsDirty();\n    }\n\n    create() {\n        const selectedChecker = this.selectedChecker;\n        const selectedCalculator = this.selectedCalculator;\n        if (!selectedChecker || !selectedCalculator) {\n            return;\n        }\n        combineLatest([this.entity$, this.languageCode$])\n            .pipe(\n                take(1),\n                mergeMap(([shippingMethod, languageCode]) => {\n                    const formValue = this.detailForm.value;\n                    const input = {\n                        ...(this.getUpdatedShippingMethod(\n                            shippingMethod,\n                            this.detailForm,\n                            languageCode,\n                        ) as CreateShippingMethodInput),\n                        checker: toConfigurableOperationInput(selectedChecker, formValue.checker),\n                        calculator: toConfigurableOperationInput(selectedCalculator, formValue.calculator),\n                    };\n                    return this.dataService.shippingMethod.createShippingMethod(input);\n                }),\n            )\n            .subscribe(\n                data => {\n                    this.notificationService.success(_('common.notify-create-success'), {\n                        entity: 'ShippingMethod',\n                    });\n                    this.detailForm.markAsPristine();\n                    this.changeDetector.markForCheck();\n                    this.router.navigate(['../', data.createShippingMethod.id], { relativeTo: this.route });\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-create-error'), {\n                        entity: 'ShippingMethod',\n                    });\n                },\n            );\n    }\n\n    save() {\n        const selectedChecker = this.selectedChecker;\n        const selectedCalculator = this.selectedCalculator;\n        if (!selectedChecker || !selectedCalculator) {\n            return;\n        }\n        combineLatest([this.entity$, this.languageCode$])\n            .pipe(\n                take(1),\n                mergeMap(([shippingMethod, languageCode]) => {\n                    const formValue = this.detailForm.value;\n                    const input = {\n                        ...(this.getUpdatedShippingMethod(\n                            shippingMethod,\n                            this.detailForm,\n                            languageCode,\n                        ) as UpdateShippingMethodInput),\n                        checker: toConfigurableOperationInput(selectedChecker, formValue.checker),\n                        calculator: toConfigurableOperationInput(selectedCalculator, formValue.calculator),\n                    };\n                    return this.dataService.shippingMethod.updateShippingMethod(input);\n                }),\n            )\n            .subscribe(\n                data => {\n                    this.notificationService.success(_('common.notify-update-success'), {\n                        entity: 'ShippingMethod',\n                    });\n                    this.detailForm.markAsPristine();\n                    this.changeDetector.markForCheck();\n                },\n                err => {\n                    // tslint:disable-next-line:no-console\n                    console.error(err);\n                    this.notificationService.error(_('common.notify-update-error'), {\n                        entity: 'ShippingMethod',\n                    });\n                },\n            );\n    }\n\n    setTestOrderLines(event: TestOrderLine[]) {\n        this.testOrderLines = event;\n        this.testDataUpdated = true;\n    }\n\n    setTestAddress(event: TestAddress) {\n        this.testAddress = event;\n        this.testDataUpdated = true;\n    }\n\n    allTestDataPresent(): boolean {\n        return !!(\n            this.testAddress &&\n            this.testOrderLines &&\n            this.testOrderLines.length &&\n            this.selectedChecker &&\n            this.selectedCalculator\n        );\n    }\n\n    runTest() {\n        this.fetchTestResult$.next([this.testAddress, this.testOrderLines]);\n        this.testDataUpdated = false;\n    }\n\n    /**\n     * Given a ShippingMethod and the value of the detailForm, this method creates an updated copy which\n     * can then be persisted to the API.\n     */\n    private getUpdatedShippingMethod(\n        shippingMethod: ShippingMethod.Fragment,\n        formGroup: FormGroup,\n        languageCode: LanguageCode,\n    ): Omit<CreateShippingMethodInput | UpdateShippingMethodInput, 'checker' | 'calculator'> {\n        const formValue = formGroup.value;\n        const input = createUpdatedTranslatable({\n            translatable: shippingMethod,\n            updatedFields: formValue,\n            customFieldConfig: this.customFields,\n            languageCode,\n            defaultTranslation: {\n                languageCode,\n                name: shippingMethod.name || '',\n                description: shippingMethod.description || '',\n            },\n        });\n        return { ...input, fulfillmentHandler: formValue.fulfillmentHandler };\n    }\n\n    protected setFormValues(shippingMethod: ShippingMethod.Fragment, languageCode: LanguageCode): void {\n        const currentTranslation = findTranslation(shippingMethod, languageCode);\n        this.detailForm.patchValue({\n            name: currentTranslation?.name ?? '',\n            description: currentTranslation?.description ?? '',\n            code: shippingMethod.code,\n            fulfillmentHandler: shippingMethod.fulfillmentHandlerCode,\n            checker: shippingMethod.checker || {},\n            calculator: shippingMethod.calculator || {},\n        });\n        if (!this.selectedChecker) {\n            this.selectedChecker = shippingMethod.checker && {\n                code: shippingMethod.checker.code,\n                args: shippingMethod.checker.args.map(a => ({ ...a, value: getConfigArgValue(a.value) })),\n            };\n        }\n        if (!this.selectedCalculator) {\n            this.selectedCalculator = shippingMethod.calculator && {\n                code: shippingMethod.calculator?.code,\n                args: shippingMethod.calculator?.args.map(a => ({ ...a, value: getConfigArgValue(a.value) })),\n            };\n        }\n        if (this.customFields.length) {\n            this.setCustomFieldFormValues(\n                this.customFields,\n                this.detailForm.get(['customFields']),\n                shippingMethod,\n                currentTranslation,\n            );\n        }\n    }\n}\n","<vdr-action-bar>\n    <vdr-ab-left>\n        <vdr-language-selector\n            [availableLanguageCodes]=\"availableLanguages$ | async\"\n            [currentLanguageCode]=\"contentLanguage$ | async\"\n            (languageCodeChange)=\"setLanguage($event)\"\n        ></vdr-language-selector>\n    </vdr-ab-left>\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId=\"shipping-method-list\"></vdr-action-bar-items>\n        <a\n            class=\"btn btn-primary\"\n            [routerLink]=\"['./create']\"\n            *vdrIfPermissions=\"['CreateSettings', 'CreateShippingMethod']\"\n        >\n            <clr-icon shape=\"plus\"></clr-icon>\n            {{ 'settings.create-new-shipping-method' | translate }}\n        </a>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<vdr-data-table\n    [items]=\"items$ | async\"\n    [itemsPerPage]=\"itemsPerPage$ | async\"\n    [totalItems]=\"totalItems$ | async\"\n    [currentPage]=\"currentPage$ | async\"\n    (pageChange)=\"setPageNumber($event)\"\n    (itemsPerPageChange)=\"setItemsPerPage($event)\"\n>\n    <vdr-dt-column>{{ 'common.code' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ 'common.name' | translate }}</vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <ng-template let-shippingMethod=\"item\">\n        <td class=\"left align-middle\">{{ shippingMethod.code }}</td>\n        <td class=\"left align-middle\">{{ shippingMethod.name }}</td>\n        <td class=\"right align-middle\">\n            <vdr-table-row-action\n                iconShape=\"edit\"\n                [label]=\"'common.edit' | translate\"\n                [linkTo]=\"['./', shippingMethod.id]\"\n            ></vdr-table-row-action>\n        </td>\n        <td class=\"right align-middle\">\n            <vdr-dropdown>\n                <button type=\"button\" class=\"btn btn-link btn-sm\" vdrDropdownTrigger>\n                    {{ 'common.actions' | translate }}\n                    <clr-icon shape=\"caret down\"></clr-icon>\n                </button>\n                <vdr-dropdown-menu vdrPosition=\"bottom-right\">\n                    <button\n                        type=\"button\"\n                        class=\"delete-button\"\n                        (click)=\"deleteShippingMethod(shippingMethod.id)\"\n                        [disabled]=\"!(['DeleteSettings', 'DeleteShippingMethod'] | hasPermission)\"\n                        vdrDropdownItem\n                    >\n                        <clr-icon shape=\"trash\" class=\"is-danger\"></clr-icon>\n                        {{ 'common.delete' | translate }}\n                    </button>\n                </vdr-dropdown-menu>\n            </vdr-dropdown>\n        </td>\n    </ng-template>\n</vdr-data-table>\n\n<div class=\"testing-tool\">\n    <clr-accordion>\n        <clr-accordion-panel>\n            <clr-accordion-title>{{ 'settings.test-shipping-methods' | translate }}</clr-accordion-title>\n            <clr-accordion-content *clrIfExpanded>\n                <div class=\"clr-row\">\n                    <div class=\"clr-col\">\n                        <vdr-test-order-builder\n                            (orderLinesChange)=\"setTestOrderLines($event)\"\n                        ></vdr-test-order-builder>\n                    </div>\n                    <div class=\"clr-col\">\n                        <vdr-test-address-form\n                            (addressChange)=\"setTestAddress($event)\"\n                        ></vdr-test-address-form>\n                        <vdr-shipping-eligibility-test-result\n                            [currencyCode]=\"(activeChannel$ | async)?.currencyCode\"\n                            [okToRun]=\"allTestDataPresent()\"\n                            [testDataUpdated]=\"testDataUpdated\"\n                            [testResult]=\"testResult$ | async\"\n                            (runTest)=\"runTest()\"\n                        ></vdr-shipping-eligibility-test-result>\n                    </div>\n                </div>\n            </clr-accordion-content>\n        </clr-accordion-panel>\n    </clr-accordion>\n</div>\n","import { ChangeDetectionStrategy, Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport {\n    BaseListComponent,\n    DataService,\n    GetActiveChannel,\n    GetShippingMethodList,\n    LanguageCode,\n    ModalService,\n    NotificationService,\n    ServerConfigService,\n    ShippingMethodQuote,\n    TestEligibleShippingMethodsInput,\n} from '@vendure/admin-ui/core';\nimport { EMPTY, Observable, Subject } from 'rxjs';\nimport { switchMap, tap } from 'rxjs/operators';\n\nimport { TestAddress } from '../test-address-form/test-address-form.component';\nimport { TestOrderLine } from '../test-order-builder/test-order-builder.component';\n\n@Component({\n    selector: 'vdr-shipping-method-list',\n    templateUrl: './shipping-method-list.component.html',\n    styleUrls: ['./shipping-method-list.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ShippingMethodListComponent\n    extends BaseListComponent<GetShippingMethodList.Query, GetShippingMethodList.Items>\n    implements OnInit {\n    activeChannel$: Observable<GetActiveChannel.ActiveChannel>;\n    testAddress: TestAddress;\n    testOrderLines: TestOrderLine[];\n    testDataUpdated = false;\n    testResult$: Observable<ShippingMethodQuote[] | undefined>;\n    availableLanguages$: Observable<LanguageCode[]>;\n    contentLanguage$: Observable<LanguageCode>;\n    private fetchTestResult$ = new Subject<[TestAddress, TestOrderLine[]]>();\n\n    constructor(\n        private modalService: ModalService,\n        private notificationService: NotificationService,\n        private dataService: DataService,\n        private serverConfigService: ServerConfigService,\n        router: Router,\n        route: ActivatedRoute,\n    ) {\n        super(router, route);\n        super.setQueryFn(\n            (...args: any[]) =>\n                this.dataService.shippingMethod.getShippingMethods(...args).refetchOnChannelChange(),\n            data => data.shippingMethods,\n        );\n    }\n\n    ngOnInit() {\n        super.ngOnInit();\n        this.testResult$ = this.fetchTestResult$.pipe(\n            switchMap(([address, lines]) => {\n                const input: TestEligibleShippingMethodsInput = {\n                    shippingAddress: { ...address, streetLine1: 'test' },\n                    lines: lines.map(l => ({ productVariantId: l.id, quantity: l.quantity })),\n                };\n                return this.dataService.shippingMethod\n                    .testEligibleShippingMethods(input)\n                    .mapSingle(result => result.testEligibleShippingMethods);\n            }),\n        );\n        this.activeChannel$ = this.dataService.settings\n            .getActiveChannel()\n            .mapStream(data => data.activeChannel);\n        this.availableLanguages$ = this.serverConfigService.getAvailableLanguages();\n        this.contentLanguage$ = this.dataService.client\n            .uiState()\n            .mapStream(({ uiState }) => uiState.contentLanguage)\n            .pipe(tap(() => this.refresh()));\n    }\n\n    deleteShippingMethod(id: string) {\n        this.modalService\n            .dialog({\n                title: _('catalog.confirm-delete-shipping-method'),\n                buttons: [\n                    { type: 'secondary', label: _('common.cancel') },\n                    { type: 'danger', label: _('common.delete'), returnValue: true },\n                ],\n            })\n            .pipe(\n                switchMap(response =>\n                    response ? this.dataService.shippingMethod.deleteShippingMethod(id) : EMPTY,\n                ),\n            )\n            .subscribe(\n                () => {\n                    this.notificationService.success(_('common.notify-delete-success'), {\n                        entity: 'ShippingMethod',\n                    });\n                    this.refresh();\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-delete-error'), {\n                        entity: 'ShippingMethod',\n                    });\n                },\n            );\n    }\n\n    setTestOrderLines(event: TestOrderLine[]) {\n        this.testOrderLines = event;\n        this.testDataUpdated = true;\n    }\n\n    setTestAddress(event: TestAddress) {\n        this.testAddress = event;\n        this.testDataUpdated = true;\n    }\n\n    allTestDataPresent(): boolean {\n        return !!(this.testAddress && this.testOrderLines && this.testOrderLines.length);\n    }\n\n    runTest() {\n        this.fetchTestResult$.next([this.testAddress, this.testOrderLines]);\n        this.testDataUpdated = false;\n    }\n\n    setLanguage(code: LanguageCode) {\n        this.dataService.client.setContentLanguage(code).subscribe();\n    }\n}\n","<vdr-action-bar>\n    <vdr-ab-left>\n        <vdr-entity-info [entity]=\"entity$ | async\"></vdr-entity-info>\n    </vdr-ab-left>\n\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId=\"tax-category-detail\"></vdr-action-bar-items>\n        <button\n            class=\"btn btn-primary\"\n            *ngIf=\"isNew$ | async; else updateButton\"\n            (click)=\"create()\"\n            [disabled]=\"!saveButtonEnabled()\"\n        >\n            {{ 'common.create' | translate }}\n        </button>\n        <ng-template #updateButton>\n            <button\n                class=\"btn btn-primary\"\n                (click)=\"save()\"\n                [disabled]=\"!saveButtonEnabled()\"\n                *vdrIfPermissions=\"updatePermission\"\n            >\n                {{ 'common.update' | translate }}\n            </button>\n        </ng-template>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<form class=\"form\" [formGroup]=\"detailForm\">\n    <vdr-form-field [label]=\"'common.name' | translate\" for=\"name\">\n        <input\n            id=\"name\"\n            type=\"text\"\n            formControlName=\"name\"\n            [readonly]=\"!(updatePermission | hasPermission)\"\n        />\n    </vdr-form-field>\n    <vdr-form-field [label]=\"'common.default-tax-category' | translate\" for=\"isDefault\">\n        <clr-toggle-wrapper>\n            <input\n                type=\"checkbox\"\n                clrToggle\n                id=\"isDefault\"\n                [vdrDisabled]=\"!(updatePermission | hasPermission)\"\n                formControlName=\"isDefault\"\n            />\n        </clr-toggle-wrapper>\n    </vdr-form-field>\n    <section formGroupName=\"customFields\" *ngIf=\"customFields.length\">\n        <label>{{ 'common.custom-fields' | translate }}</label>\n        <vdr-tabbed-custom-fields\n            entityName=\"TaxCategory\"\n            [customFields]=\"customFields\"\n            [customFieldsFormGroup]=\"detailForm.get('customFields')\"\n            [readonly]=\"!(updatePermission | hasPermission)\"\n        ></vdr-tabbed-custom-fields>\n    </section>\n    <vdr-custom-detail-component-host\n        locationId=\"tax-category-detail\"\n        [entity$]=\"entity$\"\n        [detailForm]=\"detailForm\"\n    ></vdr-custom-detail-component-host>\n</form>\n","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, OnDestroy, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport { BaseDetailComponent, CustomFieldConfig, Permission } from '@vendure/admin-ui/core';\nimport {\n    ConfigurableOperation,\n    CreateTaxCategoryInput,\n    LanguageCode,\n    TaxCategory,\n    UpdateTaxCategoryInput,\n} from '@vendure/admin-ui/core';\nimport { NotificationService } from '@vendure/admin-ui/core';\nimport { DataService } from '@vendure/admin-ui/core';\nimport { ServerConfigService } from '@vendure/admin-ui/core';\nimport { Observable } from 'rxjs';\nimport { mergeMap, take } from 'rxjs/operators';\n\n@Component({\n    selector: 'vdr-tax-detail',\n    templateUrl: './tax-category-detail.component.html',\n    styleUrls: ['./tax-category-detail.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class TaxCategoryDetailComponent\n    extends BaseDetailComponent<TaxCategory.Fragment>\n    implements OnInit, OnDestroy\n{\n    taxCategory$: Observable<TaxCategory.Fragment>;\n    detailForm: FormGroup;\n    customFields: CustomFieldConfig[];\n    readonly updatePermission = [Permission.UpdateSettings, Permission.UpdateTaxCategory];\n\n    private taxCondition: ConfigurableOperation;\n    private taxAction: ConfigurableOperation;\n\n    constructor(\n        router: Router,\n        route: ActivatedRoute,\n        serverConfigService: ServerConfigService,\n        private changeDetector: ChangeDetectorRef,\n        protected dataService: DataService,\n        private formBuilder: FormBuilder,\n        private notificationService: NotificationService,\n    ) {\n        super(route, router, serverConfigService, dataService);\n        this.customFields = this.getCustomFieldConfig('TaxCategory');\n        this.detailForm = this.formBuilder.group({\n            name: ['', Validators.required],\n            isDefault: false,\n            customFields: this.formBuilder.group(\n                this.customFields.reduce((hash, field) => ({ ...hash, [field.name]: '' }), {}),\n            ),\n        });\n    }\n\n    ngOnInit() {\n        this.init();\n        this.taxCategory$ = this.entity$;\n    }\n\n    ngOnDestroy() {\n        this.destroy();\n    }\n\n    saveButtonEnabled(): boolean {\n        return this.detailForm.dirty && this.detailForm.valid;\n    }\n\n    create() {\n        if (!this.detailForm.dirty) {\n            return;\n        }\n        const formValue = this.detailForm.value;\n        const input = {\n            name: formValue.name,\n            isDefault: formValue.isDefault,\n            customFields: formValue.customFields,\n        } as CreateTaxCategoryInput;\n        this.dataService.settings.createTaxCategory(input).subscribe(\n            data => {\n                this.notificationService.success(_('common.notify-create-success'), {\n                    entity: 'TaxCategory',\n                });\n                this.detailForm.markAsPristine();\n                this.changeDetector.markForCheck();\n                this.router.navigate(['../', data.createTaxCategory.id], { relativeTo: this.route });\n            },\n            err => {\n                this.notificationService.error(_('common.notify-create-error'), {\n                    entity: 'TaxCategory',\n                });\n            },\n        );\n    }\n\n    save() {\n        if (!this.detailForm.dirty) {\n            return;\n        }\n        const formValue = this.detailForm.value;\n        this.taxCategory$\n            .pipe(\n                take(1),\n                mergeMap(taxCategory => {\n                    const input = {\n                        id: taxCategory.id,\n                        name: formValue.name,\n                        isDefault: formValue.isDefault,\n                        customFields: formValue.customFields,\n                    } as UpdateTaxCategoryInput;\n                    return this.dataService.settings.updateTaxCategory(input);\n                }),\n            )\n            .subscribe(\n                data => {\n                    this.notificationService.success(_('common.notify-update-success'), {\n                        entity: 'TaxCategory',\n                    });\n                    this.detailForm.markAsPristine();\n                    this.changeDetector.markForCheck();\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-update-error'), {\n                        entity: 'TaxCategory',\n                    });\n                },\n            );\n    }\n\n    /**\n     * Update the form values when the entity changes.\n     */\n    protected setFormValues(entity: TaxCategory.Fragment, languageCode: LanguageCode): void {\n        this.detailForm.patchValue({\n            name: entity.name,\n            isDefault: entity.isDefault,\n        });\n        if (this.customFields.length) {\n            this.setCustomFieldFormValues(this.customFields, this.detailForm.get('customFields'), entity);\n        }\n    }\n}\n","<vdr-action-bar>\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId=\"tax-category-list\"></vdr-action-bar-items>\n        <a class=\"btn btn-primary\" [routerLink]=\"['./create']\" *vdrIfPermissions=\"['CreateSettings', 'CreateTaxCategory']\">\n            <clr-icon shape=\"plus\"></clr-icon>\n            {{ 'settings.create-new-tax-category' | translate }}\n        </a>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<vdr-data-table [items]=\"taxCategories$ | async\">\n    <vdr-dt-column>{{ 'common.name' | translate }}</vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <ng-template let-taxCategory=\"item\">\n        <td class=\"left align-middle\">{{ taxCategory.name }}</td>\n        <td class=\"left align-middle\">\n            <vdr-chip *ngIf=\"taxCategory.isDefault\">{{ 'common.default-tax-category' | translate }}</vdr-chip>\n        </td>\n        <td class=\"right align-middle\">\n            <vdr-table-row-action\n                iconShape=\"edit\"\n                [label]=\"'common.edit' | translate\"\n                [linkTo]=\"['./', taxCategory.id]\"\n            ></vdr-table-row-action>\n        </td>\n        <td class=\"right align-middle\">\n            <vdr-dropdown>\n                <button type=\"button\" class=\"btn btn-link btn-sm\" vdrDropdownTrigger>\n                    {{ 'common.actions' | translate }}\n                    <clr-icon shape=\"caret down\"></clr-icon>\n                </button>\n                <vdr-dropdown-menu vdrPosition=\"bottom-right\">\n                    <button\n                        type=\"button\"\n                        class=\"delete-button\"\n                        (click)=\"deleteTaxCategory(taxCategory)\"\n                        [disabled]=\"!(['DeleteSettings', 'DeleteTaxCategory'] | hasPermission)\"\n                        vdrDropdownItem\n                    >\n                        <clr-icon shape=\"trash\" class=\"is-danger\"></clr-icon>\n                        {{ 'common.delete' | translate }}\n                    </button>\n                </vdr-dropdown-menu>\n            </vdr-dropdown>\n        </td>\n    </ng-template>\n</vdr-data-table>\n","import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport { EMPTY, Observable } from 'rxjs';\nimport { map, switchMap } from 'rxjs/operators';\n\nimport { DeletionResult, GetTaxCategories, TaxCategory } from '@vendure/admin-ui/core';\nimport { NotificationService } from '@vendure/admin-ui/core';\nimport { DataService } from '@vendure/admin-ui/core';\nimport { QueryResult } from '@vendure/admin-ui/core';\nimport { ModalService } from '@vendure/admin-ui/core';\n\n@Component({\n    selector: 'vdr-tax-list',\n    templateUrl: './tax-category-list.component.html',\n    styleUrls: ['./tax-category-list.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class TaxCategoryListComponent {\n    taxCategories$: Observable<TaxCategory.Fragment[]>;\n    private queryResult: QueryResult<GetTaxCategories.Query>;\n\n    constructor(\n        private dataService: DataService,\n        private notificationService: NotificationService,\n        private modalService: ModalService,\n    ) {\n        this.queryResult = this.dataService.settings.getTaxCategories();\n        this.taxCategories$ = this.queryResult.mapStream(data => data.taxCategories);\n    }\n\n    deleteTaxCategory(taxCategory: TaxCategory.Fragment) {\n        return this.modalService\n            .dialog({\n                title: _('settings.confirm-delete-tax-category'),\n                body: taxCategory.name,\n                buttons: [\n                    { type: 'secondary', label: _('common.cancel') },\n                    { type: 'danger', label: _('common.delete'), returnValue: true },\n                ],\n            })\n            .pipe(\n                switchMap(res => (res ? this.dataService.settings.deleteTaxCategory(taxCategory.id) : EMPTY)),\n                map(res => res.deleteTaxCategory),\n            )\n            .subscribe(\n                res => {\n                    if (res.result === DeletionResult.DELETED) {\n                        this.notificationService.success(_('common.notify-delete-success'), {\n                            entity: 'TaxRate',\n                        });\n                        this.queryResult.ref.refetch();\n                    } else {\n                        this.notificationService.error(res.message || _('common.notify-delete-error'), {\n                            entity: 'TaxRate',\n                        });\n                    }\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-delete-error'), {\n                        entity: 'TaxRate',\n                    });\n                },\n            );\n    }\n}\n","<vdr-action-bar>\n    <vdr-ab-left>\n        <vdr-entity-info [entity]=\"entity$ | async\"></vdr-entity-info>\n    </vdr-ab-left>\n\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId=\"tax-rate-detail\"></vdr-action-bar-items>\n        <button\n            class=\"btn btn-primary\"\n            *ngIf=\"isNew$ | async; else updateButton\"\n            (click)=\"create()\"\n            [disabled]=\"!saveButtonEnabled()\"\n        >\n            {{ 'common.create' | translate }}\n        </button>\n        <ng-template #updateButton>\n            <button\n                class=\"btn btn-primary\"\n                (click)=\"save()\"\n                [disabled]=\"!saveButtonEnabled()\"\n                *vdrIfPermissions=\"updatePermission\"\n            >\n                {{ 'common.update' | translate }}\n            </button>\n        </ng-template>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<form class=\"form\" [formGroup]=\"detailForm\">\n    <vdr-form-field [label]=\"'common.name' | translate\" for=\"name\">\n        <input\n            id=\"name\"\n            type=\"text\"\n            formControlName=\"name\"\n            [readonly]=\"!(updatePermission | hasPermission)\"\n        />\n    </vdr-form-field>\n    <vdr-form-field [label]=\"'common.enabled' | translate\" for=\"enabled\">\n        <clr-toggle-wrapper>\n            <input\n                type=\"checkbox\"\n                clrToggle\n                id=\"enabled\"\n                formControlName=\"enabled\"\n                [vdrDisabled]=\"!(updatePermission | hasPermission)\"\n            />\n        </clr-toggle-wrapper>\n    </vdr-form-field>\n    <vdr-form-field [label]=\"'settings.rate' | translate\" for=\"value\">\n        <vdr-affixed-input suffix=\"%\">\n            <input\n                id=\"value\"\n                type=\"number\"\n                step=\"0.1\"\n                formControlName=\"value\"\n                [readonly]=\"!(updatePermission | hasPermission)\"\n            />\n        </vdr-affixed-input>\n    </vdr-form-field>\n    <vdr-form-field [label]=\"'settings.tax-category' | translate\" for=\"taxCategoryId\">\n        <select\n            clrSelect\n            name=\"taxCategoryId\"\n            formControlName=\"taxCategoryId\"\n            [vdrDisabled]=\"!(updatePermission | hasPermission)\"\n        >\n            <option *ngFor=\"let taxCategory of taxCategories$ | async\" [value]=\"taxCategory.id\">\n                {{ taxCategory.name }}\n            </option>\n        </select>\n    </vdr-form-field>\n    <vdr-form-field [label]=\"'settings.zone' | translate\" for=\"zoneId\">\n        <select\n            clrSelect\n            name=\"zoneId\"\n            formControlName=\"zoneId\"\n            [vdrDisabled]=\"!(updatePermission | hasPermission)\"\n        >\n            <option *ngFor=\"let zone of zones$ | async\" [value]=\"zone.id\">{{ zone.name }}</option>\n        </select>\n    </vdr-form-field>\n    <section formGroupName=\"customFields\" *ngIf=\"customFields.length\">\n        <label>{{ 'common.custom-fields' | translate }}</label>\n        <vdr-tabbed-custom-fields\n            entityName=\"TaxRate\"\n            [customFields]=\"customFields\"\n            [customFieldsFormGroup]=\"detailForm.get('customFields')\"\n            [readonly]=\"!(updatePermission | hasPermission)\"\n        ></vdr-tabbed-custom-fields>\n    </section>\n    <vdr-custom-detail-component-host\n        locationId=\"tax-rate-detail\"\n        [entity$]=\"entity$\"\n        [detailForm]=\"detailForm\"\n    ></vdr-custom-detail-component-host>\n</form>\n","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, OnDestroy, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport {\n    BaseDetailComponent,\n    CreateTaxRateInput,\n    CustomerGroup,\n    CustomFieldConfig,\n    DataService,\n    GetZones,\n    LanguageCode,\n    NotificationService,\n    Permission,\n    ServerConfigService,\n    TaxCategory,\n    TaxRate,\n    UpdateTaxRateInput,\n} from '@vendure/admin-ui/core';\nimport { Observable } from 'rxjs';\nimport { mergeMap, take } from 'rxjs/operators';\n\n@Component({\n    selector: 'vdr-tax-rate-detail',\n    templateUrl: './tax-rate-detail.component.html',\n    styleUrls: ['./tax-rate-detail.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class TaxRateDetailComponent\n    extends BaseDetailComponent<TaxRate.Fragment>\n    implements OnInit, OnDestroy\n{\n    taxCategories$: Observable<TaxCategory.Fragment[]>;\n    zones$: Observable<GetZones.Zones[]>;\n    groups$: Observable<CustomerGroup[]>;\n    detailForm: FormGroup;\n    customFields: CustomFieldConfig[];\n    readonly updatePermission = [Permission.UpdateSettings, Permission.UpdateTaxRate];\n\n    constructor(\n        router: Router,\n        route: ActivatedRoute,\n        serverConfigService: ServerConfigService,\n        private changeDetector: ChangeDetectorRef,\n        protected dataService: DataService,\n        private formBuilder: FormBuilder,\n        private notificationService: NotificationService,\n    ) {\n        super(route, router, serverConfigService, dataService);\n        this.customFields = this.getCustomFieldConfig('TaxRate');\n        this.detailForm = this.formBuilder.group({\n            name: ['', Validators.required],\n            enabled: [true],\n            value: [0, Validators.required],\n            taxCategoryId: [''],\n            zoneId: [''],\n            customerGroupId: [''],\n            customFields: this.formBuilder.group(\n                this.customFields.reduce((hash, field) => ({ ...hash, [field.name]: '' }), {}),\n            ),\n        });\n    }\n\n    ngOnInit() {\n        this.init();\n        this.taxCategories$ = this.dataService.settings\n            .getTaxCategories()\n            .mapSingle(data => data.taxCategories);\n        this.zones$ = this.dataService.settings.getZones().mapSingle(data => data.zones);\n    }\n\n    ngOnDestroy() {\n        this.destroy();\n    }\n\n    saveButtonEnabled(): boolean {\n        return this.detailForm.dirty && this.detailForm.valid;\n    }\n\n    create() {\n        if (!this.detailForm.dirty) {\n            return;\n        }\n        const formValue = this.detailForm.value;\n        const input = {\n            name: formValue.name,\n            enabled: formValue.enabled,\n            value: formValue.value,\n            categoryId: formValue.taxCategoryId,\n            zoneId: formValue.zoneId,\n            customerGroupId: formValue.customerGroupId,\n            customFields: formValue.customFields,\n        } as CreateTaxRateInput;\n        this.dataService.settings.createTaxRate(input).subscribe(\n            data => {\n                this.notificationService.success(_('common.notify-create-success'), {\n                    entity: 'TaxRate',\n                });\n                this.detailForm.markAsPristine();\n                this.changeDetector.markForCheck();\n                this.router.navigate(['../', data.createTaxRate.id], { relativeTo: this.route });\n            },\n            err => {\n                this.notificationService.error(_('common.notify-create-error'), {\n                    entity: 'TaxRate',\n                });\n            },\n        );\n    }\n\n    save() {\n        if (!this.detailForm.dirty) {\n            return;\n        }\n        const formValue = this.detailForm.value;\n        this.entity$\n            .pipe(\n                take(1),\n                mergeMap(taxRate => {\n                    const input = {\n                        id: taxRate.id,\n                        name: formValue.name,\n                        enabled: formValue.enabled,\n                        value: formValue.value,\n                        categoryId: formValue.taxCategoryId,\n                        zoneId: formValue.zoneId,\n                        customerGroupId: formValue.customerGroupId,\n                        customFields: formValue.customFields,\n                    } as UpdateTaxRateInput;\n                    return this.dataService.settings.updateTaxRate(input);\n                }),\n            )\n            .subscribe(\n                data => {\n                    this.notificationService.success(_('common.notify-update-success'), {\n                        entity: 'TaxRate',\n                    });\n                    this.detailForm.markAsPristine();\n                    this.changeDetector.markForCheck();\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-update-error'), {\n                        entity: 'TaxRate',\n                    });\n                },\n            );\n    }\n\n    /**\n     * Update the form values when the entity changes.\n     */\n    protected setFormValues(entity: TaxRate.Fragment, languageCode: LanguageCode): void {\n        this.detailForm.patchValue({\n            name: entity.name,\n            enabled: entity.enabled,\n            value: entity.value,\n            taxCategoryId: entity.category ? entity.category.id : '',\n            zoneId: entity.zone ? entity.zone.id : '',\n            customerGroupId: entity.customerGroup ? entity.customerGroup.id : '',\n        });\n        if (this.customFields.length) {\n            this.setCustomFieldFormValues(this.customFields, this.detailForm.get('customFields'), entity);\n        }\n    }\n}\n","<vdr-action-bar>\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId=\"tax-rate-list\"></vdr-action-bar-items>\n        <a class=\"btn btn-primary\" [routerLink]=\"['./create']\" *vdrIfPermissions=\"['CreateSettings', 'CreateTaxRate']\">\n            <clr-icon shape=\"plus\"></clr-icon>\n            {{ 'settings.create-new-tax-rate' | translate }}\n        </a>\n    </vdr-ab-right>\n</vdr-action-bar>\n\n<vdr-data-table\n    [items]=\"items$ | async\"\n    [itemsPerPage]=\"itemsPerPage$ | async\"\n    [totalItems]=\"totalItems$ | async\"\n    [currentPage]=\"currentPage$ | async\"\n    (pageChange)=\"setPageNumber($event)\"\n    (itemsPerPageChange)=\"setItemsPerPage($event)\"\n>\n    <vdr-dt-column>{{ 'common.name' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ 'settings.tax-category' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ 'settings.zone' | translate }}</vdr-dt-column>\n    <vdr-dt-column>{{ 'settings.tax-rate' | translate }}</vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <vdr-dt-column></vdr-dt-column>\n    <ng-template let-taxRate=\"item\">\n        <td class=\"left align-middle\">{{ taxRate.name }}</td>\n        <td class=\"left align-middle\">{{ taxRate.category.name }}</td>\n        <td class=\"left align-middle\">{{ taxRate.zone.name }}</td>\n        <td class=\"left align-middle\">{{ taxRate.value }}%</td>\n        <td class=\"right align-middle\">\n            <vdr-table-row-action\n                iconShape=\"edit\"\n                [label]=\"'common.edit' | translate\"\n                [linkTo]=\"['./', taxRate.id]\"\n            ></vdr-table-row-action>\n        </td>\n        <td class=\"right align-middle\">\n            <vdr-dropdown>\n                <button type=\"button\" class=\"btn btn-link btn-sm\" vdrDropdownTrigger>\n                    {{ 'common.actions' | translate }}\n                    <clr-icon shape=\"caret down\"></clr-icon>\n                </button>\n                <vdr-dropdown-menu vdrPosition=\"bottom-right\">\n                    <button\n                        type=\"button\"\n                        class=\"delete-button\"\n                        (click)=\"deleteTaxRate(taxRate)\"\n                        [disabled]=\"!(['DeleteSettings', 'DeleteTaxRate'] | hasPermission)\"\n                        vdrDropdownItem\n                    >\n                        <clr-icon shape=\"trash\" class=\"is-danger\"></clr-icon>\n                        {{ 'common.delete' | translate }}\n                    </button>\n                </vdr-dropdown-menu>\n            </vdr-dropdown>\n        </td>\n    </ng-template>\n</vdr-data-table>\n","import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport { EMPTY } from 'rxjs';\nimport { map, switchMap } from 'rxjs/operators';\n\nimport { BaseListComponent } from '@vendure/admin-ui/core';\nimport { DeletionResult, GetTaxRateList } from '@vendure/admin-ui/core';\nimport { NotificationService } from '@vendure/admin-ui/core';\nimport { DataService } from '@vendure/admin-ui/core';\nimport { ModalService } from '@vendure/admin-ui/core';\n\n@Component({\n    selector: 'vdr-tax-rate-list',\n    templateUrl: './tax-rate-list.component.html',\n    styleUrls: ['./tax-rate-list.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class TaxRateListComponent extends BaseListComponent<GetTaxRateList.Query, GetTaxRateList.Items> {\n    constructor(\n        private modalService: ModalService,\n        private notificationService: NotificationService,\n        private dataService: DataService,\n        router: Router,\n        route: ActivatedRoute,\n    ) {\n        super(router, route);\n        super.setQueryFn(\n            (...args: any[]) => this.dataService.settings.getTaxRates(...args),\n            data => data.taxRates,\n        );\n    }\n\n    deleteTaxRate(taxRate: GetTaxRateList.Items) {\n        return this.modalService\n            .dialog({\n                title: _('settings.confirm-delete-tax-rate'),\n                body: taxRate.name,\n                buttons: [\n                    { type: 'secondary', label: _('common.cancel') },\n                    { type: 'danger', label: _('common.delete'), returnValue: true },\n                ],\n            })\n            .pipe(\n                switchMap(res => (res ? this.dataService.settings.deleteTaxRate(taxRate.id) : EMPTY)),\n                map(res => res.deleteTaxRate),\n            )\n            .subscribe(\n                res => {\n                    if (res.result === DeletionResult.DELETED) {\n                        this.notificationService.success(_('common.notify-delete-success'), {\n                            entity: 'TaxRate',\n                        });\n                        this.refresh();\n                    } else {\n                        this.notificationService.error(res.message || _('common.notify-delete-error'), {\n                            entity: 'TaxRate',\n                        });\n                    }\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-delete-error'), {\n                        entity: 'TaxRate',\n                    });\n                },\n            );\n    }\n}\n","<ng-template vdrDialogTitle>\n    <span *ngIf=\"zone.id\">{{ 'settings.update-zone' | translate }}</span>\n    <span *ngIf=\"!zone.id\">{{ 'settings.create-zone' | translate }}</span>\n</ng-template>\n<form [formGroup]=\"form\">\n    <vdr-form-field [label]=\"'common.name' | translate\" for=\"name\">\n        <input\n            id=\"name\"\n            type=\"text\"\n            formControlName=\"name\"\n            [readonly]=\"!(['UpdateSettings', 'UpdateZone'] | hasPermission)\"\n        />\n    </vdr-form-field>\n    <vdr-tabbed-custom-fields\n        entityName=\"Zone\"\n        [customFields]=\"customFields\"\n        [customFieldsFormGroup]=\"form.get('customFields')\"\n        [readonly]=\"!(['UpdateSettings', 'UpdateZone'] | hasPermission)\"\n    ></vdr-tabbed-custom-fields>\n</form>\n\n<ng-template vdrDialogButtons>\n    <button type=\"button\" class=\"btn\" (click)=\"cancel()\">{{ 'common.cancel' | translate }}</button>\n    <button type=\"submit\" (click)=\"save()\" [disabled]=\"form.invalid\" class=\"btn btn-primary\">\n        <span *ngIf=\"zone.id\">{{ 'settings.update-zone' | translate }}</span>\n        <span *ngIf=\"!zone.id\">{{ 'settings.create-zone' | translate }}</span>\n    </button>\n</ng-template>\n","import { ChangeDetectionStrategy, Component, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { CreateZoneInput, CustomFieldConfig, Dialog, ServerConfigService } from '@vendure/admin-ui/core';\n\n@Component({\n    selector: 'vdr-zone-detail-dialog',\n    templateUrl: './zone-detail-dialog.component.html',\n    styleUrls: ['./zone-detail-dialog.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ZoneDetailDialogComponent implements Dialog<CreateZoneInput>, OnInit {\n    zone: { id?: string; name: string; customFields?: { [name: string]: any } };\n    resolveWith: (result?: CreateZoneInput) => void;\n\n    customFields: CustomFieldConfig[];\n    form: FormGroup;\n\n    constructor(private serverConfigService: ServerConfigService, private formBuilder: FormBuilder) {\n        this.customFields = this.serverConfigService.getCustomFieldsFor('Zone');\n    }\n\n    ngOnInit() {\n        this.form = this.formBuilder.group({\n            name: [this.zone.name, Validators.required],\n            customFields: this.formBuilder.group(\n                this.customFields.reduce((hash, field) => ({ ...hash, [field.name]: '' }), {}),\n            ),\n        });\n        if (this.customFields.length) {\n            const customFieldsGroup = this.form.get('customFields') as FormGroup;\n\n            for (const fieldDef of this.customFields) {\n                const key = fieldDef.name;\n                const value = this.zone.customFields?.[key];\n                const control = customFieldsGroup.get(key);\n                if (control) {\n                    control.patchValue(value);\n                }\n            }\n        }\n    }\n\n    cancel() {\n        this.resolveWith();\n    }\n\n    save() {\n        this.resolveWith(this.form.value);\n    }\n}\n","<vdr-action-bar>\n    <vdr-ab-left>\n            <vdr-language-selector\n                [availableLanguageCodes]=\"availableLanguages$ | async\"\n                [currentLanguageCode]=\"contentLanguage$ | async\"\n                (languageCodeChange)=\"setLanguage($event)\"\n            ></vdr-language-selector>\n        </vdr-ab-left>\n    <vdr-ab-right>\n        <vdr-action-bar-items locationId=\"zone-list\"></vdr-action-bar-items>\n        <button\n            class=\"btn btn-primary\"\n            *vdrIfPermissions=\"['CreateSettings', 'CreateZone']\"\n            (click)=\"create()\"\n        >\n            <clr-icon shape=\"plus\"></clr-icon>\n            {{ 'settings.create-new-zone' | translate }}\n        </button>\n    </vdr-ab-right>\n</vdr-action-bar>\n<div class=\"zone-wrapper\">\n    <div class=\"zone-list\">\n        <table class=\"table mt0\">\n            <tbody>\n                <tr\n                    *ngFor=\"let zone of zones$ | async\"\n                    [class.active]=\"zone.id === (activeZone$ | async)?.id\"\n                >\n                    <td class=\"left align-middle\"><vdr-entity-info [entity]=\"zone\"></vdr-entity-info></td>\n                    <td class=\"left align-middle\">\n                        <vdr-chip [colorFrom]=\"zone.name\">{{ zone.name }}</vdr-chip>\n                    </td>\n                    <td class=\"text-right align-middle\">\n                        <a\n                            class=\"btn btn-link btn-sm\"\n                            [routerLink]=\"['./', { contents: zone.id }]\"\n                            queryParamsHandling=\"preserve\"\n                        >\n                            <clr-icon shape=\"view-list\"></clr-icon>\n                            {{ 'settings.view-zone-members' | translate }}\n                        </a>\n                    </td>\n                    <td class=\"align-middle\">\n                        <button class=\"btn btn-link btn-sm\" (click)=\"update(zone)\">\n                            <clr-icon shape=\"edit\"></clr-icon>\n                            {{ 'common.edit' | translate }}\n                        </button>\n                    </td>\n                    <td class=\"align-middle\">\n                        <vdr-dropdown>\n                            <button type=\"button\" class=\"btn btn-link btn-sm\" vdrDropdownTrigger>\n                                {{ 'common.actions' | translate }}\n                                <clr-icon shape=\"caret down\"></clr-icon>\n                            </button>\n                            <vdr-dropdown-menu vdrPosition=\"bottom-right\">\n                                <button\n                                    class=\"button\"\n                                    vdrDropdownItem\n                                    (click)=\"delete(zone.id)\"\n                                    [disabled]=\"!(['DeleteSettings', 'DeleteZone'] | hasPermission)\"\n                                >\n                                    <clr-icon shape=\"trash\" class=\"is-danger\"></clr-icon>\n                                    {{ 'common.delete' | translate }}\n                                </button>\n                            </vdr-dropdown-menu>\n                        </vdr-dropdown>\n                    </td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n    <div class=\"zone-members\" [class.expanded]=\"activeZone$ | async\">\n        <ng-container *ngIf=\"activeZone$ | async as activeZone\">\n            <vdr-zone-member-list\n                [members]=\"activeZone.members\"\n                [selectedMemberIds]=\"selectedMemberIds\"\n                (selectionChange)=\"selectedMemberIds = $event\"\n            >\n                <div *vdrZoneMemberListHeader>\n                    <div class=\"flex\">\n                        <div class=\"header-title-row\">\n                            {{ activeZone.name }} ({{ activeZone.members.length }})\n                        </div>\n                        <div class=\"flex-spacer\"></div>\n                        <button type=\"button\" class=\"close-button\" (click)=\"closeMembers()\">\n                            <clr-icon shape=\"close\"></clr-icon>\n                        </button>\n                    </div>\n                    <div class=\"controls\">\n                        <vdr-dropdown>\n                            <button\n                                type=\"button\"\n                                class=\"btn btn-secondary btn-sm\"\n                                vdrDropdownTrigger\n                                [disabled]=\"selectedMemberIds.length === 0\"\n                            >\n                                {{ 'common.with-selected' | translate: { count: selectedMemberIds.length } }}\n                                <clr-icon shape=\"caret down\"></clr-icon>\n                            </button>\n                            <vdr-dropdown-menu vdrPosition=\"bottom-right\">\n                                <button\n                                    type=\"button\"\n                                    class=\"delete-button\"\n                                    (click)=\"removeFromZone(activeZone, selectedMemberIds)\"\n                                    vdrDropdownItem\n                                    [disabled]=\"!(['UpdateSettings', 'UpdateZone'] | hasPermission)\"\n                                >\n                                    <clr-icon shape=\"trash\" class=\"is-danger\"></clr-icon>\n                                    {{ 'settings.remove-from-zone' | translate }}\n                                </button>\n                            </vdr-dropdown-menu>\n                        </vdr-dropdown>\n                        <button class=\"btn btn-secondary btn-sm\" (click)=\"addToZone(activeZone)\">\n                            {{ 'settings.add-countries-to-zone' | translate: { zoneName: activeZone.name } }}\n                        </button>\n                    </div>\n                </div>\n                <div *vdrZoneMemberControls=\"let member = member\">\n                    <vdr-dropdown>\n                        <button type=\"button\" class=\"btn btn-link btn-sm\" vdrDropdownTrigger>\n                            {{ 'common.actions' | translate }}\n                            <clr-icon shape=\"caret down\"></clr-icon>\n                        </button>\n                        <vdr-dropdown-menu vdrPosition=\"bottom-right\">\n                            <a\n                                type=\"button\"\n                                [routerLink]=\"['/settings', 'countries', member.id]\"\n                                vdrDropdownItem\n                            >\n                                <clr-icon shape=\"edit\"></clr-icon>\n                                {{ 'common.edit' | translate }}\n                            </a>\n                            <button\n                                type=\"button\"\n                                class=\"delete-button\"\n                                (click)=\"removeFromZone(activeZone, [member.id])\"\n                                vdrDropdownItem\n                                [disabled]=\"!(['UpdateSettings', 'UpdateZone'] | hasPermission)\"\n                            >\n                                <clr-icon shape=\"trash\" class=\"is-danger\"></clr-icon>\n                                {{ 'settings.remove-from-zone' | translate }}\n                            </button>\n                        </vdr-dropdown-menu>\n                    </vdr-dropdown>\n                </div>\n            </vdr-zone-member-list>\n        </ng-container>\n    </div>\n</div>\n","import { ChangeDetectionStrategy, Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport {\n    DataService,\n    DeletionResult,\n    GetZones,\n    LanguageCode,\n    ModalService,\n    NotificationService,\n    ServerConfigService,\n} from '@vendure/admin-ui/core';\nimport { combineLatest, EMPTY, Observable, of } from 'rxjs';\nimport { distinctUntilChanged, map, mapTo, switchMap, tap } from 'rxjs/operators';\n\nimport { AddCountryToZoneDialogComponent } from '../add-country-to-zone-dialog/add-country-to-zone-dialog.component';\nimport { ZoneDetailDialogComponent } from '../zone-detail-dialog/zone-detail-dialog.component';\n\n@Component({\n    selector: 'vdr-zone-list',\n    templateUrl: './zone-list.component.html',\n    styleUrls: ['./zone-list.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ZoneListComponent implements OnInit {\n    activeZone$: Observable<GetZones.Zones | undefined>;\n    zones$: Observable<GetZones.Zones[]>;\n    members$: Observable<GetZones.Members[]>;\n    availableLanguages$: Observable<LanguageCode[]>;\n    contentLanguage$: Observable<LanguageCode>;\n    selectedMemberIds: string[] = [];\n\n    constructor(\n        private dataService: DataService,\n        private notificationService: NotificationService,\n        private modalService: ModalService,\n        private route: ActivatedRoute,\n        private router: Router,\n        private serverConfigService: ServerConfigService,\n    ) {}\n\n    ngOnInit(): void {\n        const zonesQueryRef = this.dataService.settings.getZones().ref;\n        this.zones$ = zonesQueryRef.valueChanges.pipe(map(data => data.data.zones));\n        const activeZoneId$ = this.route.paramMap.pipe(\n            map(pm => pm.get('contents')),\n            distinctUntilChanged(),\n            tap(() => (this.selectedMemberIds = [])),\n        );\n        this.activeZone$ = combineLatest(this.zones$, activeZoneId$).pipe(\n            map(([zones, activeZoneId]) => {\n                if (activeZoneId) {\n                    return zones.find(z => z.id === activeZoneId);\n                }\n            }),\n        );\n        this.availableLanguages$ = this.serverConfigService.getAvailableLanguages();\n        this.contentLanguage$ = this.dataService.client\n            .uiState()\n            .mapStream(({ uiState }) => uiState.contentLanguage)\n            .pipe(tap(() => zonesQueryRef.refetch()));\n    }\n\n    setLanguage(code: LanguageCode) {\n        this.dataService.client.setContentLanguage(code).subscribe();\n    }\n\n    create() {\n        this.modalService\n            .fromComponent(ZoneDetailDialogComponent, { locals: { zone: { name: '' } } })\n            .pipe(\n                switchMap(result =>\n                    result ? this.dataService.settings.createZone({ ...result, memberIds: [] }) : EMPTY,\n                ),\n                // refresh list\n                switchMap(() => this.dataService.settings.getZones().single$),\n            )\n            .subscribe(\n                () => {\n                    this.notificationService.success(_('common.notify-create-success'), {\n                        entity: 'Zone',\n                    });\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-create-error'), {\n                        entity: 'Zone',\n                    });\n                },\n            );\n    }\n\n    delete(zoneId: string) {\n        this.modalService\n            .dialog({\n                title: _('catalog.confirm-delete-zone'),\n                buttons: [\n                    { type: 'secondary', label: _('common.cancel') },\n                    { type: 'danger', label: _('common.delete'), returnValue: true },\n                ],\n            })\n            .pipe(\n                switchMap(response => (response ? this.dataService.settings.deleteZone(zoneId) : EMPTY)),\n\n                switchMap(result => {\n                    if (result.deleteZone.result === DeletionResult.DELETED) {\n                        // refresh list\n                        return this.dataService.settings\n                            .getZones()\n                            .mapSingle(() => ({ errorMessage: false }));\n                    } else {\n                        return of({ errorMessage: result.deleteZone.message });\n                    }\n                }),\n            )\n            .subscribe(\n                result => {\n                    if (typeof result.errorMessage === 'string') {\n                        this.notificationService.error(result.errorMessage);\n                    } else {\n                        this.notificationService.success(_('common.notify-delete-success'), {\n                            entity: 'Zone',\n                        });\n                    }\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-delete-error'), {\n                        entity: 'Zone',\n                    });\n                },\n            );\n    }\n\n    update(zone: GetZones.Zones) {\n        this.modalService\n            .fromComponent(ZoneDetailDialogComponent, { locals: { zone } })\n            .pipe(\n                switchMap(result =>\n                    result ? this.dataService.settings.updateZone({ id: zone.id, ...result }) : EMPTY,\n                ),\n            )\n            .subscribe(\n                () => {\n                    this.notificationService.success(_('common.notify-update-success'), {\n                        entity: 'Zone',\n                    });\n                },\n                err => {\n                    this.notificationService.error(_('common.notify-update-error'), {\n                        entity: 'Zone',\n                    });\n                },\n            );\n    }\n\n    closeMembers() {\n        const params = { ...this.route.snapshot.params };\n        delete params.contents;\n        this.router.navigate(['./', params], { relativeTo: this.route, queryParamsHandling: 'preserve' });\n    }\n\n    addToZone(zone: GetZones.Zones) {\n        this.modalService\n            .fromComponent(AddCountryToZoneDialogComponent, {\n                locals: {\n                    zoneName: zone.name,\n                    currentMembers: zone.members,\n                },\n                size: 'md',\n            })\n            .pipe(\n                switchMap(memberIds =>\n                    memberIds\n                        ? this.dataService.settings\n                              .addMembersToZone(zone.id, memberIds)\n                              .pipe(mapTo(memberIds))\n                        : EMPTY,\n                ),\n            )\n            .subscribe({\n                next: result => {\n                    this.notificationService.success(_(`settings.add-countries-to-zone-success`), {\n                        countryCount: result.length,\n                        zoneName: zone.name,\n                    });\n                },\n                error: err => {\n                    this.notificationService.error(err);\n                },\n            });\n    }\n\n    removeFromZone(zone: GetZones.Zones, memberIds: string[]) {\n        this.dataService.settings.removeMembersFromZone(zone.id, memberIds).subscribe({\n            complete: () => {\n                this.notificationService.success(_(`settings.remove-countries-from-zone-success`), {\n                    countryCount: memberIds.length,\n                    zoneName: zone.name,\n                });\n            },\n        });\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { BaseEntityResolver } from '@vendure/admin-ui/core';\nimport { Administrator, Role } from '@vendure/admin-ui/core';\nimport { DataService } from '@vendure/admin-ui/core';\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class AdministratorResolver extends BaseEntityResolver<Administrator.Fragment> {\n    constructor(router: Router, dataService: DataService) {\n        super(\n            router,\n            {\n                __typename: 'Administrator' as 'Administrator',\n                id: '',\n                createdAt: '',\n                updatedAt: '',\n                emailAddress: '',\n                firstName: '',\n                lastName: '',\n                user: { roles: [] } as any,\n            },\n            id => dataService.administrator.getAdministrator(id).mapStream(data => data.administrator),\n        );\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { BaseEntityResolver } from '@vendure/admin-ui/core';\nimport { Channel, CurrencyCode } from '@vendure/admin-ui/core';\nimport { getDefaultUiLanguage } from '@vendure/admin-ui/core';\nimport { DataService } from '@vendure/admin-ui/core';\n\n/**\n * Resolves the id from the path into a Customer entity.\n */\n@Injectable({\n    providedIn: 'root',\n})\nexport class ChannelResolver extends BaseEntityResolver<Channel.Fragment> {\n    constructor(router: Router, dataService: DataService) {\n        super(\n            router,\n            {\n                __typename: 'Channel',\n                id: '',\n                createdAt: '',\n                updatedAt: '',\n                code: '',\n                token: '',\n                pricesIncludeTax: false,\n                currencyCode: CurrencyCode.USD,\n                defaultLanguageCode: getDefaultUiLanguage(),\n                defaultShippingZone: {} as any,\n                defaultTaxZone: {} as any,\n            },\n            (id) => dataService.settings.getChannel(id).mapStream((data) => data.channel),\n        );\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { BaseEntityResolver } from '@vendure/admin-ui/core';\nimport { Country } from '@vendure/admin-ui/core';\nimport { DataService } from '@vendure/admin-ui/core';\n\n/**\n * Resolves the id from the path into a Customer entity.\n */\n@Injectable({\n    providedIn: 'root',\n})\nexport class CountryResolver extends BaseEntityResolver<Country.Fragment> {\n    constructor(router: Router, dataService: DataService) {\n        super(\n            router,\n            {\n                __typename: 'Country',\n                id: '',\n                createdAt: '',\n                updatedAt: '',\n                code: '',\n                name: '',\n                enabled: false,\n                translations: [],\n            },\n            id => dataService.settings.getCountry(id).mapStream(data => data.country),\n        );\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { BaseEntityResolver } from '@vendure/admin-ui/core';\nimport { GetGlobalSettings } from '@vendure/admin-ui/core';\nimport { DataService } from '@vendure/admin-ui/core';\n\n/**\n * Resolves the global settings.\n */\n@Injectable({\n    providedIn: 'root',\n})\nexport class GlobalSettingsResolver extends BaseEntityResolver<GetGlobalSettings.GlobalSettings> {\n    constructor(router: Router, dataService: DataService) {\n        super(\n            router,\n            // we will never be creating a new GlobalSettings entity, so this part is not used.\n            {} as any,\n            () => dataService.settings.getGlobalSettings().mapStream(data => data.globalSettings),\n        );\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { BaseEntityResolver } from '@vendure/admin-ui/core';\nimport { PaymentMethod } from '@vendure/admin-ui/core';\nimport { DataService } from '@vendure/admin-ui/core';\n\n/**\n * Resolves the id from the path into a Customer entity.\n */\n@Injectable({\n    providedIn: 'root',\n})\nexport class PaymentMethodResolver extends BaseEntityResolver<PaymentMethod.Fragment> {\n    constructor(router: Router, dataService: DataService) {\n        super(\n            router,\n            {\n                __typename: 'PaymentMethod',\n                id: '',\n                createdAt: '',\n                updatedAt: '',\n                name: '',\n                code: '',\n                description: '',\n                enabled: true,\n                checker: undefined as any,\n                handler: undefined as any,\n            },\n            id => dataService.settings.getPaymentMethod(id).mapStream(data => data.paymentMethod),\n        );\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { BaseEntityResolver } from '@vendure/admin-ui/core';\nimport { Administrator, Role } from '@vendure/admin-ui/core';\nimport { DataService } from '@vendure/admin-ui/core';\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class ProfileResolver extends BaseEntityResolver<Administrator.Fragment> {\n    constructor(router: Router, dataService: DataService) {\n        super(\n            router,\n            {\n                __typename: 'Administrator' as 'Administrator',\n                id: '',\n                createdAt: '',\n                updatedAt: '',\n                emailAddress: '',\n                firstName: '',\n                lastName: '',\n                user: { roles: [] } as any,\n            },\n            id =>\n                dataService.administrator\n                    .getActiveAdministrator()\n                    .mapStream(data => data.activeAdministrator),\n        );\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { BaseEntityResolver } from '@vendure/admin-ui/core';\nimport { Role } from '@vendure/admin-ui/core';\nimport { DataService } from '@vendure/admin-ui/core';\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class RoleResolver extends BaseEntityResolver<Role.Fragment> {\n    constructor(router: Router, dataService: DataService) {\n        super(\n            router,\n            {\n                __typename: 'Role' as 'Role',\n                id: '',\n                createdAt: '',\n                updatedAt: '',\n                code: '',\n                description: '',\n                permissions: [],\n                channels: [],\n            },\n            id => dataService.administrator.getRole(id).mapStream(data => data.role),\n        );\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { BaseEntityResolver } from '@vendure/admin-ui/core';\nimport { ShippingMethod } from '@vendure/admin-ui/core';\nimport { DataService } from '@vendure/admin-ui/core';\n\n/**\n * Resolves the id from the path into a Customer entity.\n */\n@Injectable({\n    providedIn: 'root',\n})\nexport class ShippingMethodResolver extends BaseEntityResolver<ShippingMethod.Fragment> {\n    constructor(router: Router, dataService: DataService) {\n        super(\n            router,\n            {\n                __typename: 'ShippingMethod',\n                createdAt: '',\n                updatedAt: '',\n                id: '',\n                code: '',\n                name: '',\n                description: '',\n                fulfillmentHandlerCode: undefined as any,\n                checker: undefined as any,\n                calculator: undefined as any,\n                translations: [],\n            },\n            id => dataService.shippingMethod.getShippingMethod(id).mapStream(data => data.shippingMethod),\n        );\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { BaseEntityResolver, DataService, TaxCategory } from '@vendure/admin-ui/core';\n\n/**\n * Resolves the id from the path into a Customer entity.\n */\n@Injectable({\n    providedIn: 'root',\n})\nexport class TaxCategoryResolver extends BaseEntityResolver<TaxCategory.Fragment> {\n    constructor(router: Router, dataService: DataService) {\n        super(\n            router,\n            {\n                __typename: 'TaxCategory',\n                id: '',\n                createdAt: '',\n                updatedAt: '',\n                name: '',\n                isDefault: false,\n            },\n            id => dataService.settings.getTaxCategory(id).mapStream(data => data.taxCategory),\n        );\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { BaseEntityResolver, DataService, TaxRate } from '@vendure/admin-ui/core';\n\n/**\n * Resolves the id from the path into a Customer entity.\n */\n@Injectable({\n    providedIn: 'root',\n})\nexport class TaxRateResolver extends BaseEntityResolver<TaxRate.Fragment> {\n    constructor(router: Router, dataService: DataService) {\n        super(\n            router,\n            {\n                __typename: 'TaxRate',\n                id: '',\n                createdAt: '',\n                updatedAt: '',\n                name: '',\n                value: 0,\n                enabled: true,\n                category: {} as any,\n                zone: {} as any,\n                customerGroup: null,\n            },\n            id => dataService.settings.getTaxRate(id).mapStream(data => data.taxRate),\n        );\n    }\n}\n","import { Route } from '@angular/router';\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\nimport {\n    Administrator,\n    CanDeactivateDetailGuard,\n    Channel,\n    Country,\n    createResolveData,\n    detailBreadcrumb,\n    Role,\n    ShippingMethod,\n    TaxCategory,\n    TaxRate,\n} from '@vendure/admin-ui/core';\n\nimport { AdminDetailComponent } from './components/admin-detail/admin-detail.component';\nimport { AdministratorListComponent } from './components/administrator-list/administrator-list.component';\nimport { ChannelDetailComponent } from './components/channel-detail/channel-detail.component';\nimport { ChannelListComponent } from './components/channel-list/channel-list.component';\nimport { CountryDetailComponent } from './components/country-detail/country-detail.component';\nimport { CountryListComponent } from './components/country-list/country-list.component';\nimport { GlobalSettingsComponent } from './components/global-settings/global-settings.component';\nimport { PaymentMethodDetailComponent } from './components/payment-method-detail/payment-method-detail.component';\nimport { PaymentMethodListComponent } from './components/payment-method-list/payment-method-list.component';\nimport { ProfileComponent } from './components/profile/profile.component';\nimport { RoleDetailComponent } from './components/role-detail/role-detail.component';\nimport { RoleListComponent } from './components/role-list/role-list.component';\nimport { ShippingMethodDetailComponent } from './components/shipping-method-detail/shipping-method-detail.component';\nimport { ShippingMethodListComponent } from './components/shipping-method-list/shipping-method-list.component';\nimport { TaxCategoryDetailComponent } from './components/tax-category-detail/tax-category-detail.component';\nimport { TaxCategoryListComponent } from './components/tax-category-list/tax-category-list.component';\nimport { TaxRateDetailComponent } from './components/tax-rate-detail/tax-rate-detail.component';\nimport { TaxRateListComponent } from './components/tax-rate-list/tax-rate-list.component';\nimport { ZoneListComponent } from './components/zone-list/zone-list.component';\nimport { AdministratorResolver } from './providers/routing/administrator-resolver';\nimport { ChannelResolver } from './providers/routing/channel-resolver';\nimport { CountryResolver } from './providers/routing/country-resolver';\nimport { GlobalSettingsResolver } from './providers/routing/global-settings-resolver';\nimport { PaymentMethodResolver } from './providers/routing/payment-method-resolver';\nimport { ProfileResolver } from './providers/routing/profile-resolver';\nimport { RoleResolver } from './providers/routing/role-resolver';\nimport { ShippingMethodResolver } from './providers/routing/shipping-method-resolver';\nimport { TaxCategoryResolver } from './providers/routing/tax-category-resolver';\nimport { TaxRateResolver } from './providers/routing/tax-rate-resolver';\n\nexport const settingsRoutes: Route[] = [\n    {\n        path: 'profile',\n        component: ProfileComponent,\n        resolve: createResolveData(ProfileResolver),\n        canDeactivate: [CanDeactivateDetailGuard],\n        data: {\n            breadcrumb: _('breadcrumb.profile'),\n        },\n    },\n    {\n        path: 'administrators',\n        component: AdministratorListComponent,\n        data: {\n            breadcrumb: _('breadcrumb.administrators'),\n        },\n    },\n    {\n        path: 'administrators/:id',\n        component: AdminDetailComponent,\n        resolve: createResolveData(AdministratorResolver),\n        canDeactivate: [CanDeactivateDetailGuard],\n        data: { breadcrumb: administratorBreadcrumb },\n    },\n    {\n        path: 'channels',\n        component: ChannelListComponent,\n        data: {\n            breadcrumb: _('breadcrumb.channels'),\n        },\n    },\n    {\n        path: 'channels/:id',\n        component: ChannelDetailComponent,\n        resolve: createResolveData(ChannelResolver),\n        canDeactivate: [CanDeactivateDetailGuard],\n        data: { breadcrumb: channelBreadcrumb },\n    },\n    {\n        path: 'roles',\n        component: RoleListComponent,\n        data: {\n            breadcrumb: _('breadcrumb.roles'),\n        },\n    },\n    {\n        path: 'roles/:id',\n        component: RoleDetailComponent,\n        resolve: createResolveData(RoleResolver),\n        canDeactivate: [CanDeactivateDetailGuard],\n        data: { breadcrumb: roleBreadcrumb },\n    },\n    {\n        path: 'tax-categories',\n        component: TaxCategoryListComponent,\n        data: {\n            breadcrumb: _('breadcrumb.tax-categories'),\n        },\n    },\n    {\n        path: 'tax-categories/:id',\n        component: TaxCategoryDetailComponent,\n        resolve: createResolveData(TaxCategoryResolver),\n        canDeactivate: [CanDeactivateDetailGuard],\n        data: {\n            breadcrumb: taxCategoryBreadcrumb,\n        },\n    },\n    {\n        path: 'tax-rates',\n        component: TaxRateListComponent,\n        data: {\n            breadcrumb: _('breadcrumb.tax-rates'),\n        },\n    },\n    {\n        path: 'tax-rates/:id',\n        component: TaxRateDetailComponent,\n        resolve: createResolveData(TaxRateResolver),\n        canDeactivate: [CanDeactivateDetailGuard],\n        data: {\n            breadcrumb: taxRateBreadcrumb,\n        },\n    },\n    {\n        path: 'countries',\n        component: CountryListComponent,\n        data: {\n            breadcrumb: _('breadcrumb.countries'),\n        },\n    },\n    {\n        path: 'countries/:id',\n        component: CountryDetailComponent,\n        resolve: createResolveData(CountryResolver),\n        canDeactivate: [CanDeactivateDetailGuard],\n        data: {\n            breadcrumb: countryBreadcrumb,\n        },\n    },\n    {\n        path: 'zones',\n        component: ZoneListComponent,\n        data: {\n            breadcrumb: _('breadcrumb.zones'),\n        },\n    },\n    {\n        path: 'shipping-methods',\n        component: ShippingMethodListComponent,\n        data: {\n            breadcrumb: _('breadcrumb.shipping-methods'),\n        },\n    },\n    {\n        path: 'shipping-methods/:id',\n        component: ShippingMethodDetailComponent,\n        resolve: createResolveData(ShippingMethodResolver),\n        canDeactivate: [CanDeactivateDetailGuard],\n        data: {\n            breadcrumb: shippingMethodBreadcrumb,\n        },\n    },\n    {\n        path: 'payment-methods',\n        component: PaymentMethodListComponent,\n        data: {\n            breadcrumb: _('breadcrumb.payment-methods'),\n        },\n    },\n    {\n        path: 'payment-methods/:id',\n        component: PaymentMethodDetailComponent,\n        resolve: createResolveData(PaymentMethodResolver),\n        canDeactivate: [CanDeactivateDetailGuard],\n        data: {\n            breadcrumb: paymentMethodBreadcrumb,\n        },\n    },\n    {\n        path: 'global-settings',\n        component: GlobalSettingsComponent,\n        resolve: createResolveData(GlobalSettingsResolver),\n        canDeactivate: [CanDeactivateDetailGuard],\n        data: {\n            breadcrumb: _('breadcrumb.global-settings'),\n        },\n    },\n];\n\nexport function administratorBreadcrumb(data: any, params: any) {\n    return detailBreadcrumb<Administrator>({\n        entity: data.entity,\n        id: params.id,\n        breadcrumbKey: 'breadcrumb.administrators',\n        getName: admin => `${admin.firstName} ${admin.lastName}`,\n        route: 'administrators',\n    });\n}\n\nexport function channelBreadcrumb(data: any, params: any) {\n    return detailBreadcrumb<Channel>({\n        entity: data.entity,\n        id: params.id,\n        breadcrumbKey: 'breadcrumb.channels',\n        getName: channel => channel.code,\n        route: 'channels',\n    });\n}\n\nexport function roleBreadcrumb(data: any, params: any) {\n    return detailBreadcrumb<Role>({\n        entity: data.entity,\n        id: params.id,\n        breadcrumbKey: 'breadcrumb.roles',\n        getName: role => role.description,\n        route: 'roles',\n    });\n}\n\nexport function taxCategoryBreadcrumb(data: any, params: any) {\n    return detailBreadcrumb<TaxCategory.Fragment>({\n        entity: data.entity,\n        id: params.id,\n        breadcrumbKey: 'breadcrumb.tax-categories',\n        getName: category => category.name,\n        route: 'tax-categories',\n    });\n}\n\nexport function taxRateBreadcrumb(data: any, params: any) {\n    return detailBreadcrumb<TaxRate.Fragment>({\n        entity: data.entity,\n        id: params.id,\n        breadcrumbKey: 'breadcrumb.tax-rates',\n        getName: category => category.name,\n        route: 'tax-rates',\n    });\n}\n\nexport function countryBreadcrumb(data: any, params: any) {\n    return detailBreadcrumb<Country.Fragment>({\n        entity: data.entity,\n        id: params.id,\n        breadcrumbKey: 'breadcrumb.countries',\n        getName: promotion => promotion.name,\n        route: 'countries',\n    });\n}\n\nexport function shippingMethodBreadcrumb(data: any, params: any) {\n    return detailBreadcrumb<ShippingMethod.Fragment>({\n        entity: data.entity,\n        id: params.id,\n        breadcrumbKey: 'breadcrumb.shipping-methods',\n        getName: method => method.name,\n        route: 'shipping-methods',\n    });\n}\n\nexport function paymentMethodBreadcrumb(data: any, params: any) {\n    return detailBreadcrumb<ShippingMethod.Fragment>({\n        entity: data.entity,\n        id: params.id,\n        breadcrumbKey: 'breadcrumb.payment-methods',\n        getName: method => method.code,\n        route: 'payment-methods',\n    });\n}\n","import { NgModule } from '@angular/core';\nimport { RouterModule } from '@angular/router';\nimport { SharedModule } from '@vendure/admin-ui/core';\n\nimport { AddCountryToZoneDialogComponent } from './components/add-country-to-zone-dialog/add-country-to-zone-dialog.component';\nimport { AdminDetailComponent } from './components/admin-detail/admin-detail.component';\nimport { AdministratorListComponent } from './components/administrator-list/administrator-list.component';\nimport { ChannelDetailComponent } from './components/channel-detail/channel-detail.component';\nimport { ChannelListComponent } from './components/channel-list/channel-list.component';\nimport { CountryDetailComponent } from './components/country-detail/country-detail.component';\nimport { CountryListComponent } from './components/country-list/country-list.component';\nimport { GlobalSettingsComponent } from './components/global-settings/global-settings.component';\nimport { PaymentMethodDetailComponent } from './components/payment-method-detail/payment-method-detail.component';\nimport { PaymentMethodListComponent } from './components/payment-method-list/payment-method-list.component';\nimport { PermissionGridComponent } from './components/permission-grid/permission-grid.component';\nimport { ProfileComponent } from './components/profile/profile.component';\nimport { RoleDetailComponent } from './components/role-detail/role-detail.component';\nimport { RoleListComponent } from './components/role-list/role-list.component';\nimport { ShippingEligibilityTestResultComponent } from './components/shipping-eligibility-test-result/shipping-eligibility-test-result.component';\nimport { ShippingMethodDetailComponent } from './components/shipping-method-detail/shipping-method-detail.component';\nimport { ShippingMethodListComponent } from './components/shipping-method-list/shipping-method-list.component';\nimport { ShippingMethodTestResultComponent } from './components/shipping-method-test-result/shipping-method-test-result.component';\nimport { TaxCategoryDetailComponent } from './components/tax-category-detail/tax-category-detail.component';\nimport { TaxCategoryListComponent } from './components/tax-category-list/tax-category-list.component';\nimport { TaxRateDetailComponent } from './components/tax-rate-detail/tax-rate-detail.component';\nimport { TaxRateListComponent } from './components/tax-rate-list/tax-rate-list.component';\nimport { TestAddressFormComponent } from './components/test-address-form/test-address-form.component';\nimport { TestOrderBuilderComponent } from './components/test-order-builder/test-order-builder.component';\nimport { ZoneDetailDialogComponent } from './components/zone-detail-dialog/zone-detail-dialog.component';\nimport { ZoneListComponent } from './components/zone-list/zone-list.component';\nimport { ZoneMemberControlsDirective } from './components/zone-member-list/zone-member-controls.directive';\nimport { ZoneMemberListHeaderDirective } from './components/zone-member-list/zone-member-list-header.directive';\nimport { ZoneMemberListComponent } from './components/zone-member-list/zone-member-list.component';\nimport { settingsRoutes } from './settings.routes';\n\n@NgModule({\n    imports: [SharedModule, RouterModule.forChild(settingsRoutes)],\n    declarations: [\n        TaxCategoryListComponent,\n        TaxCategoryDetailComponent,\n        AdministratorListComponent,\n        RoleListComponent,\n        RoleDetailComponent,\n        AdminDetailComponent,\n        PermissionGridComponent,\n        CountryListComponent,\n        CountryDetailComponent,\n        TaxRateListComponent,\n        TaxRateDetailComponent,\n        ChannelListComponent,\n        ChannelDetailComponent,\n        ShippingMethodListComponent,\n        ShippingMethodDetailComponent,\n        PaymentMethodListComponent,\n        PaymentMethodDetailComponent,\n        GlobalSettingsComponent,\n        TestOrderBuilderComponent,\n        TestAddressFormComponent,\n        ShippingMethodTestResultComponent,\n        ShippingEligibilityTestResultComponent,\n        ZoneListComponent,\n        AddCountryToZoneDialogComponent,\n        ZoneMemberListComponent,\n        ZoneMemberListHeaderDirective,\n        ZoneMemberControlsDirective,\n        ZoneDetailDialogComponent,\n        ProfileComponent,\n    ],\n})\nexport class SettingsModule {}\n"]}